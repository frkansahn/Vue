{"remainingRequest":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-engine\\src\\view\\observer\\mutationobserver.js","dependencies":[{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-engine\\src\\view\\observer\\mutationobserver.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-dev-webpack-plugin\\lib\\translatesourceloader.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1581760768702},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1581760786382},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1581760768279}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZnJvbSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm1hcCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zZXQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOlxcVXNlcnNcXHBjXFxEZXNrdG9wXFxSZXN0b3JhblxcUmVzdG9yYW5cXFJlc3RvcmFuLlVJXFxjbGllbnRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJDOlxcVXNlcnNcXHBjXFxEZXNrdG9wXFxSZXN0b3JhblxcUmVzdG9yYW5cXFJlc3RvcmFuLlVJXFxjbGllbnRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIGZyb20gIkM6XFxVc2Vyc1xccGNcXERlc2t0b3BcXFJlc3RvcmFuXFxSZXN0b3JhblxcUmVzdG9yYW4uVUlcXGNsaWVudFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI7CmltcG9ydCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkIGZyb20gIkM6XFxVc2Vyc1xccGNcXERlc2t0b3BcXFJlc3RvcmFuXFxSZXN0b3JhblxcUmVzdG9yYW4uVUlcXGNsaWVudFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vYXNzZXJ0VGhpc0luaXRpYWxpemVkIjsKaW1wb3J0IF9nZXRQcm90b3R5cGVPZiBmcm9tICJDOlxcVXNlcnNcXHBjXFxEZXNrdG9wXFxSZXN0b3JhblxcUmVzdG9yYW5cXFJlc3RvcmFuLlVJXFxjbGllbnRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2dldFByb3RvdHlwZU9mIjsKaW1wb3J0IF9nZXQgZnJvbSAiQzpcXFVzZXJzXFxwY1xcRGVza3RvcFxcUmVzdG9yYW5cXFJlc3RvcmFuXFxSZXN0b3Jhbi5VSVxcY2xpZW50XFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9nZXQiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkM6XFxVc2Vyc1xccGNcXERlc2t0b3BcXFJlc3RvcmFuXFxSZXN0b3JhblxcUmVzdG9yYW4uVUlcXGNsaWVudFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHMiOwoKLyoqCiAqIEBsaWNlbnNlIENvcHlyaWdodCAoYykgMjAwMy0yMDIwLCBDS1NvdXJjZSAtIEZyZWRlcmljbyBLbmFiYmVuLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiBGb3IgbGljZW5zaW5nLCBzZWUgTElDRU5TRS5tZCBvciBodHRwczovL2NrZWRpdG9yLmNvbS9sZWdhbC9ja2VkaXRvci1vc3MtbGljZW5zZQogKi8KCi8qKgogKiBAbW9kdWxlIGVuZ2luZS92aWV3L29ic2VydmVyL211dGF0aW9ub2JzZXJ2ZXIKICovCgovKiBnbG9iYWxzIHdpbmRvdyAqLwppbXBvcnQgT2JzZXJ2ZXIgZnJvbSAnLi9vYnNlcnZlcic7CmltcG9ydCBWaWV3U2VsZWN0aW9uIGZyb20gJy4uL3NlbGVjdGlvbic7CmltcG9ydCB7IHN0YXJ0c1dpdGhGaWxsZXIsIGdldERhdGFXaXRob3V0RmlsbGVyIH0gZnJvbSAnLi4vZmlsbGVyJzsKaW1wb3J0IHsgaXNFcXVhbFdpdGggfSBmcm9tICdsb2Rhc2gtZXMnOwovKioKICogTXV0YXRpb24gb2JzZXJ2ZXIgY2xhc3Mgb2JzZXJ2ZXMgY2hhbmdlcyBpbiB0aGUgRE9NLCBmaXJlcyB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L2RvY3VtZW50fkRvY3VtZW50I2V2ZW50Om11dGF0aW9uc30gZXZlbnQsIG1hcmsgdmlldwogKiBlbGVtZW50cyBhcyBjaGFuZ2VkIGFuZCBjYWxsIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvcmVuZGVyZXJ+UmVuZGVyZXIjcmVuZGVyfS4KICogQmVjYXVzZSBhbGwgbXV0YXRlZCBub2RlcyBhcmUgbWFya2VkIGFzICJ0byBiZSByZW5kZXJlZCIgYW5kIHRoZQogKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3JlbmRlcmVyflJlbmRlcmVyI3JlbmRlcn0gaXMgY2FsbGVkLCBhbGwgY2hhbmdlcyB3aWxsIGJlIHJldmVydGVkLCB1bmxlc3MgdGhlIG11dGF0aW9uIHdpbGwgYmUgaGFuZGxlZCBieSB0aGUKICoge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9kb2N1bWVudH5Eb2N1bWVudCNldmVudDptdXRhdGlvbnN9IGV2ZW50IGxpc3RlbmVyLiBJdCBtZWFucyB1c2VyIHdpbGwgc2VlIG9ubHkgaGFuZGxlZCBjaGFuZ2VzLCBhbmQgdGhlIGVkaXRvcgogKiB3aWxsIGJsb2NrIGFsbCBjaGFuZ2VzIHdoaWNoIGFyZSBub3QgaGFuZGxlZC4KICoKICogTXV0YXRpb24gT2JzZXJ2ZXIgYWxzbyB0YWtlIGNhcmUgb2YgcmVkdWNpbmcgbnVtYmVyIG9mIG11dGF0aW9ucyB3aGljaCBhcmUgZmlyZWQuIEl0IHJlbW92ZXMgZHVwbGljYXRlcyBhbmQKICogbXV0YXRpb25zIG9uIGVsZW1lbnRzIHdoaWNoIGRvIG5vdCBoYXZlIGNvcnJlc3BvbmRpbmcgdmlldyBlbGVtZW50cy4gQWxzbwogKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L29ic2VydmVyL211dGF0aW9ub2JzZXJ2ZXJ+TXV0YXRlZFRleHQgdGV4dCBtdXRhdGlvbn0gaXMgZmlyZWQgb25seSBpZiBwYXJlbnQgZWxlbWVudCBkbyBub3QgY2hhbmdlIGNoaWxkIGxpc3QuCiAqCiAqIE5vdGUgdGhhdCB0aGlzIG9ic2VydmVyIGlzIGF0dGFjaGVkIGJ5IHRoZSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3ZpZXd+Vmlld30gYW5kIGlzIGF2YWlsYWJsZSBieSBkZWZhdWx0LgogKgogKiBAZXh0ZW5kcyBtb2R1bGU6ZW5naW5lL3ZpZXcvb2JzZXJ2ZXIvb2JzZXJ2ZXJ+T2JzZXJ2ZXIKICovCgp2YXIgTXV0YXRpb25PYnNlcnZlciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9PYnNlcnZlcikgewogIF9pbmhlcml0cyhNdXRhdGlvbk9ic2VydmVyLCBfT2JzZXJ2ZXIpOwoKICBmdW5jdGlvbiBNdXRhdGlvbk9ic2VydmVyKHZpZXcpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTXV0YXRpb25PYnNlcnZlcik7CgogICAgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoTXV0YXRpb25PYnNlcnZlcikuY2FsbCh0aGlzLCB2aWV3KSk7CiAgICAvKioKICAgICAqIE5hdGl2ZSBtdXRhdGlvbiBvYnNlcnZlciBjb25maWcuCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqIEBtZW1iZXIge09iamVjdH0KICAgICAqLwoKICAgIF90aGlzLl9jb25maWcgPSB7CiAgICAgIGNoaWxkTGlzdDogdHJ1ZSwKICAgICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSwKICAgICAgY2hhcmFjdGVyRGF0YU9sZFZhbHVlOiB0cnVlLAogICAgICBzdWJ0cmVlOiB0cnVlCiAgICB9OwogICAgLyoqCiAgICAgKiBSZWZlcmVuY2UgdG8gdGhlIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvdmlld35WaWV3I2RvbUNvbnZlcnRlcn0uCiAgICAgKgogICAgICogQG1lbWJlciB7bW9kdWxlOmVuZ2luZS92aWV3L2RvbWNvbnZlcnRlcn5Eb21Db252ZXJ0ZXJ9CiAgICAgKi8KCiAgICBfdGhpcy5kb21Db252ZXJ0ZXIgPSB2aWV3LmRvbUNvbnZlcnRlcjsKICAgIC8qKgogICAgICogUmVmZXJlbmNlIHRvIHRoZSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3ZpZXd+VmlldyNfcmVuZGVyZXJ9LgogICAgICoKICAgICAqIEBtZW1iZXIge21vZHVsZTplbmdpbmUvdmlldy9yZW5kZXJlcn5SZW5kZXJlcn0KICAgICAqLwoKICAgIF90aGlzLnJlbmRlcmVyID0gdmlldy5fcmVuZGVyZXI7CiAgICAvKioKICAgICAqIE9ic2VydmVkIERPTSBlbGVtZW50cy4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICogQG1lbWJlciB7QXJyYXkuPEhUTUxFbGVtZW50Pn0KICAgICAqLwoKICAgIF90aGlzLl9kb21FbGVtZW50cyA9IFtdOwogICAgLyoqCiAgICAgKiBOYXRpdmUgbXV0YXRpb24gb2JzZXJ2ZXIuCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqIEBtZW1iZXIge011dGF0aW9uT2JzZXJ2ZXJ9CiAgICAgKi8KCiAgICBfdGhpcy5fbXV0YXRpb25PYnNlcnZlciA9IG5ldyB3aW5kb3cuTXV0YXRpb25PYnNlcnZlcihfdGhpcy5fb25NdXRhdGlvbnMuYmluZChfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSkpOwogICAgcmV0dXJuIF90aGlzOwogIH0KICAvKioKICAgKiBTeW5jaHJvbm91c2x5IGZpcmVzIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZG9jdW1lbnR+RG9jdW1lbnQjZXZlbnQ6bXV0YXRpb25zfSBldmVudCB3aXRoIGFsbCBtdXRhdGlvbnMgaW4gcmVjb3JkIHF1ZXVlLgogICAqIEF0IHRoZSBzYW1lIHRpbWUgZW1wdGllcyB0aGUgcXVldWUgc28gbXV0YXRpb25zIHdpbGwgbm90IGJlIGZpcmVkIHR3aWNlLgogICAqLwoKCiAgX2NyZWF0ZUNsYXNzKE11dGF0aW9uT2JzZXJ2ZXIsIFt7CiAgICBrZXk6ICJmbHVzaCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmx1c2goKSB7CiAgICAgIHRoaXMuX29uTXV0YXRpb25zKHRoaXMuX211dGF0aW9uT2JzZXJ2ZXIudGFrZVJlY29yZHMoKSk7CiAgICB9CiAgICAvKioKICAgICAqIEBpbmhlcml0RG9jCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib2JzZXJ2ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb2JzZXJ2ZShkb21FbGVtZW50KSB7CiAgICAgIHRoaXMuX2RvbUVsZW1lbnRzLnB1c2goZG9tRWxlbWVudCk7CgogICAgICBpZiAodGhpcy5pc0VuYWJsZWQpIHsKICAgICAgICB0aGlzLl9tdXRhdGlvbk9ic2VydmVyLm9ic2VydmUoZG9tRWxlbWVudCwgdGhpcy5fY29uZmlnKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBAaW5oZXJpdERvYwogICAgICovCgogIH0sIHsKICAgIGtleTogImVuYWJsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZW5hYmxlKCkgewogICAgICBfZ2V0KF9nZXRQcm90b3R5cGVPZihNdXRhdGlvbk9ic2VydmVyLnByb3RvdHlwZSksICJlbmFibGUiLCB0aGlzKS5jYWxsKHRoaXMpOwoKICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlOwogICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IgPSBmYWxzZTsKICAgICAgdmFyIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSB0aGlzLl9kb21FbGVtZW50c1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWUpIHsKICAgICAgICAgIHZhciBkb21FbGVtZW50ID0gX3N0ZXAudmFsdWU7CgogICAgICAgICAgdGhpcy5fbXV0YXRpb25PYnNlcnZlci5vYnNlcnZlKGRvbUVsZW1lbnQsIHRoaXMuX2NvbmZpZyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7CiAgICAgICAgX2l0ZXJhdG9yRXJyb3IgPSBlcnI7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuICE9IG51bGwpIHsKICAgICAgICAgICAgX2l0ZXJhdG9yLnJldHVybigpOwogICAgICAgICAgfQogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IpIHsKICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEBpbmhlcml0RG9jCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZGlzYWJsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzYWJsZSgpIHsKICAgICAgX2dldChfZ2V0UHJvdG90eXBlT2YoTXV0YXRpb25PYnNlcnZlci5wcm90b3R5cGUpLCAiZGlzYWJsZSIsIHRoaXMpLmNhbGwodGhpcyk7CgogICAgICB0aGlzLl9tdXRhdGlvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTsKICAgIH0KICAgIC8qKgogICAgICogQGluaGVyaXREb2MKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJkZXN0cm95IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkgewogICAgICBfZ2V0KF9nZXRQcm90b3R5cGVPZihNdXRhdGlvbk9ic2VydmVyLnByb3RvdHlwZSksICJkZXN0cm95IiwgdGhpcykuY2FsbCh0aGlzKTsKCiAgICAgIHRoaXMuX211dGF0aW9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpOwogICAgfQogICAgLyoqCiAgICAgKiBIYW5kbGVzIG11dGF0aW9ucy4gRGVkdXBsaWNhdGVzLCBtYXJrIHZpZXcgZWxlbWVudHMgdG8gc3luYywgZmlyZSBldmVudCBhbmQgY2FsbCByZW5kZXIuCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqIEBwYXJhbSB7QXJyYXkuPE9iamVjdD59IGRvbU11dGF0aW9ucyBBcnJheSBvZiBuYXRpdmUgbXV0YXRpb25zLgogICAgICovCgogIH0sIHsKICAgIGtleTogIl9vbk11dGF0aW9ucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uTXV0YXRpb25zKGRvbU11dGF0aW9ucykgewogICAgICAvLyBBcyBhIHJlc3VsdCBvZiB0aGlzLmZsdXNoKCkgd2UgY2FuIGhhdmUgYW4gZW1wdHkgY29sbGVjdGlvbi4KICAgICAgaWYgKGRvbU11dGF0aW9ucy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBkb21Db252ZXJ0ZXIgPSB0aGlzLmRvbUNvbnZlcnRlcjsgLy8gVXNlIG1hcCBhbmQgc2V0IGZvciBkZWR1cGxpY2F0aW9uLgoKICAgICAgdmFyIG11dGF0ZWRUZXh0cyA9IG5ldyBNYXAoKTsKICAgICAgdmFyIG11dGF0ZWRFbGVtZW50cyA9IG5ldyBTZXQoKTsgLy8gSGFuZGxlIGBjaGlsZExpc3RgIG11dGF0aW9ucyBmaXJzdCwgc28gd2Ugd2lsbCBiZSBhYmxlIHRvIGNoZWNrIGlmIHRoZSBgY2hhcmFjdGVyRGF0YWAgbXV0YXRpb24gaXMgaW4gdGhlCiAgICAgIC8vIGVsZW1lbnQgd2l0aCBjaGFuZ2VkIHN0cnVjdHVyZSBhbnl3YXkuCgogICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSB0cnVlOwogICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IyID0gZmFsc2U7CiAgICAgIHZhciBfaXRlcmF0b3JFcnJvcjIgPSB1bmRlZmluZWQ7CgogICAgICB0cnkgewogICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSBkb21NdXRhdGlvbnNbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDI7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSAoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWUpIHsKICAgICAgICAgIHZhciBtdXRhdGlvbiA9IF9zdGVwMi52YWx1ZTsKCiAgICAgICAgICBpZiAobXV0YXRpb24udHlwZSA9PT0gJ2NoaWxkTGlzdCcpIHsKICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBkb21Db252ZXJ0ZXIubWFwRG9tVG9WaWV3KG11dGF0aW9uLnRhcmdldCk7IC8vIERvIG5vdCBjb2xsZWN0IG11dGF0aW9ucyBmcm9tIFVJRWxlbWVudHMuCgogICAgICAgICAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50LmlzKCd1aUVsZW1lbnQnKSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZWxlbWVudCAmJiAhdGhpcy5faXNCb2d1c0JyTXV0YXRpb24obXV0YXRpb24pKSB7CiAgICAgICAgICAgICAgbXV0YXRlZEVsZW1lbnRzLmFkZChlbGVtZW50KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gLy8gSGFuZGxlIGBjaGFyYWN0ZXJEYXRhYCBtdXRhdGlvbnMgbGF0ZXIsIHdoZW4gd2UgaGF2ZSB0aGUgZnVsbCBsaXN0IG9mIG5vZGVzIHdoaWNoIGNoYW5nZWQgc3RydWN0dXJlLgoKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IyID0gdHJ1ZTsKICAgICAgICBfaXRlcmF0b3JFcnJvcjIgPSBlcnI7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgJiYgX2l0ZXJhdG9yMi5yZXR1cm4gIT0gbnVsbCkgewogICAgICAgICAgICBfaXRlcmF0b3IyLnJldHVybigpOwogICAgICAgICAgfQogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IyKSB7CiAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IHRydWU7CiAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvcjMgPSBmYWxzZTsKICAgICAgdmFyIF9pdGVyYXRvckVycm9yMyA9IHVuZGVmaW5lZDsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMyA9IGRvbU11dGF0aW9uc1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwMzsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IChfc3RlcDMgPSBfaXRlcmF0b3IzLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zID0gdHJ1ZSkgewogICAgICAgICAgdmFyIF9tdXRhdGlvbiA9IF9zdGVwMy52YWx1ZTsKCiAgICAgICAgICB2YXIgX2VsZW1lbnQgPSBkb21Db252ZXJ0ZXIubWFwRG9tVG9WaWV3KF9tdXRhdGlvbi50YXJnZXQpOyAvLyBEbyBub3QgY29sbGVjdCBtdXRhdGlvbnMgZnJvbSBVSUVsZW1lbnRzLgoKCiAgICAgICAgICBpZiAoX2VsZW1lbnQgJiYgX2VsZW1lbnQuaXMoJ3VpRWxlbWVudCcpKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChfbXV0YXRpb24udHlwZSA9PT0gJ2NoYXJhY3RlckRhdGEnKSB7CiAgICAgICAgICAgIHZhciB0ZXh0ID0gZG9tQ29udmVydGVyLmZpbmRDb3JyZXNwb25kaW5nVmlld1RleHQoX211dGF0aW9uLnRhcmdldCk7CgogICAgICAgICAgICBpZiAodGV4dCAmJiAhbXV0YXRlZEVsZW1lbnRzLmhhcyh0ZXh0LnBhcmVudCkpIHsKICAgICAgICAgICAgICAvLyBVc2UgdGV4dCBhcyBhIGtleSwgZm9yIGRlZHVwbGljYXRpb24uIElmIHRoZXJlIHdpbGwgYmUgYW5vdGhlciBtdXRhdGlvbiBvbiB0aGUgc2FtZSB0ZXh0IGVsZW1lbnQKICAgICAgICAgICAgICAvLyB3ZSB3aWxsIGhhdmUgb25seSBvbmUgaW4gdGhlIG1hcC4KICAgICAgICAgICAgICBtdXRhdGVkVGV4dHMuc2V0KHRleHQsIHsKICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JywKICAgICAgICAgICAgICAgIG9sZFRleHQ6IHRleHQuZGF0YSwKICAgICAgICAgICAgICAgIG5ld1RleHQ6IGdldERhdGFXaXRob3V0RmlsbGVyKF9tdXRhdGlvbi50YXJnZXQpLAogICAgICAgICAgICAgICAgbm9kZTogdGV4dAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IC8vIFdoZW4gd2UgYWRkZWQgZmlyc3QgbGV0dGVyIHRvIHRoZSB0ZXh0IG5vZGUgd2hpY2ggaGFkIG9ubHkgaW5saW5lIGZpbGxlciwgZm9yIHRoZSBET00gaXQgaXMgbXV0YXRpb24KICAgICAgICAgICAgLy8gb24gdGV4dCwgYnV0IGZvciB0aGUgdmlldywgd2hlcmUgZmlsbGVyIHRleHQgbm9kZSBkaWQgbm90IGV4aXN0ZWQsIG5ldyB0ZXh0IG5vZGUgd2FzIGNyZWF0ZWQsIHNvIHdlCiAgICAgICAgICAgIC8vIG5lZWQgdG8gZmlyZSAnY2hpbGRyZW4nIG11dGF0aW9uIGluc3RlYWQgb2YgJ3RleHQnLgogICAgICAgICAgICBlbHNlIGlmICghdGV4dCAmJiBzdGFydHNXaXRoRmlsbGVyKF9tdXRhdGlvbi50YXJnZXQpKSB7CiAgICAgICAgICAgICAgICBtdXRhdGVkRWxlbWVudHMuYWRkKGRvbUNvbnZlcnRlci5tYXBEb21Ub1ZpZXcoX211dGF0aW9uLnRhcmdldC5wYXJlbnROb2RlKSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gLy8gTm93IHdlIGJ1aWxkIHRoZSBsaXN0IG9mIG11dGF0aW9ucyB0byBmaXJlIGFuZCBtYXJrIGVsZW1lbnRzLiBXZSBkaWQgbm90IGRvIGl0IGVhcmxpZXIgdG8gYXZvaWQgbWFya2luZyB0aGUKICAgICAgICAvLyBzYW1lIG5vZGUgbXVsdGlwbGUgdGltZXMgaW4gY2FzZSBvZiBkdXBsaWNhdGlvbi4KICAgICAgICAvLyBMaXN0IG9mIG11dGF0aW9ucyB3ZSB3aWxsIGZpcmUuCgogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjMgPSB0cnVlOwogICAgICAgIF9pdGVyYXRvckVycm9yMyA9IGVycjsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyAmJiBfaXRlcmF0b3IzLnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjMucmV0dXJuKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjMpIHsKICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3IzOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIHZpZXdNdXRhdGlvbnMgPSBbXTsKICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb240ID0gdHJ1ZTsKICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yNCA9IGZhbHNlOwogICAgICB2YXIgX2l0ZXJhdG9yRXJyb3I0ID0gdW5kZWZpbmVkOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3I0ID0gbXV0YXRlZFRleHRzLnZhbHVlcygpW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA0OyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb240ID0gKF9zdGVwNCA9IF9pdGVyYXRvcjQubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjQgPSB0cnVlKSB7CiAgICAgICAgICB2YXIgbXV0YXRlZFRleHQgPSBfc3RlcDQudmFsdWU7CiAgICAgICAgICB0aGlzLnJlbmRlcmVyLm1hcmtUb1N5bmMoJ3RleHQnLCBtdXRhdGVkVGV4dC5ub2RlKTsKICAgICAgICAgIHZpZXdNdXRhdGlvbnMucHVzaChtdXRhdGVkVGV4dCk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjQgPSB0cnVlOwogICAgICAgIF9pdGVyYXRvckVycm9yNCA9IGVycjsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCAmJiBfaXRlcmF0b3I0LnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjQucmV0dXJuKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjQpIHsKICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb241ID0gdHJ1ZTsKICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yNSA9IGZhbHNlOwogICAgICB2YXIgX2l0ZXJhdG9yRXJyb3I1ID0gdW5kZWZpbmVkOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3I1ID0gbXV0YXRlZEVsZW1lbnRzW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA1OyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb241ID0gKF9zdGVwNSA9IF9pdGVyYXRvcjUubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjUgPSB0cnVlKSB7CiAgICAgICAgICB2YXIgdmlld0VsZW1lbnQgPSBfc3RlcDUudmFsdWU7CiAgICAgICAgICB2YXIgZG9tRWxlbWVudCA9IGRvbUNvbnZlcnRlci5tYXBWaWV3VG9Eb20odmlld0VsZW1lbnQpOwogICAgICAgICAgdmFyIHZpZXdDaGlsZHJlbiA9IEFycmF5LmZyb20odmlld0VsZW1lbnQuZ2V0Q2hpbGRyZW4oKSk7CiAgICAgICAgICB2YXIgbmV3Vmlld0NoaWxkcmVuID0gQXJyYXkuZnJvbShkb21Db252ZXJ0ZXIuZG9tQ2hpbGRyZW5Ub1ZpZXcoZG9tRWxlbWVudCwgewogICAgICAgICAgICB3aXRoQ2hpbGRyZW46IGZhbHNlCiAgICAgICAgICB9KSk7IC8vIEl0IG1heSBoYXBwZW4gdGhhdCBhcyBhIHJlc3VsdCBvZiBtYW55IGNoYW5nZXMgKHN0aCB3YXMgaW5zZXJ0ZWQgYW5kIHRoZW4gcmVtb3ZlZCksCiAgICAgICAgICAvLyBib3RoIGVsZW1lbnRzIGhhdmVuJ3QgcmVhbGx5IGNoYW5nZWQuICMxMDMxCgogICAgICAgICAgaWYgKCFpc0VxdWFsV2l0aCh2aWV3Q2hpbGRyZW4sIG5ld1ZpZXdDaGlsZHJlbiwgc2FtZU5vZGVzKSkgewogICAgICAgICAgICB0aGlzLnJlbmRlcmVyLm1hcmtUb1N5bmMoJ2NoaWxkcmVuJywgdmlld0VsZW1lbnQpOwogICAgICAgICAgICB2aWV3TXV0YXRpb25zLnB1c2goewogICAgICAgICAgICAgIHR5cGU6ICdjaGlsZHJlbicsCiAgICAgICAgICAgICAgb2xkQ2hpbGRyZW46IHZpZXdDaGlsZHJlbiwKICAgICAgICAgICAgICBuZXdDaGlsZHJlbjogbmV3Vmlld0NoaWxkcmVuLAogICAgICAgICAgICAgIG5vZGU6IHZpZXdFbGVtZW50CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0gLy8gUmV0cmlldmUgYGRvbVNlbGVjdGlvbmAgdXNpbmcgYG93bmVyRG9jdW1lbnRgIG9mIG9uZSBvZiBtdXRhdGVkIG5vZGVzLgogICAgICAgIC8vIFRoZXJlIHNob3VsZCBub3QgYmUgc2ltdWx0YW5lb3VzIG11dGF0aW9uIGluIG11bHRpcGxlIGRvY3VtZW50cywgc28gaXQncyBmaW5lLgoKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3I1ID0gdHJ1ZTsKICAgICAgICBfaXRlcmF0b3JFcnJvcjUgPSBlcnI7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjUgJiYgX2l0ZXJhdG9yNS5yZXR1cm4gIT0gbnVsbCkgewogICAgICAgICAgICBfaXRlcmF0b3I1LnJldHVybigpOwogICAgICAgICAgfQogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3I1KSB7CiAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yNTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBkb21TZWxlY3Rpb24gPSBkb21NdXRhdGlvbnNbMF0udGFyZ2V0Lm93bmVyRG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCk7CiAgICAgIHZhciB2aWV3U2VsZWN0aW9uID0gbnVsbDsKCiAgICAgIGlmIChkb21TZWxlY3Rpb24gJiYgZG9tU2VsZWN0aW9uLmFuY2hvck5vZGUpIHsKICAgICAgICAvLyBJZiBgZG9tU2VsZWN0aW9uYCBpcyBpbnNpZGUgYSBkb20gbm9kZSB0aGF0IGlzIGFscmVhZHkgYm91bmQgdG8gYSB2aWV3IG5vZGUgZnJvbSB2aWV3IHRyZWUsIGdldAogICAgICAgIC8vIGNvcnJlc3BvbmRpbmcgc2VsZWN0aW9uIGluIHRoZSB2aWV3IGFuZCBwYXNzIGl0IHRvZ2V0aGVyIHdpdGggYHZpZXdNdXRhdGlvbnNgLiBUaGUgYHZpZXdTZWxlY3Rpb25gIG1heQogICAgICAgIC8vIGJlIHVzZWQgYnkgZmVhdHVyZXMgaGFuZGxpbmcgbXV0YXRpb25zLgogICAgICAgIC8vIE9ubHkgb25lIHJhbmdlIGlzIHN1cHBvcnRlZC4KICAgICAgICB2YXIgdmlld1NlbGVjdGlvbkFuY2hvciA9IGRvbUNvbnZlcnRlci5kb21Qb3NpdGlvblRvVmlldyhkb21TZWxlY3Rpb24uYW5jaG9yTm9kZSwgZG9tU2VsZWN0aW9uLmFuY2hvck9mZnNldCk7CiAgICAgICAgdmFyIHZpZXdTZWxlY3Rpb25Gb2N1cyA9IGRvbUNvbnZlcnRlci5kb21Qb3NpdGlvblRvVmlldyhkb21TZWxlY3Rpb24uZm9jdXNOb2RlLCBkb21TZWxlY3Rpb24uZm9jdXNPZmZzZXQpOyAvLyBBbmNob3IgYW5kIGZvY3VzIGhhcyB0byBiZSBwcm9wZXJseSBtYXBwZWQgdG8gdmlldy4KCiAgICAgICAgaWYgKHZpZXdTZWxlY3Rpb25BbmNob3IgJiYgdmlld1NlbGVjdGlvbkZvY3VzKSB7CiAgICAgICAgICB2aWV3U2VsZWN0aW9uID0gbmV3IFZpZXdTZWxlY3Rpb24odmlld1NlbGVjdGlvbkFuY2hvcik7CiAgICAgICAgICB2aWV3U2VsZWN0aW9uLnNldEZvY3VzKHZpZXdTZWxlY3Rpb25Gb2N1cyk7CiAgICAgICAgfQogICAgICB9IC8vIEluIGNhc2Ugb25seSBub24tcmVsZXZhbnQgbXV0YXRpb25zIHdlcmUgcmVjb3JkZWQgaXQgc2tpcHMgdGhlIGV2ZW50IGFuZCBmb3JjZSByZW5kZXIgKCM1NjAwKS4KCgogICAgICBpZiAodmlld011dGF0aW9ucy5sZW5ndGgpIHsKICAgICAgICB0aGlzLmRvY3VtZW50LmZpcmUoJ211dGF0aW9ucycsIHZpZXdNdXRhdGlvbnMsIHZpZXdTZWxlY3Rpb24pOyAvLyBJZiBub3RoaW5nIGNoYW5nZXMgb24gYG11dGF0aW9uc2AgZXZlbnQsIGF0IHRoaXMgcG9pbnQgd2UgaGF2ZSAiZGlydHkgRE9NIiAoY2hhbmdlZCkgYW5kIGRlLXN5bmNoZWQKICAgICAgICAvLyB2aWV3ICh3aGljaCBoYXMgbm90IGJlZW4gY2hhbmdlZCkuIEluIG9yZGVyIHRvICJyZXNldCBET00iIHdlIHJlbmRlciB0aGUgdmlldyBhZ2Fpbi4KCiAgICAgICAgdGhpcy52aWV3LmZvcmNlUmVuZGVyKCk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHNhbWVOb2RlcyhjaGlsZDEsIGNoaWxkMikgewogICAgICAgIC8vIEZpcnN0IGxldmVsIG9mIGNvbXBhcmlzb24gKGFycmF5IG9mIGNoaWxkcmVuIHZzIGFycmF5IG9mIGNoaWxkcmVuKSDigJMgdXNlIHRoZSBMb2Rhc2gncyBkZWZhdWx0IGJlaGF2aW9yLgogICAgICAgIGlmIChBcnJheS5pc0FycmF5KGNoaWxkMSkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IC8vIEVsZW1lbnRzLgoKCiAgICAgICAgaWYgKGNoaWxkMSA9PT0gY2hpbGQyKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IC8vIFRleHRzLgogICAgICAgIGVsc2UgaWYgKGNoaWxkMS5pcygndGV4dCcpICYmIGNoaWxkMi5pcygndGV4dCcpKSB7CiAgICAgICAgICAgIHJldHVybiBjaGlsZDEuZGF0YSA9PT0gY2hpbGQyLmRhdGE7CiAgICAgICAgICB9IC8vIE5vdCBtYXRjaGluZyB0eXBlcy4KCgogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGVja3MgaWYgbXV0YXRpb24gd2FzIGdlbmVyYXRlZCBieSB0aGUgYnJvd3NlciBpbnNlcnRpbmcgYm9ndXMgYnIgb24gdGhlIGVuZCBvZiB0aGUgYmxvY2sgZWxlbWVudC4KICAgICAqIFN1Y2ggbXV0YXRpb25zIGFyZSBnZW5lcmF0ZWQgd2hpbGUgcHJlc3Npbmcgc3BhY2Ugb3IgcGVyZm9ybWluZyBuYXRpdmUgc3BlbGxjaGVja2VyIGNvcnJlY3Rpb24KICAgICAqIG9uIHRoZSBlbmQgb2YgdGhlIGJsb2NrIGVsZW1lbnQgaW4gRmlyZWZveCBicm93c2VyLgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKiBAcGFyYW0ge09iamVjdH0gbXV0YXRpb24gTmF0aXZlIG11dGF0aW9uIG9iamVjdC4KICAgICAqIEByZXR1cm5zIHtCb29sZWFufQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9pc0JvZ3VzQnJNdXRhdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2lzQm9ndXNCck11dGF0aW9uKG11dGF0aW9uKSB7CiAgICAgIHZhciBhZGRlZE5vZGUgPSBudWxsOyAvLyBDaGVjayBpZiBtdXRhdGlvbiBhZGRlZCBvbmx5IG9uZSBub2RlIG9uIHRoZSBlbmQgb2YgaXRzIHBhcmVudC4KCiAgICAgIGlmIChtdXRhdGlvbi5uZXh0U2libGluZyA9PT0gbnVsbCAmJiBtdXRhdGlvbi5yZW1vdmVkTm9kZXMubGVuZ3RoID09PSAwICYmIG11dGF0aW9uLmFkZGVkTm9kZXMubGVuZ3RoID09IDEpIHsKICAgICAgICBhZGRlZE5vZGUgPSB0aGlzLmRvbUNvbnZlcnRlci5kb21Ub1ZpZXcobXV0YXRpb24uYWRkZWROb2Rlc1swXSwgewogICAgICAgICAgd2l0aENoaWxkcmVuOiBmYWxzZQogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gYWRkZWROb2RlICYmIGFkZGVkTm9kZS5pcygnZWxlbWVudCcsICdicicpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIE11dGF0aW9uT2JzZXJ2ZXI7Cn0oT2JzZXJ2ZXIpOwovKioKICogRmlyZWQgd2hlbiBtdXRhdGlvbiBvY2N1cnJlZC4gSWYgdHJlZSB2aWV3IGlzIG5vdCBjaGFuZ2VkIG9uIHRoaXMgZXZlbnQsIERPTSB3aWxsIGJlIHJldmVydGVkIHRvIHRoZSBzdGF0ZSBiZWZvcmUKICogbXV0YXRpb24sIHNvIGFsbCBjaGFuZ2VzIHdoaWNoIHNob3VsZCBiZSBhcHBsaWVkLCBzaG91bGQgYmUgaGFuZGxlZCBvbiB0aGlzIGV2ZW50LgogKgogKiBJbnRyb2R1Y2VkIGJ5IHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvb2JzZXJ2ZXIvbXV0YXRpb25vYnNlcnZlcn5NdXRhdGlvbk9ic2VydmVyfS4KICoKICogTm90ZSB0aGF0IGJlY2F1c2Uge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9vYnNlcnZlci9tdXRhdGlvbm9ic2VydmVyfk11dGF0aW9uT2JzZXJ2ZXJ9IGlzIGF0dGFjaGVkIGJ5IHRoZQogKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3ZpZXd+Vmlld30gdGhpcyBldmVudCBpcyBhdmFpbGFibGUgYnkgZGVmYXVsdC4KICoKICogQHNlZSBtb2R1bGU6ZW5naW5lL3ZpZXcvb2JzZXJ2ZXIvbXV0YXRpb25vYnNlcnZlcn5NdXRhdGlvbk9ic2VydmVyCiAqIEBldmVudCBtb2R1bGU6ZW5naW5lL3ZpZXcvZG9jdW1lbnR+RG9jdW1lbnQjZXZlbnQ6bXV0YXRpb25zCiAqIEBwYXJhbSB7QXJyYXkuPG1vZHVsZTplbmdpbmUvdmlldy9vYnNlcnZlci9tdXRhdGlvbm9ic2VydmVyfk11dGF0ZWRUZXh0fG1vZHVsZTplbmdpbmUvdmlldy9vYnNlcnZlci9tdXRhdGlvbm9ic2VydmVyfk11dGF0ZWRDaGlsZHJlbj59CiAqIHZpZXdNdXRhdGlvbnMgQXJyYXkgb2YgbXV0YXRpb25zLgogKiBGb3IgbXV0YXRlZCB0ZXh0cyBpdCB3aWxsIGJlIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvb2JzZXJ2ZXIvbXV0YXRpb25vYnNlcnZlcn5NdXRhdGVkVGV4dH0gYW5kIGZvciBtdXRhdGVkIGVsZW1lbnRzIGl0IHdpbGwgYmUKICoge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9vYnNlcnZlci9tdXRhdGlvbm9ic2VydmVyfk11dGF0ZWRDaGlsZHJlbn0uIFlvdSBjYW4gcmVjb2duaXplIHRoZSB0eXBlIGJhc2VkIG9uIHRoZSBgdHlwZWAgcHJvcGVydHkuCiAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L3NlbGVjdGlvbn5TZWxlY3Rpb258bnVsbH0gdmlld1NlbGVjdGlvbiBWaWV3IHNlbGVjdGlvbiB0aGF0IGlzIGEgcmVzdWx0IG9mIGNvbnZlcnRpbmcgRE9NIHNlbGVjdGlvbiB0byB2aWV3LgogKiBLZWVwIGluCiAqIG1pbmQgdGhhdCB0aGUgRE9NIHNlbGVjdGlvbiBpcyBhbHJlYWR5ICJ1cGRhdGVkIiwgbWVhbmluZyB0aGF0IGl0IGFscmVhZHkgYWNrbm93bGVkZ2VzIGNoYW5nZXMgZG9uZSBpbiBtdXRhdGlvbi4KICovCgovKioKICogTXV0YXRpb24gaXRlbSBmb3IgdGV4dC4KICoKICogQHNlZSBtb2R1bGU6ZW5naW5lL3ZpZXcvZG9jdW1lbnR+RG9jdW1lbnQjZXZlbnQ6bXV0YXRpb25zCiAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L29ic2VydmVyL211dGF0aW9ub2JzZXJ2ZXJ+TXV0YXRlZENoaWxkcmVuCiAqCiAqIEB0eXBlZGVmIHtPYmplY3R9IG1vZHVsZTplbmdpbmUvdmlldy9vYnNlcnZlci9tdXRhdGlvbm9ic2VydmVyfk11dGF0ZWRUZXh0CiAqCiAqIEBwcm9wZXJ0eSB7U3RyaW5nfSB0eXBlIEZvciB0ZXh0IG11dGF0aW9ucyBpdCBpcyBhbHdheXMgJ3RleHQnLgogKiBAcHJvcGVydHkge21vZHVsZTplbmdpbmUvdmlldy90ZXh0flRleHR9IG5vZGUgTXV0YXRlZCB0ZXh0IG5vZGUuCiAqIEBwcm9wZXJ0eSB7U3RyaW5nfSBvbGRUZXh0IE9sZCB0ZXh0LgogKiBAcHJvcGVydHkge1N0cmluZ30gbmV3VGV4dCBOZXcgdGV4dC4KICovCgovKioKICogTXV0YXRpb24gaXRlbSBmb3IgY2hpbGQgbm9kZXMuCiAqCiAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L2RvY3VtZW50fkRvY3VtZW50I2V2ZW50Om11dGF0aW9ucwogKiBAc2VlIG1vZHVsZTplbmdpbmUvdmlldy9vYnNlcnZlci9tdXRhdGlvbm9ic2VydmVyfk11dGF0ZWRUZXh0CiAqCiAqIEB0eXBlZGVmIHtPYmplY3R9IG1vZHVsZTplbmdpbmUvdmlldy9vYnNlcnZlci9tdXRhdGlvbm9ic2VydmVyfk11dGF0ZWRDaGlsZHJlbgogKgogKiBAcHJvcGVydHkge1N0cmluZ30gdHlwZSBGb3IgY2hpbGQgbm9kZXMgbXV0YXRpb25zIGl0IGlzIGFsd2F5cyAnY2hpbGRyZW4nLgogKiBAcHJvcGVydHkge21vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9IG5vZGUgUGFyZW50IG9mIHRoZSBtdXRhdGVkIGNoaWxkcmVuLgogKiBAcHJvcGVydHkge0FycmF5Ljxtb2R1bGU6ZW5naW5lL3ZpZXcvbm9kZX5Ob2RlPn0gb2xkQ2hpbGRyZW4gT2xkIGNoaWxkIG5vZGVzLgogKiBAcHJvcGVydHkge0FycmF5Ljxtb2R1bGU6ZW5naW5lL3ZpZXcvbm9kZX5Ob2RlPn0gbmV3Q2hpbGRyZW4gTmV3IGNoaWxkIG5vZGVzLgogKi8KCgpleHBvcnQgeyBNdXRhdGlvbk9ic2VydmVyIGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["C:/Users/pc/Desktop/Restoran/Restoran/Restoran.UI/client/node_modules/@ckeditor/ckeditor5-engine/src/view/observer/mutationobserver.js"],"names":["Observer","ViewSelection","startsWithFiller","getDataWithoutFiller","isEqualWith","MutationObserver","view","_config","childList","characterData","characterDataOldValue","subtree","domConverter","renderer","_renderer","_domElements","_mutationObserver","window","_onMutations","bind","takeRecords","domElement","push","isEnabled","observe","disconnect","domMutations","length","mutatedTexts","Map","mutatedElements","Set","mutation","type","element","mapDomToView","target","is","_isBogusBrMutation","add","text","findCorrespondingViewText","has","parent","set","oldText","data","newText","node","parentNode","viewMutations","values","mutatedText","markToSync","viewElement","mapViewToDom","viewChildren","Array","from","getChildren","newViewChildren","domChildrenToView","withChildren","sameNodes","oldChildren","newChildren","domSelection","ownerDocument","getSelection","viewSelection","anchorNode","viewSelectionAnchor","domPositionToView","anchorOffset","viewSelectionFocus","focusNode","focusOffset","setFocus","document","fire","forceRender","child1","child2","isArray","addedNode","nextSibling","removedNodes","addedNodes","domToView"],"mappings":"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","sourcesContent":["/**\n * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module engine/view/observer/mutationobserver\n */\n\n/* globals window */\n\nimport Observer from './observer';\nimport ViewSelection from '../selection';\nimport { startsWithFiller, getDataWithoutFiller } from '../filler';\nimport { isEqualWith } from 'lodash-es';\n\n/**\n * Mutation observer class observes changes in the DOM, fires {@link module:engine/view/document~Document#event:mutations} event, mark view\n * elements as changed and call {@link module:engine/view/renderer~Renderer#render}.\n * Because all mutated nodes are marked as \"to be rendered\" and the\n * {@link module:engine/view/renderer~Renderer#render} is called, all changes will be reverted, unless the mutation will be handled by the\n * {@link module:engine/view/document~Document#event:mutations} event listener. It means user will see only handled changes, and the editor\n * will block all changes which are not handled.\n *\n * Mutation Observer also take care of reducing number of mutations which are fired. It removes duplicates and\n * mutations on elements which do not have corresponding view elements. Also\n * {@link module:engine/view/observer/mutationobserver~MutatedText text mutation} is fired only if parent element do not change child list.\n *\n * Note that this observer is attached by the {@link module:engine/view/view~View} and is available by default.\n *\n * @extends module:engine/view/observer/observer~Observer\n */\nexport default class MutationObserver extends Observer {\n\tconstructor( view ) {\n\t\tsuper( view );\n\n\t\t/**\n\t\t * Native mutation observer config.\n\t\t *\n\t\t * @private\n\t\t * @member {Object}\n\t\t */\n\t\tthis._config = {\n\t\t\tchildList: true,\n\t\t\tcharacterData: true,\n\t\t\tcharacterDataOldValue: true,\n\t\t\tsubtree: true\n\t\t};\n\n\t\t/**\n\t\t * Reference to the {@link module:engine/view/view~View#domConverter}.\n\t\t *\n\t\t * @member {module:engine/view/domconverter~DomConverter}\n\t\t */\n\t\tthis.domConverter = view.domConverter;\n\n\t\t/**\n\t\t * Reference to the {@link module:engine/view/view~View#_renderer}.\n\t\t *\n\t\t * @member {module:engine/view/renderer~Renderer}\n\t\t */\n\t\tthis.renderer = view._renderer;\n\n\t\t/**\n\t\t * Observed DOM elements.\n\t\t *\n\t\t * @private\n\t\t * @member {Array.<HTMLElement>}\n\t\t */\n\t\tthis._domElements = [];\n\n\t\t/**\n\t\t * Native mutation observer.\n\t\t *\n\t\t * @private\n\t\t * @member {MutationObserver}\n\t\t */\n\t\tthis._mutationObserver = new window.MutationObserver( this._onMutations.bind( this ) );\n\t}\n\n\t/**\n\t * Synchronously fires {@link module:engine/view/document~Document#event:mutations} event with all mutations in record queue.\n\t * At the same time empties the queue so mutations will not be fired twice.\n\t */\n\tflush() {\n\t\tthis._onMutations( this._mutationObserver.takeRecords() );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tobserve( domElement ) {\n\t\tthis._domElements.push( domElement );\n\n\t\tif ( this.isEnabled ) {\n\t\t\tthis._mutationObserver.observe( domElement, this._config );\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tenable() {\n\t\tsuper.enable();\n\n\t\tfor ( const domElement of this._domElements ) {\n\t\t\tthis._mutationObserver.observe( domElement, this._config );\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdisable() {\n\t\tsuper.disable();\n\n\t\tthis._mutationObserver.disconnect();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdestroy() {\n\t\tsuper.destroy();\n\n\t\tthis._mutationObserver.disconnect();\n\t}\n\n\t/**\n\t * Handles mutations. Deduplicates, mark view elements to sync, fire event and call render.\n\t *\n\t * @private\n\t * @param {Array.<Object>} domMutations Array of native mutations.\n\t */\n\t_onMutations( domMutations ) {\n\t\t// As a result of this.flush() we can have an empty collection.\n\t\tif ( domMutations.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst domConverter = this.domConverter;\n\n\t\t// Use map and set for deduplication.\n\t\tconst mutatedTexts = new Map();\n\t\tconst mutatedElements = new Set();\n\n\t\t// Handle `childList` mutations first, so we will be able to check if the `characterData` mutation is in the\n\t\t// element with changed structure anyway.\n\t\tfor ( const mutation of domMutations ) {\n\t\t\tif ( mutation.type === 'childList' ) {\n\t\t\t\tconst element = domConverter.mapDomToView( mutation.target );\n\n\t\t\t\t// Do not collect mutations from UIElements.\n\t\t\t\tif ( element && element.is( 'uiElement' ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif ( element && !this._isBogusBrMutation( mutation ) ) {\n\t\t\t\t\tmutatedElements.add( element );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Handle `characterData` mutations later, when we have the full list of nodes which changed structure.\n\t\tfor ( const mutation of domMutations ) {\n\t\t\tconst element = domConverter.mapDomToView( mutation.target );\n\n\t\t\t// Do not collect mutations from UIElements.\n\t\t\tif ( element && element.is( 'uiElement' ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif ( mutation.type === 'characterData' ) {\n\t\t\t\tconst text = domConverter.findCorrespondingViewText( mutation.target );\n\n\t\t\t\tif ( text && !mutatedElements.has( text.parent ) ) {\n\t\t\t\t\t// Use text as a key, for deduplication. If there will be another mutation on the same text element\n\t\t\t\t\t// we will have only one in the map.\n\t\t\t\t\tmutatedTexts.set( text, {\n\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\toldText: text.data,\n\t\t\t\t\t\tnewText: getDataWithoutFiller( mutation.target ),\n\t\t\t\t\t\tnode: text\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\t// When we added first letter to the text node which had only inline filler, for the DOM it is mutation\n\t\t\t\t// on text, but for the view, where filler text node did not existed, new text node was created, so we\n\t\t\t\t// need to fire 'children' mutation instead of 'text'.\n\t\t\t\telse if ( !text && startsWithFiller( mutation.target ) ) {\n\t\t\t\t\tmutatedElements.add( domConverter.mapDomToView( mutation.target.parentNode ) );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Now we build the list of mutations to fire and mark elements. We did not do it earlier to avoid marking the\n\t\t// same node multiple times in case of duplication.\n\n\t\t// List of mutations we will fire.\n\t\tconst viewMutations = [];\n\n\t\tfor ( const mutatedText of mutatedTexts.values() ) {\n\t\t\tthis.renderer.markToSync( 'text', mutatedText.node );\n\t\t\tviewMutations.push( mutatedText );\n\t\t}\n\n\t\tfor ( const viewElement of mutatedElements ) {\n\t\t\tconst domElement = domConverter.mapViewToDom( viewElement );\n\t\t\tconst viewChildren = Array.from( viewElement.getChildren() );\n\t\t\tconst newViewChildren = Array.from( domConverter.domChildrenToView( domElement, { withChildren: false } ) );\n\n\t\t\t// It may happen that as a result of many changes (sth was inserted and then removed),\n\t\t\t// both elements haven't really changed. #1031\n\t\t\tif ( !isEqualWith( viewChildren, newViewChildren, sameNodes ) ) {\n\t\t\t\tthis.renderer.markToSync( 'children', viewElement );\n\n\t\t\t\tviewMutations.push( {\n\t\t\t\t\ttype: 'children',\n\t\t\t\t\toldChildren: viewChildren,\n\t\t\t\t\tnewChildren: newViewChildren,\n\t\t\t\t\tnode: viewElement\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\t// Retrieve `domSelection` using `ownerDocument` of one of mutated nodes.\n\t\t// There should not be simultaneous mutation in multiple documents, so it's fine.\n\t\tconst domSelection = domMutations[ 0 ].target.ownerDocument.getSelection();\n\n\t\tlet viewSelection = null;\n\n\t\tif ( domSelection && domSelection.anchorNode ) {\n\t\t\t// If `domSelection` is inside a dom node that is already bound to a view node from view tree, get\n\t\t\t// corresponding selection in the view and pass it together with `viewMutations`. The `viewSelection` may\n\t\t\t// be used by features handling mutations.\n\t\t\t// Only one range is supported.\n\n\t\t\tconst viewSelectionAnchor = domConverter.domPositionToView( domSelection.anchorNode, domSelection.anchorOffset );\n\t\t\tconst viewSelectionFocus = domConverter.domPositionToView( domSelection.focusNode, domSelection.focusOffset );\n\n\t\t\t// Anchor and focus has to be properly mapped to view.\n\t\t\tif ( viewSelectionAnchor && viewSelectionFocus ) {\n\t\t\t\tviewSelection = new ViewSelection( viewSelectionAnchor );\n\t\t\t\tviewSelection.setFocus( viewSelectionFocus );\n\t\t\t}\n\t\t}\n\n\t\t// In case only non-relevant mutations were recorded it skips the event and force render (#5600).\n\t\tif ( viewMutations.length ) {\n\t\t\tthis.document.fire( 'mutations', viewMutations, viewSelection );\n\n\t\t\t// If nothing changes on `mutations` event, at this point we have \"dirty DOM\" (changed) and de-synched\n\t\t\t// view (which has not been changed). In order to \"reset DOM\" we render the view again.\n\t\t\tthis.view.forceRender();\n\t\t}\n\n\t\tfunction sameNodes( child1, child2 ) {\n\t\t\t// First level of comparison (array of children vs array of children) â€“ use the Lodash's default behavior.\n\t\t\tif ( Array.isArray( child1 ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Elements.\n\t\t\tif ( child1 === child2 ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\t// Texts.\n\t\t\telse if ( child1.is( 'text' ) && child2.is( 'text' ) ) {\n\t\t\t\treturn child1.data === child2.data;\n\t\t\t}\n\n\t\t\t// Not matching types.\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Checks if mutation was generated by the browser inserting bogus br on the end of the block element.\n\t * Such mutations are generated while pressing space or performing native spellchecker correction\n\t * on the end of the block element in Firefox browser.\n\t *\n\t * @private\n\t * @param {Object} mutation Native mutation object.\n\t * @returns {Boolean}\n\t */\n\t_isBogusBrMutation( mutation ) {\n\t\tlet addedNode = null;\n\n\t\t// Check if mutation added only one node on the end of its parent.\n\t\tif ( mutation.nextSibling === null && mutation.removedNodes.length === 0 && mutation.addedNodes.length == 1 ) {\n\t\t\taddedNode = this.domConverter.domToView( mutation.addedNodes[ 0 ], {\n\t\t\t\twithChildren: false\n\t\t\t} );\n\t\t}\n\n\t\treturn addedNode && addedNode.is( 'element', 'br' );\n\t}\n}\n\n/**\n * Fired when mutation occurred. If tree view is not changed on this event, DOM will be reverted to the state before\n * mutation, so all changes which should be applied, should be handled on this event.\n *\n * Introduced by {@link module:engine/view/observer/mutationobserver~MutationObserver}.\n *\n * Note that because {@link module:engine/view/observer/mutationobserver~MutationObserver} is attached by the\n * {@link module:engine/view/view~View} this event is available by default.\n *\n * @see module:engine/view/observer/mutationobserver~MutationObserver\n * @event module:engine/view/document~Document#event:mutations\n * @param {Array.<module:engine/view/observer/mutationobserver~MutatedText|module:engine/view/observer/mutationobserver~MutatedChildren>}\n * viewMutations Array of mutations.\n * For mutated texts it will be {@link module:engine/view/observer/mutationobserver~MutatedText} and for mutated elements it will be\n * {@link module:engine/view/observer/mutationobserver~MutatedChildren}. You can recognize the type based on the `type` property.\n * @param {module:engine/view/selection~Selection|null} viewSelection View selection that is a result of converting DOM selection to view.\n * Keep in\n * mind that the DOM selection is already \"updated\", meaning that it already acknowledges changes done in mutation.\n */\n\n/**\n * Mutation item for text.\n *\n * @see module:engine/view/document~Document#event:mutations\n * @see module:engine/view/observer/mutationobserver~MutatedChildren\n *\n * @typedef {Object} module:engine/view/observer/mutationobserver~MutatedText\n *\n * @property {String} type For text mutations it is always 'text'.\n * @property {module:engine/view/text~Text} node Mutated text node.\n * @property {String} oldText Old text.\n * @property {String} newText New text.\n */\n\n/**\n * Mutation item for child nodes.\n *\n * @see module:engine/view/document~Document#event:mutations\n * @see module:engine/view/observer/mutationobserver~MutatedText\n *\n * @typedef {Object} module:engine/view/observer/mutationobserver~MutatedChildren\n *\n * @property {String} type For child nodes mutations it is always 'children'.\n * @property {module:engine/view/element~Element} node Parent of the mutated children.\n * @property {Array.<module:engine/view/node~Node>} oldChildren Old child nodes.\n * @property {Array.<module:engine/view/node~Node>} newChildren New child nodes.\n */\n"]}]}