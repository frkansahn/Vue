{"remainingRequest":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-widget\\src\\widget.js","dependencies":[{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-widget\\src\\widget.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-dev-webpack-plugin\\lib\\translatesourceloader.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1581760768702},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1581760786382},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1581760768279}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZnJvbSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmFuY2hvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkM6XFxVc2Vyc1xccGNcXERlc2t0b3BcXFJlc3RvcmFuXFxSZXN0b3JhblxcUmVzdG9yYW4uVUlcXGNsaWVudFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6XFxVc2Vyc1xccGNcXERlc2t0b3BcXFJlc3RvcmFuXFxSZXN0b3JhblxcUmVzdG9yYW4uVUlcXGNsaWVudFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gZnJvbSAiQzpcXFVzZXJzXFxwY1xcRGVza3RvcFxcUmVzdG9yYW5cXFJlc3RvcmFuXFxSZXN0b3Jhbi5VSVxcY2xpZW50XFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIjsKaW1wb3J0IF9nZXRQcm90b3R5cGVPZiBmcm9tICJDOlxcVXNlcnNcXHBjXFxEZXNrdG9wXFxSZXN0b3JhblxcUmVzdG9yYW5cXFJlc3RvcmFuLlVJXFxjbGllbnRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2dldFByb3RvdHlwZU9mIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICJDOlxcVXNlcnNcXHBjXFxEZXNrdG9wXFxSZXN0b3JhblxcUmVzdG9yYW5cXFJlc3RvcmFuLlVJXFxjbGllbnRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKCi8qKgogKiBAbGljZW5zZSBDb3B5cmlnaHQgKGMpIDIwMDMtMjAyMCwgQ0tTb3VyY2UgLSBGcmVkZXJpY28gS25hYmJlbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICogRm9yIGxpY2Vuc2luZywgc2VlIExJQ0VOU0UubWQgb3IgaHR0cHM6Ly9ja2VkaXRvci5jb20vbGVnYWwvY2tlZGl0b3Itb3NzLWxpY2Vuc2UKICovCgovKioKICogQG1vZHVsZSB3aWRnZXQvd2lkZ2V0CiAqLwppbXBvcnQgUGx1Z2luIGZyb20gJ0Bja2VkaXRvci9ja2VkaXRvcjUtY29yZS9zcmMvcGx1Z2luJzsKaW1wb3J0IE1vdXNlT2JzZXJ2ZXIgZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS1lbmdpbmUvc3JjL3ZpZXcvb2JzZXJ2ZXIvbW91c2VvYnNlcnZlcic7CmltcG9ydCB7IGdldExhYmVsLCBpc1dpZGdldCwgV0lER0VUX1NFTEVDVEVEX0NMQVNTX05BTUUgfSBmcm9tICcuL3V0aWxzJzsKaW1wb3J0IHsgZ2V0Q29kZSwga2V5Q29kZXMsIHBhcnNlS2V5c3Ryb2tlIH0gZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11dGlscy9zcmMva2V5Ym9hcmQnOwppbXBvcnQgZW52IGZyb20gJ0Bja2VkaXRvci9ja2VkaXRvcjUtdXRpbHMvc3JjL2Vudic7CmltcG9ydCAnLi4vdGhlbWUvd2lkZ2V0LmNzcyc7CnZhciBzZWxlY3RBbGxLZXlzdHJva2VDb2RlID0gcGFyc2VLZXlzdHJva2UoJ0N0cmwrQScpOwovKioKICogVGhlIHdpZGdldCBwbHVnaW4uIEl0IGVuYWJsZXMgYmFzZSBzdXBwb3J0IGZvciB3aWRnZXRzLgogKgogKiBTZWUge0BnbGluayBhcGkvd2lkZ2V0IHBhY2thZ2UgcGFnZX0gZm9yIG1vcmUgZGV0YWlscyBhbmQgZG9jdW1lbnRhdGlvbi4KICoKICogVGhpcyBwbHVnaW4gZW5hYmxlcyBtdWx0aXBsZSBiZWhhdmlvcnMgcmVxdWlyZWQgYnkgd2lkZ2V0czoKICoKICogKiBUaGUgbW9kZWwgdG8gdmlldyBzZWxlY3Rpb24gY29udmVydGVyIGZvciB0aGUgZWRpdGluZyBwaXBlbGluZSAoaXQgaGFuZGxlcyB3aWRnZXQgY3VzdG9tIHNlbGVjdGlvbiByZW5kZXJpbmcpLgogKiBJZiBhIGNvbnZlcnRlZCBzZWxlY3Rpb24gd3JhcHMgYXJvdW5kIGEgd2lkZ2V0IGVsZW1lbnQsIHRoYXQgc2VsZWN0aW9uIGlzIG1hcmtlZCBhcwogKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3NlbGVjdGlvbn5TZWxlY3Rpb24jaXNGYWtlIGZha2V9LiBBZGRpdGlvbmFsbHksIHRoZSBgY2std2lkZ2V0X3NlbGVjdGVkYCBDU1MgY2xhc3MKICogaXMgYWRkZWQgdG8gaW5kaWNhdGUgdGhhdCB3aWRnZXQgaGFzIGJlZW4gc2VsZWN0ZWQuCiAqICogVGhlIG1vdXNlIGFuZCBrZXlib2FyZCBldmVudHMgaGFuZGxpbmcgb24gYW5kIGFyb3VuZCB3aWRnZXQgZWxlbWVudHMuCiAqCiAqIEBleHRlbmRzIG1vZHVsZTpjb3JlL3BsdWdpbn5QbHVnaW4KICovCgp2YXIgV2lkZ2V0ID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX1BsdWdpbikgewogIF9pbmhlcml0cyhXaWRnZXQsIF9QbHVnaW4pOwoKICBmdW5jdGlvbiBXaWRnZXQoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgV2lkZ2V0KTsKCiAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKFdpZGdldCkuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoV2lkZ2V0LCBbewogICAga2V5OiAiaW5pdCIsCgogICAgLyoqCiAgICAgKiBAaW5oZXJpdERvYwogICAgICovCiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciB2aWV3ID0gdGhpcy5lZGl0b3IuZWRpdGluZy52aWV3OwogICAgICB2YXIgdmlld0RvY3VtZW50ID0gdmlldy5kb2N1bWVudDsKICAgICAgLyoqCiAgICAgICAqIEhvbGRzIHByZXZpb3VzbHkgc2VsZWN0ZWQgd2lkZ2V0cy4KICAgICAgICoKICAgICAgICogQHByaXZhdGUKICAgICAgICogQHR5cGUge1NldC48bW9kdWxlOmVuZ2luZS92aWV3L2VsZW1lbnR+RWxlbWVudD59CiAgICAgICAqLwoKICAgICAgdGhpcy5fcHJldmlvdXNseVNlbGVjdGVkID0gbmV3IFNldCgpOyAvLyBNb2RlbCB0byB2aWV3IHNlbGVjdGlvbiBjb252ZXJ0ZXIuCiAgICAgIC8vIENvbnZlcnRzIHNlbGVjdGlvbiBwbGFjZWQgb3ZlciB3aWRnZXQgZWxlbWVudCB0byBmYWtlIHNlbGVjdGlvbgoKICAgICAgdGhpcy5lZGl0b3IuZWRpdGluZy5kb3duY2FzdERpc3BhdGNoZXIub24oJ3NlbGVjdGlvbicsIGZ1bmN0aW9uIChldnQsIGRhdGEsIGNvbnZlcnNpb25BcGkpIHsKICAgICAgICAvLyBSZW1vdmUgc2VsZWN0ZWQgY2xhc3MgZnJvbSBwcmV2aW91c2x5IHNlbGVjdGVkIHdpZGdldHMuCiAgICAgICAgX3RoaXMuX2NsZWFyUHJldmlvdXNseVNlbGVjdGVkV2lkZ2V0cyhjb252ZXJzaW9uQXBpLndyaXRlcik7CgogICAgICAgIHZhciB2aWV3V3JpdGVyID0gY29udmVyc2lvbkFwaS53cml0ZXI7CiAgICAgICAgdmFyIHZpZXdTZWxlY3Rpb24gPSB2aWV3V3JpdGVyLmRvY3VtZW50LnNlbGVjdGlvbjsKICAgICAgICB2YXIgc2VsZWN0ZWRFbGVtZW50ID0gdmlld1NlbGVjdGlvbi5nZXRTZWxlY3RlZEVsZW1lbnQoKTsKICAgICAgICB2YXIgbGFzdE1hcmtlZCA9IG51bGw7CiAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlOwogICAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlOwogICAgICAgIHZhciBfaXRlcmF0b3JFcnJvciA9IHVuZGVmaW5lZDsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvciA9IHZpZXdTZWxlY3Rpb24uZ2V0UmFuZ2VzKClbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gKF9zdGVwID0gX2l0ZXJhdG9yLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlKSB7CiAgICAgICAgICAgIHZhciByYW5nZSA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSB0cnVlOwogICAgICAgICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IyID0gZmFsc2U7CiAgICAgICAgICAgIHZhciBfaXRlcmF0b3JFcnJvcjIgPSB1bmRlZmluZWQ7CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSByYW5nZVtTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwMjsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IChfc3RlcDIgPSBfaXRlcmF0b3IyLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZSkgewogICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gX3N0ZXAyLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIG5vZGUgPSB2YWx1ZS5pdGVtOyAvLyBEbyBub3QgbWFyayBuZXN0ZWQgd2lkZ2V0cyBpbiBzZWxlY3RlZCBvbmUuIFNlZTogIzU3LgoKICAgICAgICAgICAgICAgIGlmIChpc1dpZGdldChub2RlKSAmJiAhaXNDaGlsZChub2RlLCBsYXN0TWFya2VkKSkgewogICAgICAgICAgICAgICAgICB2aWV3V3JpdGVyLmFkZENsYXNzKFdJREdFVF9TRUxFQ1RFRF9DTEFTU19OQU1FLCBub2RlKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzLl9wcmV2aW91c2x5U2VsZWN0ZWQuYWRkKG5vZGUpOwoKICAgICAgICAgICAgICAgICAgbGFzdE1hcmtlZCA9IG5vZGU7IC8vIENoZWNrIGlmIHdpZGdldCBpcyBhIHNpbmdsZSBlbGVtZW50IHNlbGVjdGVkLgoKICAgICAgICAgICAgICAgICAgaWYgKG5vZGUgPT0gc2VsZWN0ZWRFbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgdmlld1dyaXRlci5zZXRTZWxlY3Rpb24odmlld1NlbGVjdGlvbi5nZXRSYW5nZXMoKSwgewogICAgICAgICAgICAgICAgICAgICAgZmFrZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBnZXRMYWJlbChzZWxlY3RlZEVsZW1lbnQpCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yMiA9IHRydWU7CiAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IyID0gZXJyOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yICYmIF9pdGVyYXRvcjIucmV0dXJuICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yMi5yZXR1cm4oKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yMikgewogICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7CiAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IGVycjsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvci5yZXR1cm4gIT0gbnVsbCkgewogICAgICAgICAgICAgIF9pdGVyYXRvci5yZXR1cm4oKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yKSB7CiAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBwcmlvcml0eTogJ2xvdycKICAgICAgfSk7IC8vIElmIG1vdXNlIGRvd24gaXMgcHJlc3NlZCBvbiB3aWRnZXQgLSBjcmVhdGUgc2VsZWN0aW9uIG92ZXIgd2hvbGUgd2lkZ2V0LgoKICAgICAgdmlldy5hZGRPYnNlcnZlcihNb3VzZU9ic2VydmVyKTsKICAgICAgdGhpcy5saXN0ZW5Ubyh2aWV3RG9jdW1lbnQsICdtb3VzZWRvd24nLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLl9vbk1vdXNlZG93bi5hcHBseShfdGhpcywgYXJndW1lbnRzKTsKICAgICAgfSk7IC8vIEhhbmRsZSBjdXN0b20ga2V5ZG93biBiZWhhdmlvdXIuCgogICAgICB0aGlzLmxpc3RlblRvKHZpZXdEb2N1bWVudCwgJ2tleWRvd24nLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLl9vbktleWRvd24uYXBwbHkoX3RoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0sIHsKICAgICAgICBwcmlvcml0eTogJ2hpZ2gnCiAgICAgIH0pOyAvLyBIYW5kbGUgY3VzdG9tIGRlbGV0ZSBiZWhhdmlvdXIuCgogICAgICB0aGlzLmxpc3RlblRvKHZpZXdEb2N1bWVudCwgJ2RlbGV0ZScsIGZ1bmN0aW9uIChldnQsIGRhdGEpIHsKICAgICAgICBpZiAoX3RoaXMuX2hhbmRsZURlbGV0ZShkYXRhLmRpcmVjdGlvbiA9PSAnZm9yd2FyZCcpKSB7CiAgICAgICAgICBkYXRhLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICBldnQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIHByaW9yaXR5OiAnaGlnaCcKICAgICAgfSk7CiAgICB9CiAgICAvKioKICAgICAqIEhhbmRsZXMge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9kb2N1bWVudH5Eb2N1bWVudCNldmVudDptb3VzZWRvd24gbW91c2Vkb3dufSBldmVudHMgb24gd2lkZ2V0IGVsZW1lbnRzLgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKiBAcGFyYW0ge21vZHVsZTp1dGlscy9ldmVudGluZm9+RXZlbnRJbmZvfSBldmVudEluZm8KICAgICAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L29ic2VydmVyL2RvbWV2ZW50ZGF0YX5Eb21FdmVudERhdGF9IGRvbUV2ZW50RGF0YQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9vbk1vdXNlZG93biIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uTW91c2Vkb3duKGV2ZW50SW5mbywgZG9tRXZlbnREYXRhKSB7CiAgICAgIHZhciBlZGl0b3IgPSB0aGlzLmVkaXRvcjsKICAgICAgdmFyIHZpZXcgPSBlZGl0b3IuZWRpdGluZy52aWV3OwogICAgICB2YXIgdmlld0RvY3VtZW50ID0gdmlldy5kb2N1bWVudDsKICAgICAgdmFyIGVsZW1lbnQgPSBkb21FdmVudERhdGEudGFyZ2V0OyAvLyBEbyBub3RoaW5nIGZvciBzaW5nbGUgb3IgZG91YmxlIGNsaWNrIGluc2lkZSBuZXN0ZWQgZWRpdGFibGUuCgogICAgICBpZiAoaXNJbnNpZGVOZXN0ZWRFZGl0YWJsZShlbGVtZW50KSkgewogICAgICAgIC8vIEJ1dCBhdCBsZWFzdCB0cmlwbGUgY2xpY2sgaW5zaWRlIG5lc3RlZCBlZGl0YWJsZSBjYXVzZXMgYnJva2VuIHNlbGVjdGlvbiBpbiBTYWZhcmkuCiAgICAgICAgLy8gRm9yIHN1Y2ggZXZlbnQsIHdlIHNlbGVjdCB0aGUgZW50aXJlIG5lc3RlZCBlZGl0YWJsZSBlbGVtZW50LgogICAgICAgIC8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2NrZWRpdG9yL2NrZWRpdG9yNS9pc3N1ZXMvMTQ2My4KICAgICAgICBpZiAoZW52LmlzU2FmYXJpICYmIGRvbUV2ZW50RGF0YS5kb21FdmVudC5kZXRhaWwgPj0gMykgewogICAgICAgICAgdmFyIG1hcHBlciA9IGVkaXRvci5lZGl0aW5nLm1hcHBlcjsKCiAgICAgICAgICB2YXIgX21vZGVsRWxlbWVudCA9IG1hcHBlci50b01vZGVsRWxlbWVudChlbGVtZW50KTsKCiAgICAgICAgICB0aGlzLmVkaXRvci5tb2RlbC5jaGFuZ2UoZnVuY3Rpb24gKHdyaXRlcikgewogICAgICAgICAgICBkb21FdmVudERhdGEucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgd3JpdGVyLnNldFNlbGVjdGlvbihfbW9kZWxFbGVtZW50LCAnaW4nKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIElmIHRhcmdldCBpcyBub3QgYSB3aWRnZXQgZWxlbWVudCAtIGNoZWNrIGlmIG9uZSBvZiB0aGUgYW5jZXN0b3JzIGlzLgoKCiAgICAgIGlmICghaXNXaWRnZXQoZWxlbWVudCkpIHsKICAgICAgICBlbGVtZW50ID0gZWxlbWVudC5maW5kQW5jZXN0b3IoaXNXaWRnZXQpOwoKICAgICAgICBpZiAoIWVsZW1lbnQpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGRvbUV2ZW50RGF0YS5wcmV2ZW50RGVmYXVsdCgpOyAvLyBGb2N1cyBlZGl0b3IgaWYgaXMgbm90IGZvY3VzZWQgYWxyZWFkeS4KCiAgICAgIGlmICghdmlld0RvY3VtZW50LmlzRm9jdXNlZCkgewogICAgICAgIHZpZXcuZm9jdXMoKTsKICAgICAgfSAvLyBDcmVhdGUgbW9kZWwgc2VsZWN0aW9uIG92ZXIgd2lkZ2V0LgoKCiAgICAgIHZhciBtb2RlbEVsZW1lbnQgPSBlZGl0b3IuZWRpdGluZy5tYXBwZXIudG9Nb2RlbEVsZW1lbnQoZWxlbWVudCk7CgogICAgICB0aGlzLl9zZXRTZWxlY3Rpb25PdmVyRWxlbWVudChtb2RlbEVsZW1lbnQpOwogICAgfQogICAgLyoqCiAgICAgKiBIYW5kbGVzIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZG9jdW1lbnR+RG9jdW1lbnQjZXZlbnQ6a2V5ZG93biBrZXlkb3dufSBldmVudHMuCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqIEBwYXJhbSB7bW9kdWxlOnV0aWxzL2V2ZW50aW5mb35FdmVudEluZm99IGV2ZW50SW5mbwogICAgICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvb2JzZXJ2ZXIvZG9tZXZlbnRkYXRhfkRvbUV2ZW50RGF0YX0gZG9tRXZlbnREYXRhCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX29uS2V5ZG93biIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uS2V5ZG93bihldmVudEluZm8sIGRvbUV2ZW50RGF0YSkgewogICAgICB2YXIga2V5Q29kZSA9IGRvbUV2ZW50RGF0YS5rZXlDb2RlOwogICAgICB2YXIgaXNMdHJDb250ZW50ID0gdGhpcy5lZGl0b3IubG9jYWxlLmNvbnRlbnRMYW5ndWFnZURpcmVjdGlvbiA9PT0gJ2x0cic7CiAgICAgIHZhciBpc0ZvcndhcmQgPSBrZXlDb2RlID09IGtleUNvZGVzLmFycm93ZG93biB8fCBrZXlDb2RlID09IGtleUNvZGVzW2lzTHRyQ29udGVudCA/ICdhcnJvd3JpZ2h0JyA6ICdhcnJvd2xlZnQnXTsKICAgICAgdmFyIHdhc0hhbmRsZWQgPSBmYWxzZTsgLy8gQ2hlY2tzIGlmIHRoZSBrZXlzIHdlcmUgaGFuZGxlZCBhbmQgdGhlbiBwcmV2ZW50cyB0aGUgZGVmYXVsdCBldmVudCBiZWhhdmlvdXIgYW5kIHN0b3BzCiAgICAgIC8vIHRoZSBwcm9wYWdhdGlvbi4KCiAgICAgIGlmIChpc0Fycm93S2V5Q29kZShrZXlDb2RlKSkgewogICAgICAgIHdhc0hhbmRsZWQgPSB0aGlzLl9oYW5kbGVBcnJvd0tleXMoaXNGb3J3YXJkKTsKICAgICAgfSBlbHNlIGlmIChpc1NlbGVjdEFsbEtleUNvZGUoZG9tRXZlbnREYXRhKSkgewogICAgICAgIHdhc0hhbmRsZWQgPSB0aGlzLl9zZWxlY3RBbGxOZXN0ZWRFZGl0YWJsZUNvbnRlbnQoKSB8fCB0aGlzLl9zZWxlY3RBbGxDb250ZW50KCk7CiAgICAgIH0gZWxzZSBpZiAoa2V5Q29kZSA9PT0ga2V5Q29kZXMuZW50ZXIpIHsKICAgICAgICB3YXNIYW5kbGVkID0gdGhpcy5faGFuZGxlRW50ZXJLZXkoZG9tRXZlbnREYXRhLnNoaWZ0S2V5KTsKICAgICAgfQoKICAgICAgaWYgKHdhc0hhbmRsZWQpIHsKICAgICAgICBkb21FdmVudERhdGEucHJldmVudERlZmF1bHQoKTsKICAgICAgICBldmVudEluZm8uc3RvcCgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEhhbmRsZXMgZGVsZXRlIGtleXM6IGJhY2tzcGFjZSBhbmQgZGVsZXRlLgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlzRm9yd2FyZCBTZXQgdG8gdHJ1ZSBpZiBkZWxldGUgd2FzIHBlcmZvcm1lZCBpbiBmb3J3YXJkIGRpcmVjdGlvbi4KICAgICAqIEByZXR1cm5zIHtCb29sZWFufHVuZGVmaW5lZH0gUmV0dXJucyBgdHJ1ZWAgaWYga2V5cyB3ZXJlIGhhbmRsZWQgY29ycmVjdGx5LgogICAgICovCgogIH0sIHsKICAgIGtleTogIl9oYW5kbGVEZWxldGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9oYW5kbGVEZWxldGUoaXNGb3J3YXJkKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgLy8gRG8gbm90aGluZyB3aGVuIHRoZSByZWFkIG9ubHkgbW9kZSBpcyBlbmFibGVkLgogICAgICBpZiAodGhpcy5lZGl0b3IuaXNSZWFkT25seSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIG1vZGVsRG9jdW1lbnQgPSB0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudDsKICAgICAgdmFyIG1vZGVsU2VsZWN0aW9uID0gbW9kZWxEb2N1bWVudC5zZWxlY3Rpb247IC8vIERvIG5vdGhpbmcgb24gbm9uLWNvbGxhcHNlZCBzZWxlY3Rpb24uCgogICAgICBpZiAoIW1vZGVsU2VsZWN0aW9uLmlzQ29sbGFwc2VkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgb2JqZWN0RWxlbWVudCA9IHRoaXMuX2dldE9iamVjdEVsZW1lbnROZXh0VG9TZWxlY3Rpb24oaXNGb3J3YXJkKTsKCiAgICAgIGlmIChvYmplY3RFbGVtZW50KSB7CiAgICAgICAgdGhpcy5lZGl0b3IubW9kZWwuY2hhbmdlKGZ1bmN0aW9uICh3cml0ZXIpIHsKICAgICAgICAgIHZhciBwcmV2aW91c05vZGUgPSBtb2RlbFNlbGVjdGlvbi5hbmNob3IucGFyZW50OyAvLyBSZW1vdmUgcHJldmlvdXMgZWxlbWVudCBpZiBlbXB0eS4KCiAgICAgICAgICB3aGlsZSAocHJldmlvdXNOb2RlLmlzRW1wdHkpIHsKICAgICAgICAgICAgdmFyIG5vZGVUb1JlbW92ZSA9IHByZXZpb3VzTm9kZTsKICAgICAgICAgICAgcHJldmlvdXNOb2RlID0gbm9kZVRvUmVtb3ZlLnBhcmVudDsKICAgICAgICAgICAgd3JpdGVyLnJlbW92ZShub2RlVG9SZW1vdmUpOwogICAgICAgICAgfQoKICAgICAgICAgIF90aGlzMi5fc2V0U2VsZWN0aW9uT3ZlckVsZW1lbnQob2JqZWN0RWxlbWVudCk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogSGFuZGxlcyBhcnJvdyBrZXlzLgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlzRm9yd2FyZCBTZXQgdG8gdHJ1ZSBpZiBhcnJvdyBrZXkgc2hvdWxkIGJlIGhhbmRsZWQgaW4gZm9yd2FyZCBkaXJlY3Rpb24uCiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbnx1bmRlZmluZWR9IFJldHVybnMgYHRydWVgIGlmIGtleXMgd2VyZSBoYW5kbGVkIGNvcnJlY3RseS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfaGFuZGxlQXJyb3dLZXlzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfaGFuZGxlQXJyb3dLZXlzKGlzRm9yd2FyZCkgewogICAgICB2YXIgbW9kZWwgPSB0aGlzLmVkaXRvci5tb2RlbDsKICAgICAgdmFyIHNjaGVtYSA9IG1vZGVsLnNjaGVtYTsKICAgICAgdmFyIG1vZGVsRG9jdW1lbnQgPSBtb2RlbC5kb2N1bWVudDsKICAgICAgdmFyIG1vZGVsU2VsZWN0aW9uID0gbW9kZWxEb2N1bWVudC5zZWxlY3Rpb247CiAgICAgIHZhciBvYmplY3RFbGVtZW50ID0gbW9kZWxTZWxlY3Rpb24uZ2V0U2VsZWN0ZWRFbGVtZW50KCk7IC8vIElmIG9iamVjdCBlbGVtZW50IGlzIHNlbGVjdGVkLgoKICAgICAgaWYgKG9iamVjdEVsZW1lbnQgJiYgc2NoZW1hLmlzT2JqZWN0KG9iamVjdEVsZW1lbnQpKSB7CiAgICAgICAgdmFyIHBvc2l0aW9uID0gaXNGb3J3YXJkID8gbW9kZWxTZWxlY3Rpb24uZ2V0TGFzdFBvc2l0aW9uKCkgOiBtb2RlbFNlbGVjdGlvbi5nZXRGaXJzdFBvc2l0aW9uKCk7CiAgICAgICAgdmFyIG5ld1JhbmdlID0gc2NoZW1hLmdldE5lYXJlc3RTZWxlY3Rpb25SYW5nZShwb3NpdGlvbiwgaXNGb3J3YXJkID8gJ2ZvcndhcmQnIDogJ2JhY2t3YXJkJyk7CgogICAgICAgIGlmIChuZXdSYW5nZSkgewogICAgICAgICAgbW9kZWwuY2hhbmdlKGZ1bmN0aW9uICh3cml0ZXIpIHsKICAgICAgICAgICAgd3JpdGVyLnNldFNlbGVjdGlvbihuZXdSYW5nZSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IC8vIElmIHNlbGVjdGlvbiBpcyBuZXh0IHRvIG9iamVjdCBlbGVtZW50LgogICAgICAvLyBSZXR1cm4gaWYgbm90IGNvbGxhcHNlZC4KCgogICAgICBpZiAoIW1vZGVsU2VsZWN0aW9uLmlzQ29sbGFwc2VkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgb2JqZWN0RWxlbWVudDIgPSB0aGlzLl9nZXRPYmplY3RFbGVtZW50TmV4dFRvU2VsZWN0aW9uKGlzRm9yd2FyZCk7CgogICAgICBpZiAoISFvYmplY3RFbGVtZW50MiAmJiBzY2hlbWEuaXNPYmplY3Qob2JqZWN0RWxlbWVudDIpKSB7CiAgICAgICAgdGhpcy5fc2V0U2VsZWN0aW9uT3ZlckVsZW1lbnQob2JqZWN0RWxlbWVudDIpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBIYW5kbGVzIHRoZSBlbnRlciBrZXksIGdpdmluZyB1c2VycyBhbmQgYWNjZXNzIHRvIHBvc2l0aW9ucyBpbiB0aGUgZWRpdGFibGUgZGlyZWN0bHkgYmVmb3JlCiAgICAgKiAoPGtiZD5TaGlmdDwva2JkPis8a2JkPkVudGVyPC9rYmQ+KSBvciBhZnRlciAoPGtiZD5FbnRlcjwva2JkPikgdGhlIHNlbGVjdGVkIHdpZGdldC4KICAgICAqIEl0IGltcHJvdmVzIHRoZSBVWCwgbWFpbmx5IHdoZW4gdGhlIHdpZGdldCBpcyB0aGUgZmlyc3Qgb3IgbGFzdCBjaGlsZCBvZiB0aGUgcm9vdCBlZGl0YWJsZQogICAgICogYW5kIHRoZXJlJ3Mgbm8gb3RoZXIgd2F5IHRvIHR5cGUgYWZ0ZXIgb3IgYmVmb3JlIGl0LgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlzQmFja3dhcmRzIFNldCB0byB0cnVlIGlmIHRoZSBuZXcgcGFyYWdyYXBoIGlzIHRvIGJlIGluc2VydGVkIGJlZm9yZQogICAgICogdGhlIHNlbGVjdGVkIHdpZGdldCAoPGtiZD5TaGlmdDwva2JkPis8a2JkPkVudGVyPC9rYmQ+KS4KICAgICAqIEByZXR1cm5zIHtCb29sZWFufHVuZGVmaW5lZH0gUmV0dXJucyBgdHJ1ZWAgaWYga2V5cyB3ZXJlIGhhbmRsZWQgY29ycmVjdGx5LgogICAgICovCgogIH0sIHsKICAgIGtleTogIl9oYW5kbGVFbnRlcktleSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2hhbmRsZUVudGVyS2V5KGlzQmFja3dhcmRzKSB7CiAgICAgIHZhciBtb2RlbCA9IHRoaXMuZWRpdG9yLm1vZGVsOwogICAgICB2YXIgbW9kZWxTZWxlY3Rpb24gPSBtb2RlbC5kb2N1bWVudC5zZWxlY3Rpb247CiAgICAgIHZhciBzZWxlY3RlZEVsZW1lbnQgPSBtb2RlbFNlbGVjdGlvbi5nZXRTZWxlY3RlZEVsZW1lbnQoKTsKCiAgICAgIGlmIChzaG91bGRJbnNlcnRQYXJhZ3JhcGgoc2VsZWN0ZWRFbGVtZW50LCBtb2RlbC5zY2hlbWEpKSB7CiAgICAgICAgbW9kZWwuY2hhbmdlKGZ1bmN0aW9uICh3cml0ZXIpIHsKICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHdyaXRlci5jcmVhdGVQb3NpdGlvbkF0KHNlbGVjdGVkRWxlbWVudCwgaXNCYWNrd2FyZHMgPyAnYmVmb3JlJyA6ICdhZnRlcicpOwogICAgICAgICAgdmFyIHBhcmFncmFwaCA9IHdyaXRlci5jcmVhdGVFbGVtZW50KCdwYXJhZ3JhcGgnKTsgLy8gU3BsaXQgdGhlIHBhcmVudCB3aGVuIGluc2lkZSBhIGJsb2NrIGVsZW1lbnQuCiAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vY2tlZGl0b3IvY2tlZGl0b3I1L2lzc3Vlcy8xNTI5CgogICAgICAgICAgaWYgKG1vZGVsLnNjaGVtYS5pc0Jsb2NrKHNlbGVjdGVkRWxlbWVudC5wYXJlbnQpKSB7CiAgICAgICAgICAgIHZhciBwYXJhZ3JhcGhMaW1pdCA9IG1vZGVsLnNjaGVtYS5maW5kQWxsb3dlZFBhcmVudChwb3NpdGlvbiwgcGFyYWdyYXBoKTsKICAgICAgICAgICAgcG9zaXRpb24gPSB3cml0ZXIuc3BsaXQocG9zaXRpb24sIHBhcmFncmFwaExpbWl0KS5wb3NpdGlvbjsKICAgICAgICAgIH0KCiAgICAgICAgICB3cml0ZXIuaW5zZXJ0KHBhcmFncmFwaCwgcG9zaXRpb24pOwogICAgICAgICAgd3JpdGVyLnNldFNlbGVjdGlvbihwYXJhZ3JhcGgsICdpbicpOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEV4dGVuZHMgdGhlIHtAbGluayBtb2R1bGU6ZW5naW5lL21vZGVsL3NlbGVjdGlvbn5TZWxlY3Rpb24gZG9jdW1lbnQncyBzZWxlY3Rpb259IHRvIHNwYW4gdGhlIGVudGlyZQogICAgICogY29udGVudCBvZiB0aGUgbmVzdGVkIGVkaXRhYmxlIGlmIGFscmVhZHkgYW5jaG9yZWQgaW4gb25lLgogICAgICoKICAgICAqIFNlZToge0BsaW5rIG1vZHVsZTplbmdpbmUvbW9kZWwvc2NoZW1hflNjaGVtYSNnZXRMaW1pdEVsZW1lbnR9LgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3NlbGVjdEFsbE5lc3RlZEVkaXRhYmxlQ29udGVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbGVjdEFsbE5lc3RlZEVkaXRhYmxlQ29udGVudCgpIHsKICAgICAgdmFyIG1vZGVsID0gdGhpcy5lZGl0b3IubW9kZWw7CiAgICAgIHZhciBkb2N1bWVudFNlbGVjdGlvbiA9IG1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbjsKICAgICAgdmFyIGxpbWl0RWxlbWVudCA9IG1vZGVsLnNjaGVtYS5nZXRMaW1pdEVsZW1lbnQoZG9jdW1lbnRTZWxlY3Rpb24pOwoKICAgICAgaWYgKGRvY3VtZW50U2VsZWN0aW9uLmdldEZpcnN0UmFuZ2UoKS5yb290ID09IGxpbWl0RWxlbWVudCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgbW9kZWwuY2hhbmdlKGZ1bmN0aW9uICh3cml0ZXIpIHsKICAgICAgICB3cml0ZXIuc2V0U2VsZWN0aW9uKHdyaXRlci5jcmVhdGVSYW5nZUluKGxpbWl0RWxlbWVudCkpOwogICAgICB9KTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIEhhbmRsZXMgPGtiZD5DVFJMICsgQTwva2JkPiB3aGVuIHdpZGdldCBpcyBzZWxlY3RlZC4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiB3aWRnZXQgd2FzIHNlbGVjdGVkIGFuZCBzZWxlY3RpbmcgYWxsIHdhcyBoYW5kbGVkIGJ5IHRoaXMgbWV0aG9kLgogICAgICovCgogIH0sIHsKICAgIGtleTogIl9zZWxlY3RBbGxDb250ZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VsZWN0QWxsQ29udGVudCgpIHsKICAgICAgdmFyIG1vZGVsID0gdGhpcy5lZGl0b3IubW9kZWw7CiAgICAgIHZhciBlZGl0aW5nID0gdGhpcy5lZGl0b3IuZWRpdGluZzsKICAgICAgdmFyIHZpZXcgPSBlZGl0aW5nLnZpZXc7CiAgICAgIHZhciB2aWV3RG9jdW1lbnQgPSB2aWV3LmRvY3VtZW50OwogICAgICB2YXIgdmlld1NlbGVjdGlvbiA9IHZpZXdEb2N1bWVudC5zZWxlY3Rpb247CiAgICAgIHZhciBzZWxlY3RlZEVsZW1lbnQgPSB2aWV3U2VsZWN0aW9uLmdldFNlbGVjdGVkRWxlbWVudCgpOyAvLyBPbmx5IHdpZGdldCBpcyBzZWxlY3RlZC4KICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2NrZWRpdG9yL2NrZWRpdG9yNS13aWRnZXQvaXNzdWVzLzIzCgogICAgICBpZiAoc2VsZWN0ZWRFbGVtZW50ICYmIGlzV2lkZ2V0KHNlbGVjdGVkRWxlbWVudCkpIHsKICAgICAgICB2YXIgd2lkZ2V0UGFyZW50ID0gZWRpdGluZy5tYXBwZXIudG9Nb2RlbEVsZW1lbnQoc2VsZWN0ZWRFbGVtZW50LnBhcmVudCk7CiAgICAgICAgbW9kZWwuY2hhbmdlKGZ1bmN0aW9uICh3cml0ZXIpIHsKICAgICAgICAgIHdyaXRlci5zZXRTZWxlY3Rpb24od3JpdGVyLmNyZWF0ZVJhbmdlSW4od2lkZ2V0UGFyZW50KSk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0cyB7QGxpbmsgbW9kdWxlOmVuZ2luZS9tb2RlbC9zZWxlY3Rpb25+U2VsZWN0aW9uIGRvY3VtZW50J3Mgc2VsZWN0aW9ufSBvdmVyIGdpdmVuIGVsZW1lbnQuCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS9tb2RlbC9lbGVtZW50fkVsZW1lbnR9IGVsZW1lbnQKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfc2V0U2VsZWN0aW9uT3ZlckVsZW1lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXRTZWxlY3Rpb25PdmVyRWxlbWVudChlbGVtZW50KSB7CiAgICAgIHRoaXMuZWRpdG9yLm1vZGVsLmNoYW5nZShmdW5jdGlvbiAod3JpdGVyKSB7CiAgICAgICAgd3JpdGVyLnNldFNlbGVjdGlvbih3cml0ZXIuY3JlYXRlUmFuZ2VPbihlbGVtZW50KSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVja3MgaWYge0BsaW5rIG1vZHVsZTplbmdpbmUvbW9kZWwvZWxlbWVudH5FbGVtZW50IGVsZW1lbnR9IHBsYWNlZCBuZXh0IHRvIHRoZSBjdXJyZW50CiAgICAgKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS9tb2RlbC9zZWxlY3Rpb25+U2VsZWN0aW9uIG1vZGVsIHNlbGVjdGlvbn0gZXhpc3RzIGFuZCBpcyBtYXJrZWQgaW4KICAgICAqIHtAbGluayBtb2R1bGU6ZW5naW5lL21vZGVsL3NjaGVtYX5TY2hlbWEgc2NoZW1hfSBhcyBgb2JqZWN0YC4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICogQHBhcmFtIHtCb29sZWFufSBmb3J3YXJkIERpcmVjdGlvbiBvZiBjaGVja2luZy4KICAgICAqIEByZXR1cm5zIHttb2R1bGU6ZW5naW5lL21vZGVsL2VsZW1lbnR+RWxlbWVudHxudWxsfQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9nZXRPYmplY3RFbGVtZW50TmV4dFRvU2VsZWN0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0T2JqZWN0RWxlbWVudE5leHRUb1NlbGVjdGlvbihmb3J3YXJkKSB7CiAgICAgIHZhciBtb2RlbCA9IHRoaXMuZWRpdG9yLm1vZGVsOwogICAgICB2YXIgc2NoZW1hID0gbW9kZWwuc2NoZW1hOwogICAgICB2YXIgbW9kZWxTZWxlY3Rpb24gPSBtb2RlbC5kb2N1bWVudC5zZWxlY3Rpb247IC8vIENsb25lIGN1cnJlbnQgc2VsZWN0aW9uIHRvIHVzZSBpdCBhcyBhIHByb2JlLiBXZSBtdXN0IGxlYXZlIGRlZmF1bHQgc2VsZWN0aW9uIGFzIGl0IGlzIHNvIGl0IGNhbiByZXR1cm4KICAgICAgLy8gdG8gaXRzIGN1cnJlbnQgc3RhdGUgYWZ0ZXIgdW5kby4KCiAgICAgIHZhciBwcm9iZSA9IG1vZGVsLmNyZWF0ZVNlbGVjdGlvbihtb2RlbFNlbGVjdGlvbik7CiAgICAgIG1vZGVsLm1vZGlmeVNlbGVjdGlvbihwcm9iZSwgewogICAgICAgIGRpcmVjdGlvbjogZm9yd2FyZCA/ICdmb3J3YXJkJyA6ICdiYWNrd2FyZCcKICAgICAgfSk7CiAgICAgIHZhciBvYmplY3RFbGVtZW50ID0gZm9yd2FyZCA/IHByb2JlLmZvY3VzLm5vZGVCZWZvcmUgOiBwcm9iZS5mb2N1cy5ub2RlQWZ0ZXI7CgogICAgICBpZiAoISFvYmplY3RFbGVtZW50ICYmIHNjaGVtYS5pc09iamVjdChvYmplY3RFbGVtZW50KSkgewogICAgICAgIHJldHVybiBvYmplY3RFbGVtZW50OwogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlcyBDU1MgY2xhc3MgZnJvbSBwcmV2aW91c2x5IHNlbGVjdGVkIHdpZGdldHMuCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyfSB3cml0ZXIKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfY2xlYXJQcmV2aW91c2x5U2VsZWN0ZWRXaWRnZXRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfY2xlYXJQcmV2aW91c2x5U2VsZWN0ZWRXaWRnZXRzKHdyaXRlcikgewogICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMgPSB0cnVlOwogICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IzID0gZmFsc2U7CiAgICAgIHZhciBfaXRlcmF0b3JFcnJvcjMgPSB1bmRlZmluZWQ7CgogICAgICB0cnkgewogICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjMgPSB0aGlzLl9wcmV2aW91c2x5U2VsZWN0ZWRbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDM7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMgPSAoX3N0ZXAzID0gX2l0ZXJhdG9yMy5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IHRydWUpIHsKICAgICAgICAgIHZhciB3aWRnZXQgPSBfc3RlcDMudmFsdWU7CiAgICAgICAgICB3cml0ZXIucmVtb3ZlQ2xhc3MoV0lER0VUX1NFTEVDVEVEX0NMQVNTX05BTUUsIHdpZGdldCk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjMgPSB0cnVlOwogICAgICAgIF9pdGVyYXRvckVycm9yMyA9IGVycjsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyAmJiBfaXRlcmF0b3IzLnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjMucmV0dXJuKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjMpIHsKICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3IzOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5fcHJldmlvdXNseVNlbGVjdGVkLmNsZWFyKCk7CiAgICB9CiAgfV0sIFt7CiAgICBrZXk6ICJwbHVnaW5OYW1lIiwKCiAgICAvKioKICAgICAqIEBpbmhlcml0RG9jCiAgICAgKi8KICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gJ1dpZGdldCc7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gV2lkZ2V0Owp9KFBsdWdpbik7IC8vIFJldHVybnMgJ3RydWUnIGlmIHByb3ZpZGVkIGtleSBjb2RlIHJlcHJlc2VudHMgb25lIG9mIHRoZSBhcnJvdyBrZXlzLgovLwovLyBAcGFyYW0ge051bWJlcn0ga2V5Q29kZQovLyBAcmV0dXJucyB7Qm9vbGVhbn0KCgpleHBvcnQgeyBXaWRnZXQgYXMgZGVmYXVsdCB9OwoKZnVuY3Rpb24gaXNBcnJvd0tleUNvZGUoa2V5Q29kZSkgewogIHJldHVybiBrZXlDb2RlID09IGtleUNvZGVzLmFycm93cmlnaHQgfHwga2V5Q29kZSA9PSBrZXlDb2Rlcy5hcnJvd2xlZnQgfHwga2V5Q29kZSA9PSBrZXlDb2Rlcy5hcnJvd3VwIHx8IGtleUNvZGUgPT0ga2V5Q29kZXMuYXJyb3dkb3duOwp9IC8vIFJldHVybnMgJ3RydWUnIGlmIHByb3ZpZGVkIChET00pIGtleSBldmVudCBkYXRhIGNvcnJlc3BvbmRzIHdpdGggdGhlIEN0cmwrQSBrZXlzdHJva2UuCi8vCi8vIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L29ic2VydmVyL2tleW9ic2VydmVyfktleUV2ZW50RGF0YX0gZG9tRXZlbnREYXRhCi8vIEByZXR1cm5zIHtCb29sZWFufQoKCmZ1bmN0aW9uIGlzU2VsZWN0QWxsS2V5Q29kZShkb21FdmVudERhdGEpIHsKICByZXR1cm4gZ2V0Q29kZShkb21FdmVudERhdGEpID09IHNlbGVjdEFsbEtleXN0cm9rZUNvZGU7Cn0gLy8gUmV0dXJucyBgdHJ1ZWAgd2hlbiBlbGVtZW50IGlzIGEgbmVzdGVkIGVkaXRhYmxlIG9yIGlzIHBsYWNlZCBpbnNpZGUgb25lLgovLwovLyBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9Ci8vIEByZXR1cm5zIHtCb29sZWFufQoKCmZ1bmN0aW9uIGlzSW5zaWRlTmVzdGVkRWRpdGFibGUoZWxlbWVudCkgewogIHdoaWxlIChlbGVtZW50KSB7CiAgICBpZiAoZWxlbWVudC5pcygnZWRpdGFibGVFbGVtZW50JykgJiYgIWVsZW1lbnQuaXMoJ3Jvb3RFbGVtZW50JykpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IC8vIENsaWNrIG9uIG5lc3RlZCB3aWRnZXQgc2hvdWxkIHNlbGVjdCBpdC4KCgogICAgaWYgKGlzV2lkZ2V0KGVsZW1lbnQpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBlbGVtZW50ID0gZWxlbWVudC5wYXJlbnQ7CiAgfQoKICByZXR1cm4gZmFsc2U7Cn0gLy8gQ2hlY2tzIHdoZXRoZXIgdGhlIHNwZWNpZmllZCBgZWxlbWVudGAgaXMgYSBjaGlsZCBvZiB0aGUgYHBhcmVudGAgZWxlbWVudC4KLy8KLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50fSBlbGVtZW50IEFuIGVsZW1lbnQgdG8gY2hlY2suCi8vIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L2VsZW1lbnR+RWxlbWVudHxudWxsfSBwYXJlbnQgQSBwYXJlbnQgZm9yIHRoZSBlbGVtZW50LgovLyBAcmV0dXJucyB7Qm9vbGVhbn0KCgpmdW5jdGlvbiBpc0NoaWxkKGVsZW1lbnQsIHBhcmVudCkgewogIGlmICghcGFyZW50KSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICByZXR1cm4gQXJyYXkuZnJvbShlbGVtZW50LmdldEFuY2VzdG9ycygpKS5pbmNsdWRlcyhwYXJlbnQpOwp9IC8vIENoZWNrcyBpZiBlbnRlciBrZXkgc2hvdWxkIGluc2VydCBwYXJhZ3JhcGguIFRoaXMgc2hvdWxkIGJlIGRvbmUgb25seSBvbiBlbGVtZW50cyBvZiB0eXBlIG9iamVjdCAoZXhjbHVkaW5nIGlubGluZSBvYmplY3RzKS4KLy8KLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL21vZGVsL2VsZW1lbnR+RWxlbWVudH0gZWxlbWVudCBBbmQgZWxlbWVudCB0byBjaGVjay4KLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL21vZGVsL3NjaGVtYX5TY2hlbWF9IHNjaGVtYQoKCmZ1bmN0aW9uIHNob3VsZEluc2VydFBhcmFncmFwaChlbGVtZW50LCBzY2hlbWEpIHsKICByZXR1cm4gZWxlbWVudCAmJiBzY2hlbWEuaXNPYmplY3QoZWxlbWVudCkgJiYgIXNjaGVtYS5pc0lubGluZShlbGVtZW50KTsKfQ=="},{"version":3,"sources":["C:/Users/pc/Desktop/Restoran/Restoran/Restoran.UI/client/node_modules/@ckeditor/ckeditor5-widget/src/widget.js"],"names":["Plugin","MouseObserver","getLabel","isWidget","WIDGET_SELECTED_CLASS_NAME","getCode","keyCodes","parseKeystroke","env","selectAllKeystrokeCode","Widget","view","editor","editing","viewDocument","document","_previouslySelected","Set","downcastDispatcher","on","evt","data","conversionApi","_clearPreviouslySelectedWidgets","writer","viewWriter","viewSelection","selection","selectedElement","getSelectedElement","lastMarked","getRanges","range","value","node","item","isChild","addClass","add","setSelection","fake","label","priority","addObserver","listenTo","_onMousedown","_onKeydown","_handleDelete","direction","preventDefault","stop","eventInfo","domEventData","element","target","isInsideNestedEditable","isSafari","domEvent","detail","mapper","modelElement","toModelElement","model","change","findAncestor","isFocused","focus","_setSelectionOverElement","keyCode","isLtrContent","locale","contentLanguageDirection","isForward","arrowdown","wasHandled","isArrowKeyCode","_handleArrowKeys","isSelectAllKeyCode","_selectAllNestedEditableContent","_selectAllContent","enter","_handleEnterKey","shiftKey","isReadOnly","modelDocument","modelSelection","isCollapsed","objectElement","_getObjectElementNextToSelection","previousNode","anchor","parent","isEmpty","nodeToRemove","remove","schema","isObject","position","getLastPosition","getFirstPosition","newRange","getNearestSelectionRange","objectElement2","isBackwards","shouldInsertParagraph","createPositionAt","paragraph","createElement","isBlock","paragraphLimit","findAllowedParent","split","insert","documentSelection","limitElement","getLimitElement","getFirstRange","root","createRangeIn","widgetParent","createRangeOn","forward","probe","createSelection","modifySelection","nodeBefore","nodeAfter","widget","removeClass","clear","arrowright","arrowleft","arrowup","is","Array","from","getAncestors","includes","isInline"],"mappings":"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","sourcesContent":["/**\n * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module widget/widget\n */\n\nimport Plugin from '@ckeditor/ckeditor5-core/src/plugin';\nimport MouseObserver from '@ckeditor/ckeditor5-engine/src/view/observer/mouseobserver';\nimport { getLabel, isWidget, WIDGET_SELECTED_CLASS_NAME } from './utils';\nimport { getCode, keyCodes, parseKeystroke } from '@ckeditor/ckeditor5-utils/src/keyboard';\nimport env from '@ckeditor/ckeditor5-utils/src/env';\n\nimport '../theme/widget.css';\n\nconst selectAllKeystrokeCode = parseKeystroke( 'Ctrl+A' );\n\n/**\n * The widget plugin. It enables base support for widgets.\n *\n * See {@glink api/widget package page} for more details and documentation.\n *\n * This plugin enables multiple behaviors required by widgets:\n *\n * * The model to view selection converter for the editing pipeline (it handles widget custom selection rendering).\n * If a converted selection wraps around a widget element, that selection is marked as\n * {@link module:engine/view/selection~Selection#isFake fake}. Additionally, the `ck-widget_selected` CSS class\n * is added to indicate that widget has been selected.\n * * The mouse and keyboard events handling on and around widget elements.\n *\n * @extends module:core/plugin~Plugin\n */\nexport default class Widget extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic get pluginName() {\n\t\treturn 'Widget';\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tinit() {\n\t\tconst view = this.editor.editing.view;\n\t\tconst viewDocument = view.document;\n\n\t\t/**\n\t\t * Holds previously selected widgets.\n\t\t *\n\t\t * @private\n\t\t * @type {Set.<module:engine/view/element~Element>}\n\t\t */\n\t\tthis._previouslySelected = new Set();\n\n\t\t// Model to view selection converter.\n\t\t// Converts selection placed over widget element to fake selection\n\t\tthis.editor.editing.downcastDispatcher.on( 'selection', ( evt, data, conversionApi ) => {\n\t\t\t// Remove selected class from previously selected widgets.\n\t\t\tthis._clearPreviouslySelectedWidgets( conversionApi.writer );\n\n\t\t\tconst viewWriter = conversionApi.writer;\n\t\t\tconst viewSelection = viewWriter.document.selection;\n\t\t\tconst selectedElement = viewSelection.getSelectedElement();\n\t\t\tlet lastMarked = null;\n\n\t\t\tfor ( const range of viewSelection.getRanges() ) {\n\t\t\t\tfor ( const value of range ) {\n\t\t\t\t\tconst node = value.item;\n\n\t\t\t\t\t// Do not mark nested widgets in selected one. See: #57.\n\t\t\t\t\tif ( isWidget( node ) && !isChild( node, lastMarked ) ) {\n\t\t\t\t\t\tviewWriter.addClass( WIDGET_SELECTED_CLASS_NAME, node );\n\n\t\t\t\t\t\tthis._previouslySelected.add( node );\n\t\t\t\t\t\tlastMarked = node;\n\n\t\t\t\t\t\t// Check if widget is a single element selected.\n\t\t\t\t\t\tif ( node == selectedElement ) {\n\t\t\t\t\t\t\tviewWriter.setSelection( viewSelection.getRanges(), { fake: true, label: getLabel( selectedElement ) } );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, { priority: 'low' } );\n\n\t\t// If mouse down is pressed on widget - create selection over whole widget.\n\t\tview.addObserver( MouseObserver );\n\t\tthis.listenTo( viewDocument, 'mousedown', ( ...args ) => this._onMousedown( ...args ) );\n\n\t\t// Handle custom keydown behaviour.\n\t\tthis.listenTo( viewDocument, 'keydown', ( ...args ) => this._onKeydown( ...args ), { priority: 'high' } );\n\n\t\t// Handle custom delete behaviour.\n\t\tthis.listenTo( viewDocument, 'delete', ( evt, data ) => {\n\t\t\tif ( this._handleDelete( data.direction == 'forward' ) ) {\n\t\t\t\tdata.preventDefault();\n\t\t\t\tevt.stop();\n\t\t\t}\n\t\t}, { priority: 'high' } );\n\t}\n\n\t/**\n\t * Handles {@link module:engine/view/document~Document#event:mousedown mousedown} events on widget elements.\n\t *\n\t * @private\n\t * @param {module:utils/eventinfo~EventInfo} eventInfo\n\t * @param {module:engine/view/observer/domeventdata~DomEventData} domEventData\n\t */\n\t_onMousedown( eventInfo, domEventData ) {\n\t\tconst editor = this.editor;\n\t\tconst view = editor.editing.view;\n\t\tconst viewDocument = view.document;\n\t\tlet element = domEventData.target;\n\n\t\t// Do nothing for single or double click inside nested editable.\n\t\tif ( isInsideNestedEditable( element ) ) {\n\t\t\t// But at least triple click inside nested editable causes broken selection in Safari.\n\t\t\t// For such event, we select the entire nested editable element.\n\t\t\t// See: https://github.com/ckeditor/ckeditor5/issues/1463.\n\t\t\tif ( env.isSafari && domEventData.domEvent.detail >= 3 ) {\n\t\t\t\tconst mapper = editor.editing.mapper;\n\t\t\t\tconst modelElement = mapper.toModelElement( element );\n\n\t\t\t\tthis.editor.model.change( writer => {\n\t\t\t\t\tdomEventData.preventDefault();\n\t\t\t\t\twriter.setSelection( modelElement, 'in' );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// If target is not a widget element - check if one of the ancestors is.\n\t\tif ( !isWidget( element ) ) {\n\t\t\telement = element.findAncestor( isWidget );\n\n\t\t\tif ( !element ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tdomEventData.preventDefault();\n\n\t\t// Focus editor if is not focused already.\n\t\tif ( !viewDocument.isFocused ) {\n\t\t\tview.focus();\n\t\t}\n\n\t\t// Create model selection over widget.\n\t\tconst modelElement = editor.editing.mapper.toModelElement( element );\n\n\t\tthis._setSelectionOverElement( modelElement );\n\t}\n\n\t/**\n\t * Handles {@link module:engine/view/document~Document#event:keydown keydown} events.\n\t *\n\t * @private\n\t * @param {module:utils/eventinfo~EventInfo} eventInfo\n\t * @param {module:engine/view/observer/domeventdata~DomEventData} domEventData\n\t */\n\t_onKeydown( eventInfo, domEventData ) {\n\t\tconst keyCode = domEventData.keyCode;\n\t\tconst isLtrContent = this.editor.locale.contentLanguageDirection === 'ltr';\n\t\tconst isForward = keyCode == keyCodes.arrowdown || keyCode == keyCodes[ isLtrContent ? 'arrowright' : 'arrowleft' ];\n\t\tlet wasHandled = false;\n\n\t\t// Checks if the keys were handled and then prevents the default event behaviour and stops\n\t\t// the propagation.\n\t\tif ( isArrowKeyCode( keyCode ) ) {\n\t\t\twasHandled = this._handleArrowKeys( isForward );\n\t\t} else if ( isSelectAllKeyCode( domEventData ) ) {\n\t\t\twasHandled = this._selectAllNestedEditableContent() || this._selectAllContent();\n\t\t} else if ( keyCode === keyCodes.enter ) {\n\t\t\twasHandled = this._handleEnterKey( domEventData.shiftKey );\n\t\t}\n\n\t\tif ( wasHandled ) {\n\t\t\tdomEventData.preventDefault();\n\t\t\teventInfo.stop();\n\t\t}\n\t}\n\n\t/**\n\t * Handles delete keys: backspace and delete.\n\t *\n\t * @private\n\t * @param {Boolean} isForward Set to true if delete was performed in forward direction.\n\t * @returns {Boolean|undefined} Returns `true` if keys were handled correctly.\n\t */\n\t_handleDelete( isForward ) {\n\t\t// Do nothing when the read only mode is enabled.\n\t\tif ( this.editor.isReadOnly ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst modelDocument = this.editor.model.document;\n\t\tconst modelSelection = modelDocument.selection;\n\n\t\t// Do nothing on non-collapsed selection.\n\t\tif ( !modelSelection.isCollapsed ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst objectElement = this._getObjectElementNextToSelection( isForward );\n\n\t\tif ( objectElement ) {\n\t\t\tthis.editor.model.change( writer => {\n\t\t\t\tlet previousNode = modelSelection.anchor.parent;\n\n\t\t\t\t// Remove previous element if empty.\n\t\t\t\twhile ( previousNode.isEmpty ) {\n\t\t\t\t\tconst nodeToRemove = previousNode;\n\t\t\t\t\tpreviousNode = nodeToRemove.parent;\n\n\t\t\t\t\twriter.remove( nodeToRemove );\n\t\t\t\t}\n\n\t\t\t\tthis._setSelectionOverElement( objectElement );\n\t\t\t} );\n\n\t\t\treturn true;\n\t\t}\n\t}\n\n\t/**\n\t * Handles arrow keys.\n\t *\n\t * @private\n\t * @param {Boolean} isForward Set to true if arrow key should be handled in forward direction.\n\t * @returns {Boolean|undefined} Returns `true` if keys were handled correctly.\n\t */\n\t_handleArrowKeys( isForward ) {\n\t\tconst model = this.editor.model;\n\t\tconst schema = model.schema;\n\t\tconst modelDocument = model.document;\n\t\tconst modelSelection = modelDocument.selection;\n\t\tconst objectElement = modelSelection.getSelectedElement();\n\n\t\t// If object element is selected.\n\t\tif ( objectElement && schema.isObject( objectElement ) ) {\n\t\t\tconst position = isForward ? modelSelection.getLastPosition() : modelSelection.getFirstPosition();\n\t\t\tconst newRange = schema.getNearestSelectionRange( position, isForward ? 'forward' : 'backward' );\n\n\t\t\tif ( newRange ) {\n\t\t\t\tmodel.change( writer => {\n\t\t\t\t\twriter.setSelection( newRange );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\t// If selection is next to object element.\n\t\t// Return if not collapsed.\n\t\tif ( !modelSelection.isCollapsed ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst objectElement2 = this._getObjectElementNextToSelection( isForward );\n\n\t\tif ( !!objectElement2 && schema.isObject( objectElement2 ) ) {\n\t\t\tthis._setSelectionOverElement( objectElement2 );\n\n\t\t\treturn true;\n\t\t}\n\t}\n\n\t/**\n\t * Handles the enter key, giving users and access to positions in the editable directly before\n\t * (<kbd>Shift</kbd>+<kbd>Enter</kbd>) or after (<kbd>Enter</kbd>) the selected widget.\n\t * It improves the UX, mainly when the widget is the first or last child of the root editable\n\t * and there's no other way to type after or before it.\n\t *\n\t * @private\n\t * @param {Boolean} isBackwards Set to true if the new paragraph is to be inserted before\n\t * the selected widget (<kbd>Shift</kbd>+<kbd>Enter</kbd>).\n\t * @returns {Boolean|undefined} Returns `true` if keys were handled correctly.\n\t */\n\t_handleEnterKey( isBackwards ) {\n\t\tconst model = this.editor.model;\n\t\tconst modelSelection = model.document.selection;\n\t\tconst selectedElement = modelSelection.getSelectedElement();\n\n\t\tif ( shouldInsertParagraph( selectedElement, model.schema ) ) {\n\t\t\tmodel.change( writer => {\n\t\t\t\tlet position = writer.createPositionAt( selectedElement, isBackwards ? 'before' : 'after' );\n\t\t\t\tconst paragraph = writer.createElement( 'paragraph' );\n\n\t\t\t\t// Split the parent when inside a block element.\n\t\t\t\t// https://github.com/ckeditor/ckeditor5/issues/1529\n\t\t\t\tif ( model.schema.isBlock( selectedElement.parent ) ) {\n\t\t\t\t\tconst paragraphLimit = model.schema.findAllowedParent( position, paragraph );\n\n\t\t\t\t\tposition = writer.split( position, paragraphLimit ).position;\n\t\t\t\t}\n\n\t\t\t\twriter.insert( paragraph, position );\n\t\t\t\twriter.setSelection( paragraph, 'in' );\n\t\t\t} );\n\n\t\t\treturn true;\n\t\t}\n\t}\n\n\t/**\n\t * Extends the {@link module:engine/model/selection~Selection document's selection} to span the entire\n\t * content of the nested editable if already anchored in one.\n\t *\n\t * See: {@link module:engine/model/schema~Schema#getLimitElement}.\n\t *\n\t * @private\n\t */\n\t_selectAllNestedEditableContent() {\n\t\tconst model = this.editor.model;\n\t\tconst documentSelection = model.document.selection;\n\t\tconst limitElement = model.schema.getLimitElement( documentSelection );\n\n\t\tif ( documentSelection.getFirstRange().root == limitElement ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tmodel.change( writer => {\n\t\t\twriter.setSelection( writer.createRangeIn( limitElement ) );\n\t\t} );\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Handles <kbd>CTRL + A</kbd> when widget is selected.\n\t *\n\t * @private\n\t * @returns {Boolean} Returns true if widget was selected and selecting all was handled by this method.\n\t */\n\t_selectAllContent() {\n\t\tconst model = this.editor.model;\n\t\tconst editing = this.editor.editing;\n\t\tconst view = editing.view;\n\t\tconst viewDocument = view.document;\n\t\tconst viewSelection = viewDocument.selection;\n\n\t\tconst selectedElement = viewSelection.getSelectedElement();\n\n\t\t// Only widget is selected.\n\t\t// https://github.com/ckeditor/ckeditor5-widget/issues/23\n\t\tif ( selectedElement && isWidget( selectedElement ) ) {\n\t\t\tconst widgetParent = editing.mapper.toModelElement( selectedElement.parent );\n\n\t\t\tmodel.change( writer => {\n\t\t\t\twriter.setSelection( writer.createRangeIn( widgetParent ) );\n\t\t\t} );\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Sets {@link module:engine/model/selection~Selection document's selection} over given element.\n\t *\n\t * @private\n\t * @param {module:engine/model/element~Element} element\n\t */\n\t_setSelectionOverElement( element ) {\n\t\tthis.editor.model.change( writer => {\n\t\t\twriter.setSelection( writer.createRangeOn( element ) );\n\t\t} );\n\t}\n\n\t/**\n\t * Checks if {@link module:engine/model/element~Element element} placed next to the current\n\t * {@link module:engine/model/selection~Selection model selection} exists and is marked in\n\t * {@link module:engine/model/schema~Schema schema} as `object`.\n\t *\n\t * @private\n\t * @param {Boolean} forward Direction of checking.\n\t * @returns {module:engine/model/element~Element|null}\n\t */\n\t_getObjectElementNextToSelection( forward ) {\n\t\tconst model = this.editor.model;\n\t\tconst schema = model.schema;\n\t\tconst modelSelection = model.document.selection;\n\n\t\t// Clone current selection to use it as a probe. We must leave default selection as it is so it can return\n\t\t// to its current state after undo.\n\t\tconst probe = model.createSelection( modelSelection );\n\t\tmodel.modifySelection( probe, { direction: forward ? 'forward' : 'backward' } );\n\t\tconst objectElement = forward ? probe.focus.nodeBefore : probe.focus.nodeAfter;\n\n\t\tif ( !!objectElement && schema.isObject( objectElement ) ) {\n\t\t\treturn objectElement;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Removes CSS class from previously selected widgets.\n\t *\n\t * @private\n\t * @param {module:engine/view/downcastwriter~DowncastWriter} writer\n\t */\n\t_clearPreviouslySelectedWidgets( writer ) {\n\t\tfor ( const widget of this._previouslySelected ) {\n\t\t\twriter.removeClass( WIDGET_SELECTED_CLASS_NAME, widget );\n\t\t}\n\n\t\tthis._previouslySelected.clear();\n\t}\n}\n\n// Returns 'true' if provided key code represents one of the arrow keys.\n//\n// @param {Number} keyCode\n// @returns {Boolean}\nfunction isArrowKeyCode( keyCode ) {\n\treturn keyCode == keyCodes.arrowright ||\n\t\tkeyCode == keyCodes.arrowleft ||\n\t\tkeyCode == keyCodes.arrowup ||\n\t\tkeyCode == keyCodes.arrowdown;\n}\n\n// Returns 'true' if provided (DOM) key event data corresponds with the Ctrl+A keystroke.\n//\n// @param {module:engine/view/observer/keyobserver~KeyEventData} domEventData\n// @returns {Boolean}\nfunction isSelectAllKeyCode( domEventData ) {\n\treturn getCode( domEventData ) == selectAllKeystrokeCode;\n}\n\n// Returns `true` when element is a nested editable or is placed inside one.\n//\n// @param {module:engine/view/element~Element}\n// @returns {Boolean}\nfunction isInsideNestedEditable( element ) {\n\twhile ( element ) {\n\t\tif ( element.is( 'editableElement' ) && !element.is( 'rootElement' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Click on nested widget should select it.\n\t\tif ( isWidget( element ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\telement = element.parent;\n\t}\n\n\treturn false;\n}\n\n// Checks whether the specified `element` is a child of the `parent` element.\n//\n// @param {module:engine/view/element~Element} element An element to check.\n// @param {module:engine/view/element~Element|null} parent A parent for the element.\n// @returns {Boolean}\nfunction isChild( element, parent ) {\n\tif ( !parent ) {\n\t\treturn false;\n\t}\n\n\treturn Array.from( element.getAncestors() ).includes( parent );\n}\n\n// Checks if enter key should insert paragraph. This should be done only on elements of type object (excluding inline objects).\n//\n// @param {module:engine/model/element~Element} element And element to check.\n// @param {module:engine/model/schema~Schema} schema\nfunction shouldInsertParagraph( element, schema ) {\n\treturn element && schema.isObject( element ) && !schema.isInline( element );\n}\n"]}]}