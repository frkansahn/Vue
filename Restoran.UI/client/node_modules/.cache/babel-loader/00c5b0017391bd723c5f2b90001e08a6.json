{"remainingRequest":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-engine\\src\\view\\element.js","dependencies":[{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-engine\\src\\view\\element.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-dev-webpack-plugin\\lib\\translatesourceloader.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1581760768702},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1581760768279}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mcm9tIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm1hcCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zZXQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcubWF0Y2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKaW1wb3J0IF9jb25zdHJ1Y3QgZnJvbSAiQzpcXFVzZXJzXFxwY1xcRGVza3RvcFxcUmVzdG9yYW5cXFJlc3RvcmFuXFxSZXN0b3Jhbi5VSVxcY2xpZW50XFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9jb25zdHJ1Y3QiOwppbXBvcnQgX3NsaWNlZFRvQXJyYXkgZnJvbSAiQzpcXFVzZXJzXFxwY1xcRGVza3RvcFxcUmVzdG9yYW5cXFJlc3RvcmFuXFxSZXN0b3Jhbi5VSVxcY2xpZW50XFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5IjsKaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJDOlxcVXNlcnNcXHBjXFxEZXNrdG9wXFxSZXN0b3JhblxcUmVzdG9yYW5cXFJlc3RvcmFuLlVJXFxjbGllbnRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5IjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkM6XFxVc2Vyc1xccGNcXERlc2t0b3BcXFJlc3RvcmFuXFxSZXN0b3JhblxcUmVzdG9yYW4uVUlcXGNsaWVudFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6XFxVc2Vyc1xccGNcXERlc2t0b3BcXFJlc3RvcmFuXFxSZXN0b3JhblxcUmVzdG9yYW4uVUlcXGNsaWVudFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gZnJvbSAiQzpcXFVzZXJzXFxwY1xcRGVza3RvcFxcUmVzdG9yYW5cXFJlc3RvcmFuXFxSZXN0b3Jhbi5VSVxcY2xpZW50XFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIjsKaW1wb3J0IF9nZXRQcm90b3R5cGVPZiBmcm9tICJDOlxcVXNlcnNcXHBjXFxEZXNrdG9wXFxSZXN0b3JhblxcUmVzdG9yYW5cXFJlc3RvcmFuLlVJXFxjbGllbnRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2dldFByb3RvdHlwZU9mIjsKaW1wb3J0IF9nZXQgZnJvbSAiQzpcXFVzZXJzXFxwY1xcRGVza3RvcFxcUmVzdG9yYW5cXFJlc3RvcmFuXFxSZXN0b3Jhbi5VSVxcY2xpZW50XFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9nZXQiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkM6XFxVc2Vyc1xccGNcXERlc2t0b3BcXFJlc3RvcmFuXFxSZXN0b3JhblxcUmVzdG9yYW4uVUlcXGNsaWVudFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHMiOwoKLyoqCiAqIEBsaWNlbnNlIENvcHlyaWdodCAoYykgMjAwMy0yMDIwLCBDS1NvdXJjZSAtIEZyZWRlcmljbyBLbmFiYmVuLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiBGb3IgbGljZW5zaW5nLCBzZWUgTElDRU5TRS5tZCBvciBodHRwczovL2NrZWRpdG9yLmNvbS9sZWdhbC9ja2VkaXRvci1vc3MtbGljZW5zZQogKi8KCi8qKgogKiBAbW9kdWxlIGVuZ2luZS92aWV3L2VsZW1lbnQKICovCmltcG9ydCBOb2RlIGZyb20gJy4vbm9kZSc7CmltcG9ydCBUZXh0IGZyb20gJy4vdGV4dCc7CmltcG9ydCBUZXh0UHJveHkgZnJvbSAnLi90ZXh0cHJveHknOwppbXBvcnQgdG9NYXAgZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11dGlscy9zcmMvdG9tYXAnOwppbXBvcnQgaXNJdGVyYWJsZSBmcm9tICdAY2tlZGl0b3IvY2tlZGl0b3I1LXV0aWxzL3NyYy9pc2l0ZXJhYmxlJzsKaW1wb3J0IE1hdGNoZXIgZnJvbSAnLi9tYXRjaGVyJzsKaW1wb3J0IFN0eWxlc01hcCBmcm9tICcuL3N0eWxlc21hcCc7IC8vIEBpZiBDS19ERUJVR19FTkdJTkUgLy8gY29uc3QgeyBjb252ZXJ0TWFwVG9UYWdzIH0gPSByZXF1aXJlKCAnLi4vZGV2LXV0aWxzL3V0aWxzJyApOwoKLyoqCiAqIFZpZXcgZWxlbWVudC4KICoKICogVGhlIGVkaXRpbmcgZW5naW5lIGRvZXMgbm90IGRlZmluZSBhIGZpeGVkIHNlbWFudGljcyBvZiBpdHMgZWxlbWVudHMgKGl0IGlzICJEVEQtZnJlZSIpLgogKiBUaGlzIGlzIHdoeSB0aGUgdHlwZSBvZiB0aGUge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9lbGVtZW50fkVsZW1lbnR9IG5lZWQgdG8KICogYmUgZGVmaW5lZCBieSB0aGUgZmVhdHVyZSBkZXZlbG9wZXIuIFdoZW4gY3JlYXRpbmcgYW4gZWxlbWVudCB5b3Ugc2hvdWxkIHVzZSBvbmUgb2YgdGhlIGZvbGxvd2luZyBtZXRob2RzOgogKgogKiAqIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXIjY3JlYXRlQ29udGFpbmVyRWxlbWVudCBgZG93bmNhc3RXcml0ZXIjY3JlYXRlQ29udGFpbmVyRWxlbWVudCgpYH0KICogaW4gb3JkZXIgdG8gY3JlYXRlIGEge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9jb250YWluZXJlbGVtZW50fkNvbnRhaW5lckVsZW1lbnR9LAogKiAqIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXIjY3JlYXRlQXR0cmlidXRlRWxlbWVudCBgZG93bmNhc3RXcml0ZXIjY3JlYXRlQXR0cmlidXRlRWxlbWVudCgpYH0KICogaW4gb3JkZXIgdG8gY3JlYXRlIGEge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9hdHRyaWJ1dGVlbGVtZW50fkF0dHJpYnV0ZUVsZW1lbnR9LAogKiAqIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXIjY3JlYXRlRW1wdHlFbGVtZW50IGBkb3duY2FzdFdyaXRlciNjcmVhdGVFbXB0eUVsZW1lbnQoKWB9CiAqIGluIG9yZGVyIHRvIGNyZWF0ZSBhIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZW1wdHllbGVtZW50fkVtcHR5RWxlbWVudH0uCiAqICoge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9kb3duY2FzdHdyaXRlcn5Eb3duY2FzdFdyaXRlciNjcmVhdGVVSUVsZW1lbnQgYGRvd25jYXN0V3JpdGVyI2NyZWF0ZVVJRWxlbWVudCgpYH0KICogaW4gb3JkZXIgdG8gY3JlYXRlIGEge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy91aWVsZW1lbnR+VUlFbGVtZW50fS4KICogKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyI2NyZWF0ZUVkaXRhYmxlRWxlbWVudCBgZG93bmNhc3RXcml0ZXIjY3JlYXRlRWRpdGFibGVFbGVtZW50KClgfQogKiBpbiBvcmRlciB0byBjcmVhdGUgYSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L2VkaXRhYmxlZWxlbWVudH5FZGl0YWJsZUVsZW1lbnR9LgogKgogKiBOb3RlIHRoYXQgZm9yIHZpZXcgZWxlbWVudHMgd2hpY2ggYXJlIG5vdCBjcmVhdGVkIGZyb20gdGhlIG1vZGVsLCBsaWtlIGVsZW1lbnRzIGZyb20gbXV0YXRpb25zLCBwYXN0ZSBvcgogKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS9jb250cm9sbGVyL2RhdGFjb250cm9sbGVyfkRhdGFDb250cm9sbGVyI3NldCBkYXRhLnNldH0gaXQgaXMgbm90IHBvc3NpYmxlIHRvIGRlZmluZSB0aGUgdHlwZSBvZiB0aGUgZWxlbWVudC4KICogSW4gc3VjaCBjYXNlcyB0aGUge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy91cGNhc3R3cml0ZXJ+VXBjYXN0V3JpdGVyI2NyZWF0ZUVsZW1lbnQgYFVwY2FzdFdyaXRlciNjcmVhdGVFbGVtZW50KClgfSBtZXRob2QKICogc2hvdWxkIGJlIHVzZWQgdG8gY3JlYXRlIGdlbmVyaWMgdmlldyBlbGVtZW50cy4KICoKICogQGV4dGVuZHMgbW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZQogKi8KCnZhciBFbGVtZW50ID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX05vZGUpIHsKICBfaW5oZXJpdHMoRWxlbWVudCwgX05vZGUpOwoKICAvKioKICAgKiBDcmVhdGVzIGEgdmlldyBlbGVtZW50LgogICAqCiAgICogQXR0cmlidXRlcyBjYW4gYmUgcGFzc2VkIGluIHZhcmlvdXMgZm9ybWF0czoKICAgKgogICAqCQluZXcgRWxlbWVudCggdmlld0RvY3VtZW50LCAnZGl2JywgeyBjbGFzczogJ2VkaXRvcicsIGNvbnRlbnRFZGl0YWJsZTogJ3RydWUnIH0gKTsgLy8gb2JqZWN0CiAgICoJCW5ldyBFbGVtZW50KCB2aWV3RG9jdW1lbnQsICdkaXYnLCBbIFsgJ2NsYXNzJywgJ2VkaXRvcicgXSwgWyAnY29udGVudEVkaXRhYmxlJywgJ3RydWUnIF0gXSApOyAvLyBtYXAtbGlrZSBpdGVyYXRvcgogICAqCQluZXcgRWxlbWVudCggdmlld0RvY3VtZW50LCAnZGl2JywgbWFwT2ZBdHRyaWJ1dGVzICk7IC8vIG1hcAogICAqCiAgICogQHByb3RlY3RlZAogICAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L2RvY3VtZW50fkRvY3VtZW50fSBkb2N1bWVudCBUaGUgZG9jdW1lbnQgaW5zdGFuY2UgdG8gd2hpY2ggdGhpcyBlbGVtZW50IGJlbG9uZ3MuCiAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgTm9kZSBuYW1lLgogICAqIEBwYXJhbSB7T2JqZWN0fEl0ZXJhYmxlfSBbYXR0cnNdIENvbGxlY3Rpb24gb2YgYXR0cmlidXRlcy4KICAgKiBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGV8SXRlcmFibGUuPG1vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGU+fSBbY2hpbGRyZW5dCiAgICogQSBsaXN0IG9mIG5vZGVzIHRvIGJlIGluc2VydGVkIGludG8gY3JlYXRlZCBlbGVtZW50LgogICAqLwogIGZ1bmN0aW9uIEVsZW1lbnQoZG9jdW1lbnQsIG5hbWUsIGF0dHJzLCBjaGlsZHJlbikgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFbGVtZW50KTsKCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihFbGVtZW50KS5jYWxsKHRoaXMsIGRvY3VtZW50KSk7CiAgICAvKioKICAgICAqIE5hbWUgb2YgdGhlIGVsZW1lbnQuCiAgICAgKgogICAgICogQHJlYWRvbmx5CiAgICAgKiBAbWVtYmVyIHtTdHJpbmd9CiAgICAgKi8KCiAgICBfdGhpcy5uYW1lID0gbmFtZTsKICAgIC8qKgogICAgICogTWFwIG9mIGF0dHJpYnV0ZXMsIHdoZXJlIGF0dHJpYnV0ZXMgbmFtZXMgYXJlIGtleXMgYW5kIGF0dHJpYnV0ZXMgdmFsdWVzIGFyZSB2YWx1ZXMuCiAgICAgKgogICAgICogQHByb3RlY3RlZAogICAgICogQG1lbWJlciB7TWFwfSAjX2F0dHJzCiAgICAgKi8KCiAgICBfdGhpcy5fYXR0cnMgPSBwYXJzZUF0dHJpYnV0ZXMoYXR0cnMpOwogICAgLyoqCiAgICAgKiBBcnJheSBvZiBjaGlsZCBub2Rlcy4KICAgICAqCiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAbWVtYmVyIHtBcnJheS48bW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZT59CiAgICAgKi8KCiAgICBfdGhpcy5fY2hpbGRyZW4gPSBbXTsKCiAgICBpZiAoY2hpbGRyZW4pIHsKICAgICAgX3RoaXMuX2luc2VydENoaWxkKDAsIGNoaWxkcmVuKTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IG9mIGNsYXNzZXMgYXNzb2NpYXRlZCB3aXRoIGVsZW1lbnQgaW5zdGFuY2UuCiAgICAgKgogICAgICogQHByb3RlY3RlZAogICAgICogQG1lbWJlciB7U2V0fQogICAgICovCgoKICAgIF90aGlzLl9jbGFzc2VzID0gbmV3IFNldCgpOwoKICAgIGlmIChfdGhpcy5fYXR0cnMuaGFzKCdjbGFzcycpKSB7CiAgICAgIC8vIFJlbW92ZSBjbGFzcyBhdHRyaWJ1dGUgYW5kIGhhbmRsZSBpdCBieSBjbGFzcyBzZXQuCiAgICAgIHZhciBjbGFzc1N0cmluZyA9IF90aGlzLl9hdHRycy5nZXQoJ2NsYXNzJyk7CgogICAgICBwYXJzZUNsYXNzZXMoX3RoaXMuX2NsYXNzZXMsIGNsYXNzU3RyaW5nKTsKCiAgICAgIF90aGlzLl9hdHRycy5kZWxldGUoJ2NsYXNzJyk7CiAgICB9CiAgICAvKioKICAgICAqIE5vcm1hbGl6ZWQgc3R5bGVzLgogICAgICoKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEBtZW1iZXIge21vZHVsZTplbmdpbmUvdmlldy9zdHlsZXNtYXB+U3R5bGVzTWFwfSBtb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50I19zdHlsZXMKICAgICAqLwoKCiAgICBfdGhpcy5fc3R5bGVzID0gbmV3IFN0eWxlc01hcChfdGhpcy5kb2N1bWVudC5zdHlsZXNQcm9jZXNzb3IpOwoKICAgIGlmIChfdGhpcy5fYXR0cnMuaGFzKCdzdHlsZScpKSB7CiAgICAgIC8vIFJlbW92ZSBzdHlsZSBhdHRyaWJ1dGUgYW5kIGhhbmRsZSBpdCBieSBzdHlsZXMgbWFwLgogICAgICBfdGhpcy5fc3R5bGVzLnNldFRvKF90aGlzLl9hdHRycy5nZXQoJ3N0eWxlJykpOwoKICAgICAgX3RoaXMuX2F0dHJzLmRlbGV0ZSgnc3R5bGUnKTsKICAgIH0KICAgIC8qKgogICAgICogTWFwIG9mIGN1c3RvbSBwcm9wZXJ0aWVzLgogICAgICogQ3VzdG9tIHByb3BlcnRpZXMgY2FuIGJlIGFkZGVkIHRvIGVsZW1lbnQgaW5zdGFuY2UsIHdpbGwgYmUgY2xvbmVkIGJ1dCBub3QgcmVuZGVyZWQgaW50byBET00uCiAgICAgKgogICAgICogQHByb3RlY3RlZAogICAgICogQG1lbWJlciB7TWFwfQogICAgICovCgoKICAgIF90aGlzLl9jdXN0b21Qcm9wZXJ0aWVzID0gbmV3IE1hcCgpOwogICAgcmV0dXJuIF90aGlzOwogIH0KICAvKioKICAgKiBOdW1iZXIgb2YgZWxlbWVudCdzIGNoaWxkcmVuLgogICAqCiAgICogQHJlYWRvbmx5CiAgICogQHR5cGUge051bWJlcn0KICAgKi8KCgogIF9jcmVhdGVDbGFzcyhFbGVtZW50LCBbewogICAga2V5OiAiaXMiLAoKICAgIC8qKgogICAgICogQ2hlY2tzIHdoZXRoZXIgdGhpcyBvYmplY3QgaXMgb2YgdGhlIGdpdmVuLgogICAgICoKICAgICAqCQllbGVtZW50LmlzKCAnZWxlbWVudCcgKTsgLy8gLT4gdHJ1ZQogICAgICoJCWVsZW1lbnQuaXMoICdub2RlJyApOyAvLyAtPiB0cnVlCiAgICAgKgkJZWxlbWVudC5pcyggJ3ZpZXc6ZWxlbWVudCcgKTsgLy8gLT4gdHJ1ZQogICAgICoJCWVsZW1lbnQuaXMoICd2aWV3Om5vZGUnICk7IC8vIC0+IHRydWUKICAgICAqCiAgICAgKgkJZWxlbWVudC5pcyggJ21vZGVsOmVsZW1lbnQnICk7IC8vIC0+IGZhbHNlCiAgICAgKgkJZWxlbWVudC5pcyggJ2RvY3VtZW50U2VsZWN0aW9uJyApOyAvLyAtPiBmYWxzZQogICAgICoKICAgICAqIEFzc3VtaW5nIHRoYXQgdGhlIG9iamVjdCBiZWluZyBjaGVja2VkIGlzIGFuIGVsZW1lbnQsIHlvdSBjYW4gYWxzbyBjaGVjayBpdHMKICAgICAqIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50I25hbWUgbmFtZX06CiAgICAgKgogICAgICoJCWVsZW1lbnQuaXMoICdpbWcnICk7IC8vIC0+IHRydWUgaWYgdGhpcyBpcyBhbiA8aW1nPiBlbGVtZW50CiAgICAgKgkJZWxlbWVudC5pcyggJ2VsZW1lbnQnLCAnaW1nJyApOyAvLyAtPiBzYW1lIGFzIGFib3ZlCiAgICAgKgkJdGV4dC5pcyggJ2ltZycgKTsgLT4gZmFsc2UKICAgICAqCiAgICAgKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZSNpcyBDaGVjayB0aGUgZW50aXJlIGxpc3Qgb2YgdmlldyBvYmplY3RzfSB3aGljaCBpbXBsZW1lbnQgdGhlIGBpcygpYCBtZXRob2QuCiAgICAgKgogICAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgVHlwZSB0byBjaGVjayB3aGVuIGBuYW1lYCBwYXJhbWV0ZXIgaXMgcHJlc2VudC4KICAgICAqIE90aGVyd2lzZSwgaXQgYWN0cyBsaWtlIHRoZSBgbmFtZWAgcGFyYW1ldGVyLgogICAgICogQHBhcmFtIHtTdHJpbmd9IFtuYW1lXSBFbGVtZW50IG5hbWUuCiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0KICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIGlzKHR5cGUpIHsKICAgICAgdmFyIG5hbWUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IG51bGw7CiAgICAgIHZhciBjdXRUeXBlID0gdHlwZS5yZXBsYWNlKC9edmlldzovLCAnJyk7CgogICAgICBpZiAoIW5hbWUpIHsKICAgICAgICByZXR1cm4gY3V0VHlwZSA9PSAnZWxlbWVudCcgfHwgY3V0VHlwZSA9PSB0aGlzLm5hbWUgfHwgX2dldChfZ2V0UHJvdG90eXBlT2YoRWxlbWVudC5wcm90b3R5cGUpLCAiaXMiLCB0aGlzKS5jYWxsKHRoaXMsIHR5cGUpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBjdXRUeXBlID09ICdlbGVtZW50JyAmJiBuYW1lID09IHRoaXMubmFtZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBHZXRzIGNoaWxkIGF0IHRoZSBnaXZlbiBpbmRleC4KICAgICAqCiAgICAgKiBAcGFyYW0ge051bWJlcn0gaW5kZXggSW5kZXggb2YgY2hpbGQuCiAgICAgKiBAcmV0dXJucyB7bW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZX0gQ2hpbGQgbm9kZS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRDaGlsZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2hpbGQoaW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuW2luZGV4XTsKICAgIH0KICAgIC8qKgogICAgICogR2V0cyBpbmRleCBvZiB0aGUgZ2l2ZW4gY2hpbGQgbm9kZS4gUmV0dXJucyBgLTFgIGlmIGNoaWxkIG5vZGUgaXMgbm90IGZvdW5kLgogICAgICoKICAgICAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZX0gbm9kZSBDaGlsZCBub2RlLgogICAgICogQHJldHVybnMge051bWJlcn0gSW5kZXggb2YgdGhlIGNoaWxkIG5vZGUuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0Q2hpbGRJbmRleCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2hpbGRJbmRleChub2RlKSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbi5pbmRleE9mKG5vZGUpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXRzIGNoaWxkIG5vZGVzIGl0ZXJhdG9yLgogICAgICoKICAgICAqIEByZXR1cm5zIHtJdGVyYWJsZS48bW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZT59IENoaWxkIG5vZGVzIGl0ZXJhdG9yLgogICAgICovCgogIH0sIHsKICAgIGtleTogImdldENoaWxkcmVuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDaGlsZHJlbigpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuW1N5bWJvbC5pdGVyYXRvcl0oKTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBhbiBpdGVyYXRvciB0aGF0IGNvbnRhaW5zIHRoZSBrZXlzIGZvciBhdHRyaWJ1dGVzLiBPcmRlciBvZiBpbnNlcnRpbmcgYXR0cmlidXRlcyBpcyBub3QgcHJlc2VydmVkLgogICAgICoKICAgICAqIEByZXR1cm5zIHtJdGVyYWJsZS48U3RyaW5nPn0gS2V5cyBmb3IgYXR0cmlidXRlcy4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRBdHRyaWJ1dGVLZXlzIiwKICAgIHZhbHVlOgogICAgLyojX19QVVJFX18qLwogICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gZ2V0QXR0cmlidXRlS2V5cygpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIGdldEF0dHJpYnV0ZUtleXMkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGlmICghKHRoaXMuX2NsYXNzZXMuc2l6ZSA+IDApKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuICdjbGFzcyc7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0eWxlcy5pc0VtcHR5KSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgcmV0dXJuICdzdHlsZSc7CgogICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmRlbGVnYXRlWWllbGQodGhpcy5fYXR0cnMua2V5cygpLCAidDAiLCA3KTsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgZ2V0QXR0cmlidXRlS2V5cywgdGhpcyk7CiAgICB9KQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGl0ZXJhdG9yIHRoYXQgaXRlcmF0ZXMgb3ZlciB0aGlzIGVsZW1lbnQncyBhdHRyaWJ1dGVzLgogICAgICoKICAgICAqIEF0dHJpYnV0ZXMgYXJlIHJldHVybmVkIGFzIGFycmF5cyBjb250YWluaW5nIHR3byBpdGVtcy4gRmlyc3Qgb25lIGlzIGF0dHJpYnV0ZSBrZXkgYW5kIHNlY29uZCBpcyBhdHRyaWJ1dGUgdmFsdWUuCiAgICAgKiBUaGlzIGZvcm1hdCBpcyBhY2NlcHRlZCBieSBuYXRpdmUgYE1hcGAgb2JqZWN0IGFuZCBhbHNvIGNhbiBiZSBwYXNzZWQgaW4gYE5vZGVgIGNvbnN0cnVjdG9yLgogICAgICoKICAgICAqIEByZXR1cm5zIHtJdGVyYWJsZS48Kj59CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0QXR0cmlidXRlcyIsCiAgICB2YWx1ZToKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIGdldEF0dHJpYnV0ZXMoKSB7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBnZXRBdHRyaWJ1dGVzJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmRlbGVnYXRlWWllbGQodGhpcy5fYXR0cnMuZW50cmllcygpLCAidDAiLCAxKTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICBpZiAoISh0aGlzLl9jbGFzc2VzLnNpemUgPiAwKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDQ7CiAgICAgICAgICAgICAgcmV0dXJuIFsnY2xhc3MnLCB0aGlzLmdldEF0dHJpYnV0ZSgnY2xhc3MnKV07CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0eWxlcy5pc0VtcHR5KSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDc7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgICByZXR1cm4gWydzdHlsZScsIHRoaXMuZ2V0QXR0cmlidXRlKCdzdHlsZScpXTsKCiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIGdldEF0dHJpYnV0ZXMsIHRoaXMpOwogICAgfSkKICAgIC8qKgogICAgICogR2V0cyBhdHRyaWJ1dGUgYnkga2V5LiBJZiBhdHRyaWJ1dGUgaXMgbm90IHByZXNlbnQgLSByZXR1cm5zIHVuZGVmaW5lZC4KICAgICAqCiAgICAgKiBAcGFyYW0ge1N0cmluZ30ga2V5IEF0dHJpYnV0ZSBrZXkuCiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfHVuZGVmaW5lZH0gQXR0cmlidXRlIHZhbHVlLgogICAgICovCgogIH0sIHsKICAgIGtleTogImdldEF0dHJpYnV0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0QXR0cmlidXRlKGtleSkgewogICAgICBpZiAoa2V5ID09ICdjbGFzcycpIHsKICAgICAgICBpZiAodGhpcy5fY2xhc3Nlcy5zaXplID4gMCkgewogICAgICAgICAgcmV0dXJuIF90b0NvbnN1bWFibGVBcnJheSh0aGlzLl9jbGFzc2VzKS5qb2luKCcgJyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICB9CgogICAgICBpZiAoa2V5ID09ICdzdHlsZScpIHsKICAgICAgICB2YXIgaW5saW5lU3R5bGUgPSB0aGlzLl9zdHlsZXMudG9TdHJpbmcoKTsKCiAgICAgICAgcmV0dXJuIGlubGluZVN0eWxlID09ICcnID8gdW5kZWZpbmVkIDogaW5saW5lU3R5bGU7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLl9hdHRycy5nZXQoa2V5KTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBhIGJvb2xlYW4gaW5kaWNhdGluZyB3aGV0aGVyIGFuIGF0dHJpYnV0ZSB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IGV4aXN0cyBpbiB0aGUgZWxlbWVudC4KICAgICAqCiAgICAgKiBAcGFyYW0ge1N0cmluZ30ga2V5IEF0dHJpYnV0ZSBrZXkuCiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gYHRydWVgIGlmIGF0dHJpYnV0ZSB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IGV4aXN0cyBpbiB0aGUgZWxlbWVudCwgZmFsc2Ugb3RoZXJ3aXNlLgogICAgICovCgogIH0sIHsKICAgIGtleTogImhhc0F0dHJpYnV0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzQXR0cmlidXRlKGtleSkgewogICAgICBpZiAoa2V5ID09ICdjbGFzcycpIHsKICAgICAgICByZXR1cm4gdGhpcy5fY2xhc3Nlcy5zaXplID4gMDsKICAgICAgfQoKICAgICAgaWYgKGtleSA9PSAnc3R5bGUnKSB7CiAgICAgICAgcmV0dXJuICF0aGlzLl9zdHlsZXMuaXNFbXB0eTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuX2F0dHJzLmhhcyhrZXkpOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVja3MgaWYgdGhpcyBlbGVtZW50IGlzIHNpbWlsYXIgdG8gb3RoZXIgZWxlbWVudC4KICAgICAqIEJvdGggZWxlbWVudHMgc2hvdWxkIGhhdmUgdGhlIHNhbWUgbmFtZSBhbmQgYXR0cmlidXRlcyB0byBiZSBjb25zaWRlcmVkIGFzIHNpbWlsYXIuIFR3byBzaW1pbGFyIGVsZW1lbnRzCiAgICAgKiBjYW4gY29udGFpbiBkaWZmZXJlbnQgc2V0IG9mIGNoaWxkcmVuIG5vZGVzLgogICAgICoKICAgICAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L2VsZW1lbnR+RWxlbWVudH0gb3RoZXJFbGVtZW50CiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJpc1NpbWlsYXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzU2ltaWxhcihvdGhlckVsZW1lbnQpIHsKICAgICAgaWYgKCEob3RoZXJFbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCkpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gSWYgZXhhY3RseSB0aGUgc2FtZSBFbGVtZW50IGlzIHByb3ZpZGVkIC0gcmV0dXJuIHRydWUgaW1tZWRpYXRlbHkuCgoKICAgICAgaWYgKHRoaXMgPT09IG90aGVyRWxlbWVudCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IC8vIENoZWNrIGVsZW1lbnQgbmFtZS4KCgogICAgICBpZiAodGhpcy5uYW1lICE9IG90aGVyRWxlbWVudC5uYW1lKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8vIENoZWNrIG51bWJlciBvZiBhdHRyaWJ1dGVzLCBjbGFzc2VzIGFuZCBzdHlsZXMuCgoKICAgICAgaWYgKHRoaXMuX2F0dHJzLnNpemUgIT09IG90aGVyRWxlbWVudC5fYXR0cnMuc2l6ZSB8fCB0aGlzLl9jbGFzc2VzLnNpemUgIT09IG90aGVyRWxlbWVudC5fY2xhc3Nlcy5zaXplIHx8IHRoaXMuX3N0eWxlcy5zaXplICE9PSBvdGhlckVsZW1lbnQuX3N0eWxlcy5zaXplKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8vIENoZWNrIGlmIGF0dHJpYnV0ZXMgYXJlIHRoZSBzYW1lLgoKCiAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTsKICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yID0gZmFsc2U7CiAgICAgIHZhciBfaXRlcmF0b3JFcnJvciA9IHVuZGVmaW5lZDsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yID0gdGhpcy5fYXR0cnNbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gKF9zdGVwID0gX2l0ZXJhdG9yLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlKSB7CiAgICAgICAgICB2YXIgX3N0ZXAkdmFsdWUgPSBfc2xpY2VkVG9BcnJheShfc3RlcC52YWx1ZSwgMiksCiAgICAgICAgICAgICAga2V5ID0gX3N0ZXAkdmFsdWVbMF0sCiAgICAgICAgICAgICAgdmFsdWUgPSBfc3RlcCR2YWx1ZVsxXTsKCiAgICAgICAgICBpZiAoIW90aGVyRWxlbWVudC5fYXR0cnMuaGFzKGtleSkgfHwgb3RoZXJFbGVtZW50Ll9hdHRycy5nZXQoa2V5KSAhPT0gdmFsdWUpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0gLy8gQ2hlY2sgaWYgY2xhc3NlcyBhcmUgdGhlIHNhbWUuCgogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7CiAgICAgICAgX2l0ZXJhdG9yRXJyb3IgPSBlcnI7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuICE9IG51bGwpIHsKICAgICAgICAgICAgX2l0ZXJhdG9yLnJldHVybigpOwogICAgICAgICAgfQogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IpIHsKICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSB0cnVlOwogICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IyID0gZmFsc2U7CiAgICAgIHZhciBfaXRlcmF0b3JFcnJvcjIgPSB1bmRlZmluZWQ7CgogICAgICB0cnkgewogICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSB0aGlzLl9jbGFzc2VzW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXAyOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gKF9zdGVwMiA9IF9pdGVyYXRvcjIubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSB0cnVlKSB7CiAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gX3N0ZXAyLnZhbHVlOwoKICAgICAgICAgIGlmICghb3RoZXJFbGVtZW50Ll9jbGFzc2VzLmhhcyhjbGFzc05hbWUpKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9IC8vIENoZWNrIGlmIHN0eWxlcyBhcmUgdGhlIHNhbWUuCgogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjIgPSB0cnVlOwogICAgICAgIF9pdGVyYXRvckVycm9yMiA9IGVycjsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiAmJiBfaXRlcmF0b3IyLnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjIucmV0dXJuKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjIpIHsKICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3IyOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zID0gdHJ1ZTsKICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMyA9IGZhbHNlOwogICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IzID0gdW5kZWZpbmVkOwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IzID0gdGhpcy5fc3R5bGVzLmdldFN0eWxlTmFtZXMoKVtTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwMzsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IChfc3RlcDMgPSBfaXRlcmF0b3IzLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zID0gdHJ1ZSkgewogICAgICAgICAgdmFyIHByb3BlcnR5ID0gX3N0ZXAzLnZhbHVlOwoKICAgICAgICAgIGlmICghb3RoZXJFbGVtZW50Ll9zdHlsZXMuaGFzKHByb3BlcnR5KSB8fCBvdGhlckVsZW1lbnQuX3N0eWxlcy5nZXRBc1N0cmluZyhwcm9wZXJ0eSkgIT09IHRoaXMuX3N0eWxlcy5nZXRBc1N0cmluZyhwcm9wZXJ0eSkpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IzID0gdHJ1ZTsKICAgICAgICBfaXRlcmF0b3JFcnJvcjMgPSBlcnI7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMgJiYgX2l0ZXJhdG9yMy5yZXR1cm4gIT0gbnVsbCkgewogICAgICAgICAgICBfaXRlcmF0b3IzLnJldHVybigpOwogICAgICAgICAgfQogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IzKSB7CiAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgY2xhc3MgaXMgcHJlc2VudC4KICAgICAqIElmIG1vcmUgdGhlbiBvbmUgY2xhc3MgaXMgcHJvdmlkZWQgLSByZXR1cm5zIHRydWUgb25seSB3aGVuIGFsbCBjbGFzc2VzIGFyZSBwcmVzZW50LgogICAgICoKICAgICAqCQllbGVtZW50Lmhhc0NsYXNzKCAnZm9vJyApOyAvLyBSZXR1cm5zIHRydWUgaWYgJ2ZvbycgY2xhc3MgaXMgcHJlc2VudC4KICAgICAqCQllbGVtZW50Lmhhc0NsYXNzKCAnZm9vJywgJ2JhcicgKTsgLy8gUmV0dXJucyB0cnVlIGlmICdmb28nIGFuZCAnYmFyJyBjbGFzc2VzIGFyZSBib3RoIHByZXNlbnQuCiAgICAgKgogICAgICogQHBhcmFtIHsuLi5TdHJpbmd9IGNsYXNzTmFtZQogICAgICovCgogIH0sIHsKICAgIGtleTogImhhc0NsYXNzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBoYXNDbGFzcygpIHsKICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGNsYXNzTmFtZSA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHsKICAgICAgICBjbGFzc05hbWVbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICAgIH0KCiAgICAgIGZvciAodmFyIF9pID0gMCwgX2NsYXNzTmFtZSA9IGNsYXNzTmFtZTsgX2kgPCBfY2xhc3NOYW1lLmxlbmd0aDsgX2krKykgewogICAgICAgIHZhciBuYW1lID0gX2NsYXNzTmFtZVtfaV07CgogICAgICAgIGlmICghdGhpcy5fY2xhc3Nlcy5oYXMobmFtZSkpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGl0ZXJhdG9yIHRoYXQgY29udGFpbnMgYWxsIGNsYXNzIG5hbWVzLgogICAgICoKICAgICAqIEByZXR1cm5zIHtJdGVyYWJsZS48U3RyaW5nPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRDbGFzc05hbWVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDbGFzc05hbWVzKCkgewogICAgICByZXR1cm4gdGhpcy5fY2xhc3Nlcy5rZXlzKCk7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgc3R5bGUgdmFsdWUgZm9yIHRoZSBnaXZlbiBwcm9wZXJ0eSBtYWUuCiAgICAgKiBJZiB0aGUgc3R5bGUgZG9lcyBub3QgZXhpc3QgYHVuZGVmaW5lZGAgaXMgcmV0dXJuZWQuCiAgICAgKgogICAgICogKipOb3RlKio6IFRoaXMgbWV0aG9kIGNhbiB3b3JrIHdpdGggbm9ybWFsaXplZCBzdHlsZSBuYW1lcyBpZgogICAgICoge0BsaW5rIG1vZHVsZTplbmdpbmUvY29udHJvbGxlci9kYXRhY29udHJvbGxlcn5EYXRhQ29udHJvbGxlciNhZGRTdHlsZVByb2Nlc3NvclJ1bGVzIGEgcGFydGljdWxhciBzdHlsZSBwcm9jZXNzb3IgcnVsZSBpcyBlbmFibGVkfS4KICAgICAqIFNlZSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3N0eWxlc21hcH5TdHlsZXNNYXAjZ2V0QXNTdHJpbmcgYFN0eWxlc01hcCNnZXRBc1N0cmluZygpYH0gZm9yIGRldGFpbHMuCiAgICAgKgogICAgICogRm9yIGFuIGVsZW1lbnQgd2l0aCBzdHlsZSBzZXQgdG8gYCdtYXJnaW46MXB4J2A6CiAgICAgKgogICAgICoJCS8vIEVuYWJsZSAnbWFyZ2luJyBzaG9ydGhhbmQgcHJvY2Vzc2luZzoKICAgICAqCQllZGl0b3IuZGF0YS5hZGRTdHlsZVByb2Nlc3NvclJ1bGVzKCBhZGRNYXJnaW5SdWxlcyApOwogICAgICoKICAgICAqCQljb25zdCBlbGVtZW50ID0gdmlldy5jaGFuZ2UoIHdyaXRlciA9PiB7CiAgICAgKgkJCWNvbnN0IGVsZW1lbnQgPSB3cml0ZXIuY3JlYXRlRWxlbWVudCgpOwogICAgICoJCQl3cml0ZXIuc2V0U3R5bGUoICdtYXJnaW4nLCAnMXB4JyApOwogICAgICoJCQl3cml0ZXIuc2V0U3R5bGUoICdtYXJnaW4tYm90dG9tJywgJzNlbScgKTsKICAgICAqCiAgICAgKgkJCXJldHVybiBlbGVtZW50OwogICAgICoJCX0gKTsKICAgICAqCiAgICAgKgkJZWxlbWVudC5nZXRTdHlsZSggJ21hcmdpbicgKTsgLy8gLT4gJ21hcmdpbjogMXB4IDFweCAzZW07JwogICAgICoKICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wZXJ0eQogICAgICogQHJldHVybnMge1N0cmluZ3x1bmRlZmluZWR9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0U3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFN0eWxlKHByb3BlcnR5KSB7CiAgICAgIHJldHVybiB0aGlzLl9zdHlsZXMuZ2V0QXNTdHJpbmcocHJvcGVydHkpOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGEgbm9ybWFsaXplZCBzdHlsZSBvYmplY3Qgb3Igc2luZ2xlIHN0eWxlIHZhbHVlLgogICAgICoKICAgICAqIEZvciBhbiBlbGVtZW50IHdpdGggc3R5bGUgc2V0IHRvOiBtYXJnaW46MXB4IDJweCAzZW07CiAgICAgKgogICAgICoJCWVsZW1lbnQuZ2V0Tm9ybWFsaXplZFN0eWxlKCAnbWFyZ2luJyApICk7CiAgICAgKgogICAgICogd2lsbCByZXR1cm46CiAgICAgKgogICAgICoJCXsKICAgICAqCQkJdG9wOiAnMXB4JywKICAgICAqCQkJcmlnaHQ6ICcycHgnLAogICAgICoJCQlib3R0b206ICczZW0nLAogICAgICoJCQlsZWZ0OiAnMnB4JyAgICAvLyBhIG5vcm1hbGl6ZWQgdmFsdWUgZnJvbSBtYXJnaW4gc2hvcnRoYW5kCiAgICAgKgkJfQogICAgICoKICAgICAqIGFuZCByZWFkaW5nIGZvciBzaW5nbGUgc3R5bGUgdmFsdWU6CiAgICAgKgogICAgICoJCXN0eWxlcy5nZXROb3JtYWxpemVkU3R5bGUoICdtYXJnaW4tbGVmdCcgKTsKICAgICAqCiAgICAgKiBXaWxsIHJldHVybiBhIGAycHhgIHN0cmluZy4KICAgICAqCiAgICAgKiAqKk5vdGUqKjogVGhpcyBtZXRob2Qgd2lsbCByZXR1cm4gbm9ybWFsaXplZCB2YWx1ZXMgb25seSBpZgogICAgICoge0BsaW5rIG1vZHVsZTplbmdpbmUvY29udHJvbGxlci9kYXRhY29udHJvbGxlcn5EYXRhQ29udHJvbGxlciNhZGRTdHlsZVByb2Nlc3NvclJ1bGVzIGEgcGFydGljdWxhciBzdHlsZSBwcm9jZXNzb3IgcnVsZSBpcyBlbmFibGVkfS4KICAgICAqIFNlZSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3N0eWxlc21hcH5TdHlsZXNNYXAjZ2V0Tm9ybWFsaXplZCBgU3R5bGVzTWFwI2dldE5vcm1hbGl6ZWQoKWB9IGZvciBkZXRhaWxzLgogICAgICoKICAgICAqCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvcGVydHkgTmFtZSBvZiBDU1MgcHJvcGVydHkKICAgICAqIEByZXR1cm5zIHtPYmplY3R8U3RyaW5nfHVuZGVmaW5lZH0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXROb3JtYWxpemVkU3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE5vcm1hbGl6ZWRTdHlsZShwcm9wZXJ0eSkgewogICAgICByZXR1cm4gdGhpcy5fc3R5bGVzLmdldE5vcm1hbGl6ZWQocHJvcGVydHkpOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGl0ZXJhdG9yIHRoYXQgY29udGFpbnMgYWxsIHN0eWxlIG5hbWVzLgogICAgICoKICAgICAqIEByZXR1cm5zIHtJdGVyYWJsZS48U3RyaW5nPn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRTdHlsZU5hbWVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTdHlsZU5hbWVzKCkgewogICAgICByZXR1cm4gdGhpcy5fc3R5bGVzLmdldFN0eWxlTmFtZXMoKTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyB0cnVlIGlmIHN0eWxlIGtleXMgYXJlIHByZXNlbnQuCiAgICAgKiBJZiBtb3JlIHRoZW4gb25lIHN0eWxlIHByb3BlcnR5IGlzIHByb3ZpZGVkIC0gcmV0dXJucyB0cnVlIG9ubHkgd2hlbiBhbGwgcHJvcGVydGllcyBhcmUgcHJlc2VudC4KICAgICAqCiAgICAgKgkJZWxlbWVudC5oYXNTdHlsZSggJ2NvbG9yJyApOyAvLyBSZXR1cm5zIHRydWUgaWYgJ2JvcmRlci10b3AnIHN0eWxlIGlzIHByZXNlbnQuCiAgICAgKgkJZWxlbWVudC5oYXNTdHlsZSggJ2NvbG9yJywgJ2JvcmRlci10b3AnICk7IC8vIFJldHVybnMgdHJ1ZSBpZiAnY29sb3InIGFuZCAnYm9yZGVyLXRvcCcgc3R5bGVzIGFyZSBib3RoIHByZXNlbnQuCiAgICAgKgogICAgICogQHBhcmFtIHsuLi5TdHJpbmd9IHByb3BlcnR5CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaGFzU3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhc1N0eWxlKCkgewogICAgICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIHByb3BlcnR5ID0gbmV3IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7CiAgICAgICAgcHJvcGVydHlbX2tleTJdID0gYXJndW1lbnRzW19rZXkyXTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgX2kyID0gMCwgX3Byb3BlcnR5ID0gcHJvcGVydHk7IF9pMiA8IF9wcm9wZXJ0eS5sZW5ndGg7IF9pMisrKSB7CiAgICAgICAgdmFyIG5hbWUgPSBfcHJvcGVydHlbX2kyXTsKCiAgICAgICAgaWYgKCF0aGlzLl9zdHlsZXMuaGFzKG5hbWUpKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBhbmNlc3RvciBlbGVtZW50IHRoYXQgbWF0Y2ggc3BlY2lmaWVkIHBhdHRlcm4uCiAgICAgKiBQcm92aWRlZCBwYXR0ZXJucyBzaG91bGQgYmUgY29tcGF0aWJsZSB3aXRoIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvbWF0Y2hlcn5NYXRjaGVyIE1hdGNoZXJ9IGFzIGl0IGlzIHVzZWQgaW50ZXJuYWxseS4KICAgICAqCiAgICAgKiBAc2VlIG1vZHVsZTplbmdpbmUvdmlldy9tYXRjaGVyfk1hdGNoZXIKICAgICAqIEBwYXJhbSB7T2JqZWN0fFN0cmluZ3xSZWdFeHB8RnVuY3Rpb259IHBhdHRlcm5zIFBhdHRlcm5zIHVzZWQgdG8gbWF0Y2ggY29ycmVjdCBhbmNlc3Rvci4KICAgICAqIFNlZSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L21hdGNoZXJ+TWF0Y2hlcn0uCiAgICAgKiBAcmV0dXJucyB7bW9kdWxlOmVuZ2luZS92aWV3L2VsZW1lbnR+RWxlbWVudHxudWxsfSBGb3VuZCBlbGVtZW50IG9yIGBudWxsYCBpZiBubyBtYXRjaGluZyBhbmNlc3RvciB3YXMgZm91bmQuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZmluZEFuY2VzdG9yIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kQW5jZXN0b3IoKSB7CiAgICAgIGZvciAodmFyIF9sZW4zID0gYXJndW1lbnRzLmxlbmd0aCwgcGF0dGVybnMgPSBuZXcgQXJyYXkoX2xlbjMpLCBfa2V5MyA9IDA7IF9rZXkzIDwgX2xlbjM7IF9rZXkzKyspIHsKICAgICAgICBwYXR0ZXJuc1tfa2V5M10gPSBhcmd1bWVudHNbX2tleTNdOwogICAgICB9CgogICAgICB2YXIgbWF0Y2hlciA9IF9jb25zdHJ1Y3QoTWF0Y2hlciwgcGF0dGVybnMpOwoKICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50OwoKICAgICAgd2hpbGUgKHBhcmVudCkgewogICAgICAgIGlmIChtYXRjaGVyLm1hdGNoKHBhcmVudCkpIHsKICAgICAgICAgIHJldHVybiBwYXJlbnQ7CiAgICAgICAgfQoKICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50OwogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgY3VzdG9tIHByb3BlcnR5IHZhbHVlIGZvciB0aGUgZ2l2ZW4ga2V5LgogICAgICoKICAgICAqIEBwYXJhbSB7U3RyaW5nfFN5bWJvbH0ga2V5CiAgICAgKiBAcmV0dXJucyB7Kn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRDdXN0b21Qcm9wZXJ0eSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q3VzdG9tUHJvcGVydHkoa2V5KSB7CiAgICAgIHJldHVybiB0aGlzLl9jdXN0b21Qcm9wZXJ0aWVzLmdldChrZXkpOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFuIGl0ZXJhdG9yIHdoaWNoIGl0ZXJhdGVzIG92ZXIgdGhpcyBlbGVtZW50J3MgY3VzdG9tIHByb3BlcnRpZXMuCiAgICAgKiBJdGVyYXRvciBwcm92aWRlcyBgWyBrZXksIHZhbHVlIF1gIHBhaXJzIGZvciBlYWNoIHN0b3JlZCBwcm9wZXJ0eS4KICAgICAqCiAgICAgKiBAcmV0dXJucyB7SXRlcmFibGUuPCo+fQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldEN1c3RvbVByb3BlcnRpZXMiLAogICAgdmFsdWU6CiAgICAvKiNfX1BVUkVfXyovCiAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBnZXRDdXN0b21Qcm9wZXJ0aWVzKCkgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gZ2V0Q3VzdG9tUHJvcGVydGllcyQoX2NvbnRleHQzKSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5kZWxlZ2F0ZVlpZWxkKHRoaXMuX2N1c3RvbVByb3BlcnRpZXMuZW50cmllcygpLCAidDAiLCAxKTsKCiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIGdldEN1c3RvbVByb3BlcnRpZXMsIHRoaXMpOwogICAgfSkKICAgIC8qKgogICAgICogUmV0dXJucyBpZGVudGl0eSBzdHJpbmcgYmFzZWQgb24gZWxlbWVudCdzIG5hbWUsIHN0eWxlcywgY2xhc3NlcyBhbmQgb3RoZXIgYXR0cmlidXRlcy4KICAgICAqIFR3byBlbGVtZW50cyB0aGF0IHtAbGluayAjaXNTaW1pbGFyIGFyZSBzaW1pbGFyfSB3aWxsIGhhdmUgc2FtZSBpZGVudGl0eSBzdHJpbmcuCiAgICAgKiBJdCBoYXMgdGhlIGZvbGxvd2luZyBmb3JtYXQ6CiAgICAgKgogICAgICoJCSduYW1lIGNsYXNzPSJjbGFzczEsY2xhc3MyIiBzdHlsZT0ic3R5bGUxOnZhbHVlMTtzdHlsZTI6dmFsdWUyIiBhdHRyMT0idmFsMSIgYXR0cjI9InZhbDIiJwogICAgCSAqCiAgICAgKiBGb3IgZXhhbXBsZToKICAgICAqCiAgICAgKgkJY29uc3QgZWxlbWVudCA9IHdyaXRlci5jcmVhdGVDb250YWluZXJFbGVtZW50KCAnZm9vJywgewogICAgICoJCQliYW5hbmE6ICcxMCcsCiAgICAgKgkJCWFwcGxlOiAnMjAnLAogICAgICoJCQlzdHlsZTogJ2NvbG9yOiByZWQ7IGJvcmRlci1jb2xvcjogd2hpdGU7JywKICAgICAqCQkJY2xhc3M6ICdiYXonCiAgICAgKgkJfSApOwogICAgICoKICAgICAqCQkvLyByZXR1cm5zICdmb28gY2xhc3M9ImJheiIgc3R5bGU9ImJvcmRlci1jb2xvcjp3aGl0ZTtjb2xvcjpyZWQiIGFwcGxlPSIyMCIgYmFuYW5hPSIxMCInCiAgICAgKgkJZWxlbWVudC5nZXRJZGVudGl0eSgpOwogICAgICoKICAgICAqICoqTm90ZSoqOiBDbGFzc2VzLCBzdHlsZXMgYW5kIG90aGVyIGF0dHJpYnV0ZXMgYXJlIHNvcnRlZCBhbHBoYWJldGljYWxseS4KICAgICAqCiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldElkZW50aXR5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRJZGVudGl0eSgpIHsKICAgICAgdmFyIGNsYXNzZXMgPSBBcnJheS5mcm9tKHRoaXMuX2NsYXNzZXMpLnNvcnQoKS5qb2luKCcsJyk7CgogICAgICB2YXIgc3R5bGVzID0gdGhpcy5fc3R5bGVzLnRvU3RyaW5nKCk7CgogICAgICB2YXIgYXR0cmlidXRlcyA9IEFycmF5LmZyb20odGhpcy5fYXR0cnMpLm1hcChmdW5jdGlvbiAoaSkgewogICAgICAgIHJldHVybiAiIi5jb25jYXQoaVswXSwgIj1cIiIpLmNvbmNhdChpWzFdLCAiXCIiKTsKICAgICAgfSkuc29ydCgpLmpvaW4oJyAnKTsKICAgICAgcmV0dXJuIHRoaXMubmFtZSArIChjbGFzc2VzID09ICcnID8gJycgOiAiIGNsYXNzPVwiIi5jb25jYXQoY2xhc3NlcywgIlwiIikpICsgKCFzdHlsZXMgPyAnJyA6ICIgc3R5bGU9XCIiLmNvbmNhdChzdHlsZXMsICJcIiIpKSArIChhdHRyaWJ1dGVzID09ICcnID8gJycgOiAiICIuY29uY2F0KGF0dHJpYnV0ZXMpKTsKICAgIH0KICAgIC8qKgogICAgICogQ2xvbmVzIHByb3ZpZGVkIGVsZW1lbnQuCiAgICAgKgogICAgICogQHByb3RlY3RlZAogICAgICogQHBhcmFtIHtCb29sZWFufSBbZGVlcD1mYWxzZV0gSWYgc2V0IHRvIGB0cnVlYCBjbG9uZXMgZWxlbWVudCBhbmQgYWxsIGl0cyBjaGlsZHJlbiByZWN1cnNpdmVseS4gV2hlbiBzZXQgdG8gYGZhbHNlYCwKICAgICAqIGVsZW1lbnQgd2lsbCBiZSBjbG9uZWQgd2l0aG91dCBhbnkgY2hpbGRyZW4uCiAgICAgKiBAcmV0dXJucyB7bW9kdWxlOmVuZ2luZS92aWV3L2VsZW1lbnR+RWxlbWVudH0gQ2xvbmUgb2YgdGhpcyBlbGVtZW50LgogICAgICovCgogIH0sIHsKICAgIGtleTogIl9jbG9uZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2Nsb25lKCkgewogICAgICB2YXIgZGVlcCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7CiAgICAgIHZhciBjaGlsZHJlbkNsb25lID0gW107CgogICAgICBpZiAoZGVlcCkgewogICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCA9IHRydWU7CiAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yNCA9IGZhbHNlOwogICAgICAgIHZhciBfaXRlcmF0b3JFcnJvcjQgPSB1bmRlZmluZWQ7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3I0ID0gdGhpcy5nZXRDaGlsZHJlbigpW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA0OyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb240ID0gKF9zdGVwNCA9IF9pdGVyYXRvcjQubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjQgPSB0cnVlKSB7CiAgICAgICAgICAgIHZhciBjaGlsZCA9IF9zdGVwNC52YWx1ZTsKICAgICAgICAgICAgY2hpbGRyZW5DbG9uZS5wdXNoKGNoaWxkLl9jbG9uZShkZWVwKSk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjQgPSB0cnVlOwogICAgICAgICAgX2l0ZXJhdG9yRXJyb3I0ID0gZXJyOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb240ICYmIF9pdGVyYXRvcjQucmV0dXJuICE9IG51bGwpIHsKICAgICAgICAgICAgICBfaXRlcmF0b3I0LnJldHVybigpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3I0KSB7CiAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I0OwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIENvbnRhaW5lckVsZW1lbnQgYW5kIEF0dHJpYnV0ZUVsZW1lbnQgc2hvdWxkIGJlIGFsc28gY2xvbmVkIHByb3Blcmx5LgoKCiAgICAgIHZhciBjbG9uZWQgPSBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLmRvY3VtZW50LCB0aGlzLm5hbWUsIHRoaXMuX2F0dHJzLCBjaGlsZHJlbkNsb25lKTsgLy8gQ2xhc3NlcyBhbmQgc3R5bGVzIGFyZSBjbG9uZWQgc2VwYXJhdGVseSAtIHRoaXMgc29sdXRpb24gaXMgZmFzdGVyIHRoYW4gYWRkaW5nIHRoZW0gYmFjayB0byBhdHRyaWJ1dGVzIGFuZAogICAgICAvLyBwYXJzZSBvbmNlIGFnYWluIGluIGNvbnN0cnVjdG9yLgoKICAgICAgY2xvbmVkLl9jbGFzc2VzID0gbmV3IFNldCh0aGlzLl9jbGFzc2VzKTsKCiAgICAgIGNsb25lZC5fc3R5bGVzLnNldCh0aGlzLl9zdHlsZXMuZ2V0Tm9ybWFsaXplZCgpKTsgLy8gQ2xvbmUgY3VzdG9tIHByb3BlcnRpZXMuCgoKICAgICAgY2xvbmVkLl9jdXN0b21Qcm9wZXJ0aWVzID0gbmV3IE1hcCh0aGlzLl9jdXN0b21Qcm9wZXJ0aWVzKTsgLy8gQ2xvbmUgZmlsbGVyIG9mZnNldCBtZXRob2QuCiAgICAgIC8vIFdlIGNhbid0IGRlZmluZSB0aGlzIG1ldGhvZCBpbiBhIHByb3RvdHlwZSBiZWNhdXNlIGl0J3MgYmVoYXZpb3Igd2hpY2gKICAgICAgLy8gaXMgY2hhbmdlZCBieSBlLmcuIHRvV2lkZ2V0KCkgZnVuY3Rpb24gZnJvbSBja2VkaXRvcjUtd2lkZ2V0LiBQZXJoYXBzIHRoaXMgc2hvdWxkIGJlIG9uZSBvZiBjdXN0b20gcHJvcHMuCgogICAgICBjbG9uZWQuZ2V0RmlsbGVyT2Zmc2V0ID0gdGhpcy5nZXRGaWxsZXJPZmZzZXQ7CiAgICAgIHJldHVybiBjbG9uZWQ7CiAgICB9CiAgICAvKioKICAgICAqIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50I19pbnNlcnRDaGlsZCBJbnNlcnR9IGEgY2hpbGQgbm9kZSBvciBhIGxpc3Qgb2YgY2hpbGQgbm9kZXMgYXQgdGhlIGVuZCBvZiB0aGlzIG5vZGUKICAgICAqIGFuZCBzZXRzIHRoZSBwYXJlbnQgb2YgdGhlc2Ugbm9kZXMgdG8gdGhpcyBlbGVtZW50LgogICAgICoKICAgICAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyI2luc2VydAogICAgICogQHByb3RlY3RlZAogICAgICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvaXRlbX5JdGVtfEl0ZXJhYmxlLjxtb2R1bGU6ZW5naW5lL3ZpZXcvaXRlbX5JdGVtPn0gaXRlbXMgSXRlbXMgdG8gYmUgaW5zZXJ0ZWQuCiAgICAgKiBAZmlyZXMgbW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZSNjaGFuZ2UKICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IE51bWJlciBvZiBhcHBlbmRlZCBub2Rlcy4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfYXBwZW5kQ2hpbGQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hcHBlbmRDaGlsZChpdGVtcykgewogICAgICByZXR1cm4gdGhpcy5faW5zZXJ0Q2hpbGQodGhpcy5jaGlsZENvdW50LCBpdGVtcyk7CiAgICB9CiAgICAvKioKICAgICAqIEluc2VydHMgYSBjaGlsZCBub2RlIG9yIGEgbGlzdCBvZiBjaGlsZCBub2RlcyBvbiB0aGUgZ2l2ZW4gaW5kZXggYW5kIHNldHMgdGhlIHBhcmVudCBvZiB0aGVzZSBub2RlcyB0bwogICAgICogdGhpcyBlbGVtZW50LgogICAgICoKICAgICAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyI2luc2VydAogICAgICogQHByb3RlY3RlZAogICAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4IFBvc2l0aW9uIHdoZXJlIG5vZGVzIHNob3VsZCBiZSBpbnNlcnRlZC4KICAgICAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L2l0ZW1+SXRlbXxJdGVyYWJsZS48bW9kdWxlOmVuZ2luZS92aWV3L2l0ZW1+SXRlbT59IGl0ZW1zIEl0ZW1zIHRvIGJlIGluc2VydGVkLgogICAgICogQGZpcmVzIG1vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGUjY2hhbmdlCiAgICAgKiBAcmV0dXJucyB7TnVtYmVyfSBOdW1iZXIgb2YgaW5zZXJ0ZWQgbm9kZXMuCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX2luc2VydENoaWxkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfaW5zZXJ0Q2hpbGQoaW5kZXgsIGl0ZW1zKSB7CiAgICAgIHRoaXMuX2ZpcmVDaGFuZ2UoJ2NoaWxkcmVuJywgdGhpcyk7CgogICAgICB2YXIgY291bnQgPSAwOwogICAgICB2YXIgbm9kZXMgPSBub3JtYWxpemUodGhpcy5kb2N1bWVudCwgaXRlbXMpOwogICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjUgPSB0cnVlOwogICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3I1ID0gZmFsc2U7CiAgICAgIHZhciBfaXRlcmF0b3JFcnJvcjUgPSB1bmRlZmluZWQ7CgogICAgICB0cnkgewogICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjUgPSBub2Rlc1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwNTsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNSA9IChfc3RlcDUgPSBfaXRlcmF0b3I1Lm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb241ID0gdHJ1ZSkgewogICAgICAgICAgdmFyIG5vZGUgPSBfc3RlcDUudmFsdWU7CgogICAgICAgICAgLy8gSWYgbm9kZSB0aGF0IGlzIGJlaW5nIGFkZGVkIHRvIHRoaXMgZWxlbWVudCBpcyBhbHJlYWR5IGluc2lkZSBhbm90aGVyIGVsZW1lbnQsIGZpcnN0IHJlbW92ZSBpdCBmcm9tIHRoZSBvbGQgcGFyZW50LgogICAgICAgICAgaWYgKG5vZGUucGFyZW50ICE9PSBudWxsKSB7CiAgICAgICAgICAgIG5vZGUuX3JlbW92ZSgpOwogICAgICAgICAgfQoKICAgICAgICAgIG5vZGUucGFyZW50ID0gdGhpczsKICAgICAgICAgIG5vZGUuZG9jdW1lbnQgPSB0aGlzLmRvY3VtZW50OwoKICAgICAgICAgIHRoaXMuX2NoaWxkcmVuLnNwbGljZShpbmRleCwgMCwgbm9kZSk7CgogICAgICAgICAgaW5kZXgrKzsKICAgICAgICAgIGNvdW50Kys7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjUgPSB0cnVlOwogICAgICAgIF9pdGVyYXRvckVycm9yNSA9IGVycjsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNSAmJiBfaXRlcmF0b3I1LnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjUucmV0dXJuKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjUpIHsKICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I1OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGNvdW50OwogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmVzIG51bWJlciBvZiBjaGlsZCBub2RlcyBzdGFydGluZyBhdCB0aGUgZ2l2ZW4gaW5kZXggYW5kIHNldCB0aGUgcGFyZW50IG9mIHRoZXNlIG5vZGVzIHRvIGBudWxsYC4KICAgICAqCiAgICAgKiBAc2VlIG1vZHVsZTplbmdpbmUvdmlldy9kb3duY2FzdHdyaXRlcn5Eb3duY2FzdFdyaXRlciNyZW1vdmUKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleCBOdW1iZXIgb2YgdGhlIGZpcnN0IG5vZGUgdG8gcmVtb3ZlLgogICAgICogQHBhcmFtIHtOdW1iZXJ9IFtob3dNYW55PTFdIE51bWJlciBvZiBub2RlcyB0byByZW1vdmUuCiAgICAgKiBAZmlyZXMgbW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZSNjaGFuZ2UKICAgICAqIEByZXR1cm5zIHtBcnJheS48bW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZT59IFRoZSBhcnJheSBvZiByZW1vdmVkIG5vZGVzLgogICAgICovCgogIH0sIHsKICAgIGtleTogIl9yZW1vdmVDaGlsZHJlbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbW92ZUNoaWxkcmVuKGluZGV4KSB7CiAgICAgIHZhciBob3dNYW55ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAxOwoKICAgICAgdGhpcy5fZmlyZUNoYW5nZSgnY2hpbGRyZW4nLCB0aGlzKTsKCiAgICAgIGZvciAodmFyIGkgPSBpbmRleDsgaSA8IGluZGV4ICsgaG93TWFueTsgaSsrKSB7CiAgICAgICAgdGhpcy5fY2hpbGRyZW5baV0ucGFyZW50ID0gbnVsbDsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuLnNwbGljZShpbmRleCwgaG93TWFueSk7CiAgICB9CiAgICAvKioKICAgICAqIEFkZHMgb3Igb3ZlcndyaXRlIGF0dHJpYnV0ZSB3aXRoIGEgc3BlY2lmaWVkIGtleSBhbmQgdmFsdWUuCiAgICAgKgogICAgICogQHNlZSBtb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXIjc2V0QXR0cmlidXRlCiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAcGFyYW0ge1N0cmluZ30ga2V5IEF0dHJpYnV0ZSBrZXkuCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWUgQXR0cmlidXRlIHZhbHVlLgogICAgICogQGZpcmVzIG1vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGUjY2hhbmdlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3NldEF0dHJpYnV0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NldEF0dHJpYnV0ZShrZXksIHZhbHVlKSB7CiAgICAgIHZhbHVlID0gU3RyaW5nKHZhbHVlKTsKCiAgICAgIHRoaXMuX2ZpcmVDaGFuZ2UoJ2F0dHJpYnV0ZXMnLCB0aGlzKTsKCiAgICAgIGlmIChrZXkgPT0gJ2NsYXNzJykgewogICAgICAgIHBhcnNlQ2xhc3Nlcyh0aGlzLl9jbGFzc2VzLCB2YWx1ZSk7CiAgICAgIH0gZWxzZSBpZiAoa2V5ID09ICdzdHlsZScpIHsKICAgICAgICB0aGlzLl9zdHlsZXMuc2V0VG8odmFsdWUpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuX2F0dHJzLnNldChrZXksIHZhbHVlKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmVzIGF0dHJpYnV0ZSBmcm9tIHRoZSBlbGVtZW50LgogICAgICoKICAgICAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyI3JlbW92ZUF0dHJpYnV0ZQogICAgICogQHByb3RlY3RlZAogICAgICogQHBhcmFtIHtTdHJpbmd9IGtleSBBdHRyaWJ1dGUga2V5LgogICAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiBhbiBhdHRyaWJ1dGUgZXhpc3RlZCBhbmQgaGFzIGJlZW4gcmVtb3ZlZC4KICAgICAqIEBmaXJlcyBtb2R1bGU6ZW5naW5lL3ZpZXcvbm9kZX5Ob2RlI2NoYW5nZQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9yZW1vdmVBdHRyaWJ1dGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZW1vdmVBdHRyaWJ1dGUoa2V5KSB7CiAgICAgIHRoaXMuX2ZpcmVDaGFuZ2UoJ2F0dHJpYnV0ZXMnLCB0aGlzKTsgLy8gUmVtb3ZlIGNsYXNzIGF0dHJpYnV0ZS4KCgogICAgICBpZiAoa2V5ID09ICdjbGFzcycpIHsKICAgICAgICBpZiAodGhpcy5fY2xhc3Nlcy5zaXplID4gMCkgewogICAgICAgICAgdGhpcy5fY2xhc3Nlcy5jbGVhcigpOwoKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8vIFJlbW92ZSBzdHlsZSBhdHRyaWJ1dGUuCgoKICAgICAgaWYgKGtleSA9PSAnc3R5bGUnKSB7CiAgICAgICAgaWYgKCF0aGlzLl9zdHlsZXMuaXNFbXB0eSkgewogICAgICAgICAgdGhpcy5fc3R5bGVzLmNsZWFyKCk7CgogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy8gUmVtb3ZlIG90aGVyIGF0dHJpYnV0ZXMuCgoKICAgICAgcmV0dXJuIHRoaXMuX2F0dHJzLmRlbGV0ZShrZXkpOwogICAgfQogICAgLyoqCiAgICAgKiBBZGRzIHNwZWNpZmllZCBjbGFzcy4KICAgICAqCiAgICAgKgkJZWxlbWVudC5fYWRkQ2xhc3MoICdmb28nICk7IC8vIEFkZHMgJ2ZvbycgY2xhc3MuCiAgICAgKgkJZWxlbWVudC5fYWRkQ2xhc3MoIFsgJ2ZvbycsICdiYXInIF0gKTsgLy8gQWRkcyAnZm9vJyBhbmQgJ2JhcicgY2xhc3Nlcy4KICAgICAqCiAgICAgKiBAc2VlIG1vZHVsZTplbmdpbmUvdmlldy9kb3duY2FzdHdyaXRlcn5Eb3duY2FzdFdyaXRlciNhZGRDbGFzcwogICAgICogQHByb3RlY3RlZAogICAgICogQHBhcmFtIHtBcnJheS48U3RyaW5nPnxTdHJpbmd9IGNsYXNzTmFtZQogICAgICogQGZpcmVzIG1vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGUjY2hhbmdlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX2FkZENsYXNzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfYWRkQ2xhc3MoY2xhc3NOYW1lKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy5fZmlyZUNoYW5nZSgnYXR0cmlidXRlcycsIHRoaXMpOwoKICAgICAgY2xhc3NOYW1lID0gQXJyYXkuaXNBcnJheShjbGFzc05hbWUpID8gY2xhc3NOYW1lIDogW2NsYXNzTmFtZV07CiAgICAgIGNsYXNzTmFtZS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi5fY2xhc3Nlcy5hZGQobmFtZSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmVzIHNwZWNpZmllZCBjbGFzcy4KICAgICAqCiAgICAgKgkJZWxlbWVudC5fcmVtb3ZlQ2xhc3MoICdmb28nICk7ICAvLyBSZW1vdmVzICdmb28nIGNsYXNzLgogICAgICoJCWVsZW1lbnQuX3JlbW92ZUNsYXNzKCBbICdmb28nLCAnYmFyJyBdICk7IC8vIFJlbW92ZXMgYm90aCAnZm9vJyBhbmQgJ2JhcicgY2xhc3Nlcy4KICAgICAqCiAgICAgKiBAc2VlIG1vZHVsZTplbmdpbmUvdmlldy9kb3duY2FzdHdyaXRlcn5Eb3duY2FzdFdyaXRlciNyZW1vdmVDbGFzcwogICAgICogQHByb3RlY3RlZAogICAgICogQHBhcmFtIHtBcnJheS48U3RyaW5nPnxTdHJpbmd9IGNsYXNzTmFtZQogICAgICogQGZpcmVzIG1vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGUjY2hhbmdlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3JlbW92ZUNsYXNzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVtb3ZlQ2xhc3MoY2xhc3NOYW1lKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdGhpcy5fZmlyZUNoYW5nZSgnYXR0cmlidXRlcycsIHRoaXMpOwoKICAgICAgY2xhc3NOYW1lID0gQXJyYXkuaXNBcnJheShjbGFzc05hbWUpID8gY2xhc3NOYW1lIDogW2NsYXNzTmFtZV07CiAgICAgIGNsYXNzTmFtZS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5fY2xhc3Nlcy5kZWxldGUobmFtZSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqCiAgICAgKiBBZGRzIHN0eWxlIHRvIHRoZSBlbGVtZW50LgogICAgICoKICAgICAqCQllbGVtZW50Ll9zZXRTdHlsZSggJ2NvbG9yJywgJ3JlZCcgKTsKICAgICAqCQllbGVtZW50Ll9zZXRTdHlsZSggewogICAgICoJCQljb2xvcjogJ3JlZCcsCiAgICAgKgkJCXBvc2l0aW9uOiAnZml4ZWQnCiAgICAgKgkJfSApOwogICAgICoKICAgICAqICoqTm90ZSoqOiBUaGlzIG1ldGhvZCBjYW4gd29yayB3aXRoIG5vcm1hbGl6ZWQgc3R5bGUgbmFtZXMgaWYKICAgICAqIHtAbGluayBtb2R1bGU6ZW5naW5lL2NvbnRyb2xsZXIvZGF0YWNvbnRyb2xsZXJ+RGF0YUNvbnRyb2xsZXIjYWRkU3R5bGVQcm9jZXNzb3JSdWxlcyBhIHBhcnRpY3VsYXIgc3R5bGUgcHJvY2Vzc29yIHJ1bGUgaXMgZW5hYmxlZH0uCiAgICAgKiBTZWUge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9zdHlsZXNtYXB+U3R5bGVzTWFwI3NldCBgU3R5bGVzTWFwI3NldCgpYH0gZm9yIGRldGFpbHMuCiAgICAgKgogICAgICogQHNlZSBtb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXIjc2V0U3R5bGUKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEBwYXJhbSB7U3RyaW5nfE9iamVjdH0gcHJvcGVydHkgUHJvcGVydHkgbmFtZSBvciBvYmplY3Qgd2l0aCBrZXkgLSB2YWx1ZSBwYWlycy4KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbdmFsdWVdIFZhbHVlIHRvIHNldC4gVGhpcyBwYXJhbWV0ZXIgaXMgaWdub3JlZCBpZiBvYmplY3QgaXMgcHJvdmlkZWQgYXMgdGhlIGZpcnN0IHBhcmFtZXRlci4KICAgICAqIEBmaXJlcyBtb2R1bGU6ZW5naW5lL3ZpZXcvbm9kZX5Ob2RlI2NoYW5nZQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9zZXRTdHlsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NldFN0eWxlKHByb3BlcnR5LCB2YWx1ZSkgewogICAgICB0aGlzLl9maXJlQ2hhbmdlKCdhdHRyaWJ1dGVzJywgdGhpcyk7CgogICAgICB0aGlzLl9zdHlsZXMuc2V0KHByb3BlcnR5LCB2YWx1ZSk7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZXMgc3BlY2lmaWVkIHN0eWxlLgogICAgICoKICAgICAqCQllbGVtZW50Ll9yZW1vdmVTdHlsZSggJ2NvbG9yJyApOyAgLy8gUmVtb3ZlcyAnY29sb3InIHN0eWxlLgogICAgICoJCWVsZW1lbnQuX3JlbW92ZVN0eWxlKCBbICdjb2xvcicsICdib3JkZXItdG9wJyBdICk7IC8vIFJlbW92ZXMgYm90aCAnY29sb3InIGFuZCAnYm9yZGVyLXRvcCcgc3R5bGVzLgogICAgICoKICAgICAqICoqTm90ZSoqOiBUaGlzIG1ldGhvZCBjYW4gd29yayB3aXRoIG5vcm1hbGl6ZWQgc3R5bGUgbmFtZXMgaWYKICAgICAqIHtAbGluayBtb2R1bGU6ZW5naW5lL2NvbnRyb2xsZXIvZGF0YWNvbnRyb2xsZXJ+RGF0YUNvbnRyb2xsZXIjYWRkU3R5bGVQcm9jZXNzb3JSdWxlcyBhIHBhcnRpY3VsYXIgc3R5bGUgcHJvY2Vzc29yIHJ1bGUgaXMgZW5hYmxlZH0uCiAgICAgKiBTZWUge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9zdHlsZXNtYXB+U3R5bGVzTWFwI3JlbW92ZSBgU3R5bGVzTWFwI3JlbW92ZSgpYH0gZm9yIGRldGFpbHMuCiAgICAgKgogICAgICogQHNlZSBtb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXIjcmVtb3ZlU3R5bGUKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEBwYXJhbSB7QXJyYXkuPFN0cmluZz58U3RyaW5nfSBwcm9wZXJ0eQogICAgICogQGZpcmVzIG1vZHVsZTplbmdpbmUvdmlldy9ub2Rlfk5vZGUjY2hhbmdlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3JlbW92ZVN0eWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVtb3ZlU3R5bGUocHJvcGVydHkpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB0aGlzLl9maXJlQ2hhbmdlKCdhdHRyaWJ1dGVzJywgdGhpcyk7CgogICAgICBwcm9wZXJ0eSA9IEFycmF5LmlzQXJyYXkocHJvcGVydHkpID8gcHJvcGVydHkgOiBbcHJvcGVydHldOwogICAgICBwcm9wZXJ0eS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNC5fc3R5bGVzLnJlbW92ZShuYW1lKTsKICAgICAgfSk7CiAgICB9CiAgICAvKioKICAgICAqIFNldHMgYSBjdXN0b20gcHJvcGVydHkuIFVubGlrZSBhdHRyaWJ1dGVzLCBjdXN0b20gcHJvcGVydGllcyBhcmUgbm90IHJlbmRlcmVkIHRvIHRoZSBET00sCiAgICAgKiBzbyB0aGV5IGNhbiBiZSB1c2VkIHRvIGFkZCBzcGVjaWFsIGRhdGEgdG8gZWxlbWVudHMuCiAgICAgKgogICAgICogQHNlZSBtb2R1bGU6ZW5naW5lL3ZpZXcvZG93bmNhc3R3cml0ZXJ+RG93bmNhc3RXcml0ZXIjc2V0Q3VzdG9tUHJvcGVydHkKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEBwYXJhbSB7U3RyaW5nfFN5bWJvbH0ga2V5CiAgICAgKiBAcGFyYW0geyp9IHZhbHVlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3NldEN1c3RvbVByb3BlcnR5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0Q3VzdG9tUHJvcGVydHkoa2V5LCB2YWx1ZSkgewogICAgICB0aGlzLl9jdXN0b21Qcm9wZXJ0aWVzLnNldChrZXksIHZhbHVlKTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlcyB0aGUgY3VzdG9tIHByb3BlcnR5IHN0b3JlZCB1bmRlciB0aGUgZ2l2ZW4ga2V5LgogICAgICoKICAgICAqIEBzZWUgbW9kdWxlOmVuZ2luZS92aWV3L2Rvd25jYXN0d3JpdGVyfkRvd25jYXN0V3JpdGVyI3JlbW92ZUN1c3RvbVByb3BlcnR5CiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAcGFyYW0ge1N0cmluZ3xTeW1ib2x9IGtleQogICAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgdHJ1ZSBpZiBwcm9wZXJ0eSB3YXMgcmVtb3ZlZC4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfcmVtb3ZlQ3VzdG9tUHJvcGVydHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZW1vdmVDdXN0b21Qcm9wZXJ0eShrZXkpIHsKICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbVByb3BlcnRpZXMuZGVsZXRlKGtleSk7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYmxvY2sge0BsaW5rIG1vZHVsZTplbmdpbmUvdmlldy9maWxsZXIgZmlsbGVyfSBvZmZzZXQgb3IgYG51bGxgIGlmIGJsb2NrIGZpbGxlciBpcyBub3QgbmVlZGVkLgogICAgICoKICAgICAqIEBhYnN0cmFjdAogICAgICogQG1ldGhvZCBtb2R1bGU6ZW5naW5lL3ZpZXcvZWxlbWVudH5FbGVtZW50I2dldEZpbGxlck9mZnNldAogICAgICovCiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vIHByaW50VHJlZSggbGV2ZWwgPSAwKSB7CiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vIAlsZXQgc3RyaW5nID0gJyc7CiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vCXN0cmluZyArPSAnXHQnLnJlcGVhdCggbGV2ZWwgKSArIGA8JHsgdGhpcy5uYW1lIH0keyBjb252ZXJ0TWFwVG9UYWdzKCB0aGlzLmdldEF0dHJpYnV0ZXMoKSApIH0+YDsKICAgIC8vIEBpZiBDS19ERUJVR19FTkdJTkUgLy8JZm9yICggY29uc3QgY2hpbGQgb2YgdGhpcy5nZXRDaGlsZHJlbigpICkgewogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLwkJaWYgKCBjaGlsZC5pcyggJ3RleHQnICkgKSB7CiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vCQkJc3RyaW5nICs9ICdcbicgKyAnXHQnLnJlcGVhdCggbGV2ZWwgKyAxICkgKyBjaGlsZC5kYXRhOwogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLwkJfSBlbHNlIHsKICAgIC8vIEBpZiBDS19ERUJVR19FTkdJTkUgLy8JCQlzdHJpbmcgKz0gJ1xuJyArIGNoaWxkLnByaW50VHJlZSggbGV2ZWwgKyAxICk7CiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vCQl9CiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vCX0KICAgIC8vIEBpZiBDS19ERUJVR19FTkdJTkUgLy8JaWYgKCB0aGlzLmNoaWxkQ291bnQgKSB7CiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vCQlzdHJpbmcgKz0gJ1xuJyArICdcdCcucmVwZWF0KCBsZXZlbCApOwogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLwl9CiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vCXN0cmluZyArPSBgPC8keyB0aGlzLm5hbWUgfT5gOwogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLwlyZXR1cm4gc3RyaW5nOwogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLyB9CiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vIGxvZ1RyZWUoKSB7CiAgICAvLyBAaWYgQ0tfREVCVUdfRU5HSU5FIC8vIAljb25zb2xlLmxvZyggdGhpcy5wcmludFRyZWUoKSApOwogICAgLy8gQGlmIENLX0RFQlVHX0VOR0lORSAvLyB9CgogIH0sIHsKICAgIGtleTogImNoaWxkQ291bnQiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbi5sZW5ndGg7CiAgICB9CiAgICAvKioKICAgICAqIElzIGB0cnVlYCBpZiB0aGVyZSBhcmUgbm8gbm9kZXMgaW5zaWRlIHRoaXMgZWxlbWVudCwgYGZhbHNlYCBvdGhlcndpc2UuCiAgICAgKgogICAgICogQHJlYWRvbmx5CiAgICAgKiBAdHlwZSB7Qm9vbGVhbn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJpc0VtcHR5IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW4ubGVuZ3RoID09PSAwOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEVsZW1lbnQ7Cn0oTm9kZSk7IC8vIFBhcnNlcyBhdHRyaWJ1dGVzIHByb3ZpZGVkIHRvIHRoZSBlbGVtZW50IGNvbnN0cnVjdG9yIGJlZm9yZSB0aGV5IGFyZSBhcHBsaWVkIHRvIGFuIGVsZW1lbnQuIElmIGF0dHJpYnV0ZXMgYXJlIHBhc3NlZAovLyBhcyBhbiBvYmplY3QgKGluc3RlYWQgb2YgYEl0ZXJhYmxlYCksIHRoZSBvYmplY3QgaXMgdHJhbnNmb3JtZWQgdG8gdGhlIG1hcC4gQXR0cmlidXRlcyB3aXRoIGBudWxsYCB2YWx1ZSBhcmUgcmVtb3ZlZC4KLy8gQXR0cmlidXRlcyB3aXRoIG5vbi1gU3RyaW5nYCB2YWx1ZSBhcmUgY29udmVydGVkIHRvIGBTdHJpbmdgLgovLwovLyBAcGFyYW0ge09iamVjdHxJdGVyYWJsZX0gYXR0cnMgQXR0cmlidXRlcyB0byBwYXJzZS4KLy8gQHJldHVybnMge01hcH0gUGFyc2VkIGF0dHJpYnV0ZXMuCgoKZXhwb3J0IHsgRWxlbWVudCBhcyBkZWZhdWx0IH07CgpmdW5jdGlvbiBwYXJzZUF0dHJpYnV0ZXMoYXR0cnMpIHsKICBhdHRycyA9IHRvTWFwKGF0dHJzKTsKICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjYgPSB0cnVlOwogIHZhciBfZGlkSXRlcmF0b3JFcnJvcjYgPSBmYWxzZTsKICB2YXIgX2l0ZXJhdG9yRXJyb3I2ID0gdW5kZWZpbmVkOwoKICB0cnkgewogICAgZm9yICh2YXIgX2l0ZXJhdG9yNiA9IGF0dHJzW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA2OyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb242ID0gKF9zdGVwNiA9IF9pdGVyYXRvcjYubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjYgPSB0cnVlKSB7CiAgICAgIHZhciBfc3RlcDYkdmFsdWUgPSBfc2xpY2VkVG9BcnJheShfc3RlcDYudmFsdWUsIDIpLAogICAgICAgICAga2V5ID0gX3N0ZXA2JHZhbHVlWzBdLAogICAgICAgICAgdmFsdWUgPSBfc3RlcDYkdmFsdWVbMV07CgogICAgICBpZiAodmFsdWUgPT09IG51bGwpIHsKICAgICAgICBhdHRycy5kZWxldGUoa2V5KTsKICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIHsKICAgICAgICBhdHRycy5zZXQoa2V5LCBTdHJpbmcodmFsdWUpKTsKICAgICAgfQogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2RpZEl0ZXJhdG9yRXJyb3I2ID0gdHJ1ZTsKICAgIF9pdGVyYXRvckVycm9yNiA9IGVycjsKICB9IGZpbmFsbHkgewogICAgdHJ5IHsKICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNiAmJiBfaXRlcmF0b3I2LnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgX2l0ZXJhdG9yNi5yZXR1cm4oKTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yNikgewogICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yNjsKICAgICAgfQogICAgfQogIH0KCiAgcmV0dXJuIGF0dHJzOwp9IC8vIFBhcnNlcyBjbGFzcyBhdHRyaWJ1dGUgYW5kIHB1dHMgYWxsIGNsYXNzZXMgaW50byBjbGFzc2VzIHNldC4KLy8gQ2xhc3NlcyBzZXQgcyBjbGVhcmVkIGJlZm9yZSBpbnNlcnRpb24uCi8vCi8vIEBwYXJhbSB7U2V0LjxTdHJpbmc+fSBjbGFzc2VzU2V0IFNldCB0byBpbnNlcnQgcGFyc2VkIGNsYXNzZXMuCi8vIEBwYXJhbSB7U3RyaW5nfSBjbGFzc2VzU3RyaW5nIFN0cmluZyB3aXRoIGNsYXNzZXMgdG8gcGFyc2UuCgoKZnVuY3Rpb24gcGFyc2VDbGFzc2VzKGNsYXNzZXNTZXQsIGNsYXNzZXNTdHJpbmcpIHsKICB2YXIgY2xhc3NBcnJheSA9IGNsYXNzZXNTdHJpbmcuc3BsaXQoL1xzKy8pOwogIGNsYXNzZXNTZXQuY2xlYXIoKTsKICBjbGFzc0FycmF5LmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKICAgIHJldHVybiBjbGFzc2VzU2V0LmFkZChuYW1lKTsKICB9KTsKfSAvLyBDb252ZXJ0cyBzdHJpbmdzIHRvIFRleHQgYW5kIG5vbi1pdGVyYWJsZXMgdG8gYXJyYXlzLgovLwovLyBAcGFyYW0ge1N0cmluZ3xtb2R1bGU6ZW5naW5lL3ZpZXcvaXRlbX5JdGVtfEl0ZXJhYmxlLjxTdHJpbmd8bW9kdWxlOmVuZ2luZS92aWV3L2l0ZW1+SXRlbT59Ci8vIEByZXR1cm5zIHtJdGVyYWJsZS48bW9kdWxlOmVuZ2luZS92aWV3L25vZGV+Tm9kZT59CgoKZnVuY3Rpb24gbm9ybWFsaXplKGRvY3VtZW50LCBub2RlcykgewogIC8vIFNlcGFyYXRlIGNvbmRpdGlvbiBiZWNhdXNlIHN0cmluZyBpcyBpdGVyYWJsZS4KICBpZiAodHlwZW9mIG5vZGVzID09ICdzdHJpbmcnKSB7CiAgICByZXR1cm4gW25ldyBUZXh0KGRvY3VtZW50LCBub2RlcyldOwogIH0KCiAgaWYgKCFpc0l0ZXJhYmxlKG5vZGVzKSkgewogICAgbm9kZXMgPSBbbm9kZXNdOwogIH0gLy8gQXJyYXkuZnJvbSB0byBlbmFibGUgLm1hcCgpIG9uIG5vbi1hcnJheXMuCgoKICByZXR1cm4gQXJyYXkuZnJvbShub2RlcykubWFwKGZ1bmN0aW9uIChub2RlKSB7CiAgICBpZiAodHlwZW9mIG5vZGUgPT0gJ3N0cmluZycpIHsKICAgICAgcmV0dXJuIG5ldyBUZXh0KGRvY3VtZW50LCBub2RlKTsKICAgIH0KCiAgICBpZiAobm9kZSBpbnN0YW5jZW9mIFRleHRQcm94eSkgewogICAgICByZXR1cm4gbmV3IFRleHQoZG9jdW1lbnQsIG5vZGUuZGF0YSk7CiAgICB9CgogICAgcmV0dXJuIG5vZGU7CiAgfSk7Cn0="},{"version":3,"sources":["C:/Users/pc/Desktop/Restoran/Restoran/Restoran.UI/client/node_modules/@ckeditor/ckeditor5-engine/src/view/element.js"],"names":["Node","Text","TextProxy","toMap","isIterable","Matcher","StylesMap","Element","document","name","attrs","children","_attrs","parseAttributes","_children","_insertChild","_classes","Set","has","classString","get","parseClasses","delete","_styles","stylesProcessor","setTo","_customProperties","Map","type","cutType","replace","index","node","indexOf","Symbol","iterator","size","isEmpty","keys","entries","getAttribute","key","join","undefined","inlineStyle","toString","otherElement","value","className","getStyleNames","property","getAsString","getNormalized","patterns","matcher","parent","match","classes","Array","from","sort","styles","attributes","map","i","deep","childrenClone","getChildren","child","push","_clone","cloned","constructor","set","getFillerOffset","items","childCount","_fireChange","count","nodes","normalize","_remove","splice","howMany","String","clear","isArray","forEach","add","remove","length","classesSet","classesString","classArray","split","data"],"mappings":"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","sourcesContent":["/**\n * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module engine/view/element\n */\n\nimport Node from './node';\nimport Text from './text';\nimport TextProxy from './textproxy';\nimport toMap from '@ckeditor/ckeditor5-utils/src/tomap';\nimport isIterable from '@ckeditor/ckeditor5-utils/src/isiterable';\nimport Matcher from './matcher';\nimport StylesMap from './stylesmap';\n\n// @if CK_DEBUG_ENGINE // const { convertMapToTags } = require( '../dev-utils/utils' );\n\n/**\n * View element.\n *\n * The editing engine does not define a fixed semantics of its elements (it is \"DTD-free\").\n * This is why the type of the {@link module:engine/view/element~Element} need to\n * be defined by the feature developer. When creating an element you should use one of the following methods:\n *\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createContainerElement `downcastWriter#createContainerElement()`}\n * in order to create a {@link module:engine/view/containerelement~ContainerElement},\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createAttributeElement `downcastWriter#createAttributeElement()`}\n * in order to create a {@link module:engine/view/attributeelement~AttributeElement},\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createEmptyElement `downcastWriter#createEmptyElement()`}\n * in order to create a {@link module:engine/view/emptyelement~EmptyElement}.\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createUIElement `downcastWriter#createUIElement()`}\n * in order to create a {@link module:engine/view/uielement~UIElement}.\n * * {@link module:engine/view/downcastwriter~DowncastWriter#createEditableElement `downcastWriter#createEditableElement()`}\n * in order to create a {@link module:engine/view/editableelement~EditableElement}.\n *\n * Note that for view elements which are not created from the model, like elements from mutations, paste or\n * {@link module:engine/controller/datacontroller~DataController#set data.set} it is not possible to define the type of the element.\n * In such cases the {@link module:engine/view/upcastwriter~UpcastWriter#createElement `UpcastWriter#createElement()`} method\n * should be used to create generic view elements.\n *\n * @extends module:engine/view/node~Node\n */\nexport default class Element extends Node {\n\t/**\n\t * Creates a view element.\n\t *\n\t * Attributes can be passed in various formats:\n\t *\n\t *\t\tnew Element( viewDocument, 'div', { class: 'editor', contentEditable: 'true' } ); // object\n\t *\t\tnew Element( viewDocument, 'div', [ [ 'class', 'editor' ], [ 'contentEditable', 'true' ] ] ); // map-like iterator\n\t *\t\tnew Element( viewDocument, 'div', mapOfAttributes ); // map\n\t *\n\t * @protected\n\t * @param {module:engine/view/document~Document} document The document instance to which this element belongs.\n\t * @param {String} name Node name.\n\t * @param {Object|Iterable} [attrs] Collection of attributes.\n\t * @param {module:engine/view/node~Node|Iterable.<module:engine/view/node~Node>} [children]\n\t * A list of nodes to be inserted into created element.\n\t */\n\tconstructor( document, name, attrs, children ) {\n\t\tsuper( document );\n\n\t\t/**\n\t\t * Name of the element.\n\t\t *\n\t\t * @readonly\n\t\t * @member {String}\n\t\t */\n\t\tthis.name = name;\n\n\t\t/**\n\t\t * Map of attributes, where attributes names are keys and attributes values are values.\n\t\t *\n\t\t * @protected\n\t\t * @member {Map} #_attrs\n\t\t */\n\t\tthis._attrs = parseAttributes( attrs );\n\n\t\t/**\n\t\t * Array of child nodes.\n\t\t *\n\t\t * @protected\n\t\t * @member {Array.<module:engine/view/node~Node>}\n\t\t */\n\t\tthis._children = [];\n\n\t\tif ( children ) {\n\t\t\tthis._insertChild( 0, children );\n\t\t}\n\n\t\t/**\n\t\t * Set of classes associated with element instance.\n\t\t *\n\t\t * @protected\n\t\t * @member {Set}\n\t\t */\n\t\tthis._classes = new Set();\n\n\t\tif ( this._attrs.has( 'class' ) ) {\n\t\t\t// Remove class attribute and handle it by class set.\n\t\t\tconst classString = this._attrs.get( 'class' );\n\t\t\tparseClasses( this._classes, classString );\n\t\t\tthis._attrs.delete( 'class' );\n\t\t}\n\n\t\t/**\n\t\t * Normalized styles.\n\t\t *\n\t\t * @protected\n\t\t * @member {module:engine/view/stylesmap~StylesMap} module:engine/view/element~Element#_styles\n\t\t */\n\t\tthis._styles = new StylesMap( this.document.stylesProcessor );\n\n\t\tif ( this._attrs.has( 'style' ) ) {\n\t\t\t// Remove style attribute and handle it by styles map.\n\t\t\tthis._styles.setTo( this._attrs.get( 'style' ) );\n\n\t\t\tthis._attrs.delete( 'style' );\n\t\t}\n\n\t\t/**\n\t\t * Map of custom properties.\n\t\t * Custom properties can be added to element instance, will be cloned but not rendered into DOM.\n\t\t *\n\t\t * @protected\n\t\t * @member {Map}\n\t\t */\n\t\tthis._customProperties = new Map();\n\t}\n\n\t/**\n\t * Number of element's children.\n\t *\n\t * @readonly\n\t * @type {Number}\n\t */\n\tget childCount() {\n\t\treturn this._children.length;\n\t}\n\n\t/**\n\t * Is `true` if there are no nodes inside this element, `false` otherwise.\n\t *\n\t * @readonly\n\t * @type {Boolean}\n\t */\n\tget isEmpty() {\n\t\treturn this._children.length === 0;\n\t}\n\n\t/**\n\t * Checks whether this object is of the given.\n\t *\n\t *\t\telement.is( 'element' ); // -> true\n\t *\t\telement.is( 'node' ); // -> true\n\t *\t\telement.is( 'view:element' ); // -> true\n\t *\t\telement.is( 'view:node' ); // -> true\n\t *\n\t *\t\telement.is( 'model:element' ); // -> false\n\t *\t\telement.is( 'documentSelection' ); // -> false\n\t *\n\t * Assuming that the object being checked is an element, you can also check its\n\t * {@link module:engine/view/element~Element#name name}:\n\t *\n\t *\t\telement.is( 'img' ); // -> true if this is an <img> element\n\t *\t\telement.is( 'element', 'img' ); // -> same as above\n\t *\t\ttext.is( 'img' ); -> false\n\t *\n\t * {@link module:engine/view/node~Node#is Check the entire list of view objects} which implement the `is()` method.\n\t *\n\t * @param {String} type Type to check when `name` parameter is present.\n\t * Otherwise, it acts like the `name` parameter.\n\t * @param {String} [name] Element name.\n\t * @returns {Boolean}\n\t */\n\tis( type, name = null ) {\n\t\tconst cutType = type.replace( /^view:/, '' );\n\t\tif ( !name ) {\n\t\t\treturn cutType == 'element' || cutType == this.name || super.is( type );\n\t\t} else {\n\t\t\treturn cutType == 'element' && name == this.name;\n\t\t}\n\t}\n\n\t/**\n\t * Gets child at the given index.\n\t *\n\t * @param {Number} index Index of child.\n\t * @returns {module:engine/view/node~Node} Child node.\n\t */\n\tgetChild( index ) {\n\t\treturn this._children[ index ];\n\t}\n\n\t/**\n\t * Gets index of the given child node. Returns `-1` if child node is not found.\n\t *\n\t * @param {module:engine/view/node~Node} node Child node.\n\t * @returns {Number} Index of the child node.\n\t */\n\tgetChildIndex( node ) {\n\t\treturn this._children.indexOf( node );\n\t}\n\n\t/**\n\t * Gets child nodes iterator.\n\t *\n\t * @returns {Iterable.<module:engine/view/node~Node>} Child nodes iterator.\n\t */\n\tgetChildren() {\n\t\treturn this._children[ Symbol.iterator ]();\n\t}\n\n\t/**\n\t * Returns an iterator that contains the keys for attributes. Order of inserting attributes is not preserved.\n\t *\n\t * @returns {Iterable.<String>} Keys for attributes.\n\t */\n\t* getAttributeKeys() {\n\t\tif ( this._classes.size > 0 ) {\n\t\t\tyield 'class';\n\t\t}\n\n\t\tif ( !this._styles.isEmpty ) {\n\t\t\tyield 'style';\n\t\t}\n\n\t\tyield* this._attrs.keys();\n\t}\n\n\t/**\n\t * Returns iterator that iterates over this element's attributes.\n\t *\n\t * Attributes are returned as arrays containing two items. First one is attribute key and second is attribute value.\n\t * This format is accepted by native `Map` object and also can be passed in `Node` constructor.\n\t *\n\t * @returns {Iterable.<*>}\n\t */\n\t* getAttributes() {\n\t\tyield* this._attrs.entries();\n\n\t\tif ( this._classes.size > 0 ) {\n\t\t\tyield [ 'class', this.getAttribute( 'class' ) ];\n\t\t}\n\n\t\tif ( !this._styles.isEmpty ) {\n\t\t\tyield [ 'style', this.getAttribute( 'style' ) ];\n\t\t}\n\t}\n\n\t/**\n\t * Gets attribute by key. If attribute is not present - returns undefined.\n\t *\n\t * @param {String} key Attribute key.\n\t * @returns {String|undefined} Attribute value.\n\t */\n\tgetAttribute( key ) {\n\t\tif ( key == 'class' ) {\n\t\t\tif ( this._classes.size > 0 ) {\n\t\t\t\treturn [ ...this._classes ].join( ' ' );\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif ( key == 'style' ) {\n\t\t\tconst inlineStyle = this._styles.toString();\n\n\t\t\treturn inlineStyle == '' ? undefined : inlineStyle;\n\t\t}\n\n\t\treturn this._attrs.get( key );\n\t}\n\n\t/**\n\t * Returns a boolean indicating whether an attribute with the specified key exists in the element.\n\t *\n\t * @param {String} key Attribute key.\n\t * @returns {Boolean} `true` if attribute with the specified key exists in the element, false otherwise.\n\t */\n\thasAttribute( key ) {\n\t\tif ( key == 'class' ) {\n\t\t\treturn this._classes.size > 0;\n\t\t}\n\n\t\tif ( key == 'style' ) {\n\t\t\treturn !this._styles.isEmpty;\n\t\t}\n\n\t\treturn this._attrs.has( key );\n\t}\n\n\t/**\n\t * Checks if this element is similar to other element.\n\t * Both elements should have the same name and attributes to be considered as similar. Two similar elements\n\t * can contain different set of children nodes.\n\t *\n\t * @param {module:engine/view/element~Element} otherElement\n\t * @returns {Boolean}\n\t */\n\tisSimilar( otherElement ) {\n\t\tif ( !( otherElement instanceof Element ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// If exactly the same Element is provided - return true immediately.\n\t\tif ( this === otherElement ) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Check element name.\n\t\tif ( this.name != otherElement.name ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Check number of attributes, classes and styles.\n\t\tif ( this._attrs.size !== otherElement._attrs.size || this._classes.size !== otherElement._classes.size ||\n\t\t\tthis._styles.size !== otherElement._styles.size ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Check if attributes are the same.\n\t\tfor ( const [ key, value ] of this._attrs ) {\n\t\t\tif ( !otherElement._attrs.has( key ) || otherElement._attrs.get( key ) !== value ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\t// Check if classes are the same.\n\t\tfor ( const className of this._classes ) {\n\t\t\tif ( !otherElement._classes.has( className ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\t// Check if styles are the same.\n\t\tfor ( const property of this._styles.getStyleNames() ) {\n\t\t\tif (\n\t\t\t\t!otherElement._styles.has( property ) ||\n\t\t\t\totherElement._styles.getAsString( property ) !== this._styles.getAsString( property )\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Returns true if class is present.\n\t * If more then one class is provided - returns true only when all classes are present.\n\t *\n\t *\t\telement.hasClass( 'foo' ); // Returns true if 'foo' class is present.\n\t *\t\telement.hasClass( 'foo', 'bar' ); // Returns true if 'foo' and 'bar' classes are both present.\n\t *\n\t * @param {...String} className\n\t */\n\thasClass( ...className ) {\n\t\tfor ( const name of className ) {\n\t\t\tif ( !this._classes.has( name ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Returns iterator that contains all class names.\n\t *\n\t * @returns {Iterable.<String>}\n\t */\n\tgetClassNames() {\n\t\treturn this._classes.keys();\n\t}\n\n\t/**\n\t * Returns style value for the given property mae.\n\t * If the style does not exist `undefined` is returned.\n\t *\n\t * **Note**: This method can work with normalized style names if\n\t * {@link module:engine/controller/datacontroller~DataController#addStyleProcessorRules a particular style processor rule is enabled}.\n\t * See {@link module:engine/view/stylesmap~StylesMap#getAsString `StylesMap#getAsString()`} for details.\n\t *\n\t * For an element with style set to `'margin:1px'`:\n\t *\n\t *\t\t// Enable 'margin' shorthand processing:\n\t *\t\teditor.data.addStyleProcessorRules( addMarginRules );\n\t *\n\t *\t\tconst element = view.change( writer => {\n\t *\t\t\tconst element = writer.createElement();\n\t *\t\t\twriter.setStyle( 'margin', '1px' );\n\t *\t\t\twriter.setStyle( 'margin-bottom', '3em' );\n\t *\n\t *\t\t\treturn element;\n\t *\t\t} );\n\t *\n\t *\t\telement.getStyle( 'margin' ); // -> 'margin: 1px 1px 3em;'\n\t *\n\t * @param {String} property\n\t * @returns {String|undefined}\n\t */\n\tgetStyle( property ) {\n\t\treturn this._styles.getAsString( property );\n\t}\n\n\t/**\n\t * Returns a normalized style object or single style value.\n\t *\n\t * For an element with style set to: margin:1px 2px 3em;\n\t *\n\t *\t\telement.getNormalizedStyle( 'margin' ) );\n\t *\n\t * will return:\n\t *\n\t *\t\t{\n\t *\t\t\ttop: '1px',\n\t *\t\t\tright: '2px',\n\t *\t\t\tbottom: '3em',\n\t *\t\t\tleft: '2px'    // a normalized value from margin shorthand\n\t *\t\t}\n\t *\n\t * and reading for single style value:\n\t *\n\t *\t\tstyles.getNormalizedStyle( 'margin-left' );\n\t *\n\t * Will return a `2px` string.\n\t *\n\t * **Note**: This method will return normalized values only if\n\t * {@link module:engine/controller/datacontroller~DataController#addStyleProcessorRules a particular style processor rule is enabled}.\n\t * See {@link module:engine/view/stylesmap~StylesMap#getNormalized `StylesMap#getNormalized()`} for details.\n\t *\n\t *\n\t * @param {String} property Name of CSS property\n\t * @returns {Object|String|undefined}\n\t */\n\tgetNormalizedStyle( property ) {\n\t\treturn this._styles.getNormalized( property );\n\t}\n\n\t/**\n\t * Returns iterator that contains all style names.\n\t *\n\t * @returns {Iterable.<String>}\n\t */\n\tgetStyleNames() {\n\t\treturn this._styles.getStyleNames();\n\t}\n\n\t/**\n\t * Returns true if style keys are present.\n\t * If more then one style property is provided - returns true only when all properties are present.\n\t *\n\t *\t\telement.hasStyle( 'color' ); // Returns true if 'border-top' style is present.\n\t *\t\telement.hasStyle( 'color', 'border-top' ); // Returns true if 'color' and 'border-top' styles are both present.\n\t *\n\t * @param {...String} property\n\t */\n\thasStyle( ...property ) {\n\t\tfor ( const name of property ) {\n\t\t\tif ( !this._styles.has( name ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Returns ancestor element that match specified pattern.\n\t * Provided patterns should be compatible with {@link module:engine/view/matcher~Matcher Matcher} as it is used internally.\n\t *\n\t * @see module:engine/view/matcher~Matcher\n\t * @param {Object|String|RegExp|Function} patterns Patterns used to match correct ancestor.\n\t * See {@link module:engine/view/matcher~Matcher}.\n\t * @returns {module:engine/view/element~Element|null} Found element or `null` if no matching ancestor was found.\n\t */\n\tfindAncestor( ...patterns ) {\n\t\tconst matcher = new Matcher( ...patterns );\n\t\tlet parent = this.parent;\n\n\t\twhile ( parent ) {\n\t\t\tif ( matcher.match( parent ) ) {\n\t\t\t\treturn parent;\n\t\t\t}\n\n\t\t\tparent = parent.parent;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Returns the custom property value for the given key.\n\t *\n\t * @param {String|Symbol} key\n\t * @returns {*}\n\t */\n\tgetCustomProperty( key ) {\n\t\treturn this._customProperties.get( key );\n\t}\n\n\t/**\n\t * Returns an iterator which iterates over this element's custom properties.\n\t * Iterator provides `[ key, value ]` pairs for each stored property.\n\t *\n\t * @returns {Iterable.<*>}\n\t */\n\t* getCustomProperties() {\n\t\tyield* this._customProperties.entries();\n\t}\n\n\t/**\n\t * Returns identity string based on element's name, styles, classes and other attributes.\n\t * Two elements that {@link #isSimilar are similar} will have same identity string.\n\t * It has the following format:\n\t *\n\t *\t\t'name class=\"class1,class2\" style=\"style1:value1;style2:value2\" attr1=\"val1\" attr2=\"val2\"'\n \t *\n\t * For example:\n\t *\n\t *\t\tconst element = writer.createContainerElement( 'foo', {\n\t *\t\t\tbanana: '10',\n\t *\t\t\tapple: '20',\n\t *\t\t\tstyle: 'color: red; border-color: white;',\n\t *\t\t\tclass: 'baz'\n\t *\t\t} );\n\t *\n\t *\t\t// returns 'foo class=\"baz\" style=\"border-color:white;color:red\" apple=\"20\" banana=\"10\"'\n\t *\t\telement.getIdentity();\n\t *\n\t * **Note**: Classes, styles and other attributes are sorted alphabetically.\n\t *\n\t * @returns {String}\n\t */\n\tgetIdentity() {\n\t\tconst classes = Array.from( this._classes ).sort().join( ',' );\n\t\tconst styles = this._styles.toString();\n\t\tconst attributes = Array.from( this._attrs ).map( i => `${ i[ 0 ] }=\"${ i[ 1 ] }\"` ).sort().join( ' ' );\n\n\t\treturn this.name +\n\t\t\t( classes == '' ? '' : ` class=\"${ classes }\"` ) +\n\t\t\t( !styles ? '' : ` style=\"${ styles }\"` ) +\n\t\t\t( attributes == '' ? '' : ` ${ attributes }` );\n\t}\n\n\t/**\n\t * Clones provided element.\n\t *\n\t * @protected\n\t * @param {Boolean} [deep=false] If set to `true` clones element and all its children recursively. When set to `false`,\n\t * element will be cloned without any children.\n\t * @returns {module:engine/view/element~Element} Clone of this element.\n\t */\n\t_clone( deep = false ) {\n\t\tconst childrenClone = [];\n\n\t\tif ( deep ) {\n\t\t\tfor ( const child of this.getChildren() ) {\n\t\t\t\tchildrenClone.push( child._clone( deep ) );\n\t\t\t}\n\t\t}\n\n\t\t// ContainerElement and AttributeElement should be also cloned properly.\n\t\tconst cloned = new this.constructor( this.document, this.name, this._attrs, childrenClone );\n\n\t\t// Classes and styles are cloned separately - this solution is faster than adding them back to attributes and\n\t\t// parse once again in constructor.\n\t\tcloned._classes = new Set( this._classes );\n\t\tcloned._styles.set( this._styles.getNormalized() );\n\n\t\t// Clone custom properties.\n\t\tcloned._customProperties = new Map( this._customProperties );\n\n\t\t// Clone filler offset method.\n\t\t// We can't define this method in a prototype because it's behavior which\n\t\t// is changed by e.g. toWidget() function from ckeditor5-widget. Perhaps this should be one of custom props.\n\t\tcloned.getFillerOffset = this.getFillerOffset;\n\n\t\treturn cloned;\n\t}\n\n\t/**\n\t * {@link module:engine/view/element~Element#_insertChild Insert} a child node or a list of child nodes at the end of this node\n\t * and sets the parent of these nodes to this element.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#insert\n\t * @protected\n\t * @param {module:engine/view/item~Item|Iterable.<module:engine/view/item~Item>} items Items to be inserted.\n\t * @fires module:engine/view/node~Node#change\n\t * @returns {Number} Number of appended nodes.\n\t */\n\t_appendChild( items ) {\n\t\treturn this._insertChild( this.childCount, items );\n\t}\n\n\t/**\n\t * Inserts a child node or a list of child nodes on the given index and sets the parent of these nodes to\n\t * this element.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#insert\n\t * @protected\n\t * @param {Number} index Position where nodes should be inserted.\n\t * @param {module:engine/view/item~Item|Iterable.<module:engine/view/item~Item>} items Items to be inserted.\n\t * @fires module:engine/view/node~Node#change\n\t * @returns {Number} Number of inserted nodes.\n\t */\n\t_insertChild( index, items ) {\n\t\tthis._fireChange( 'children', this );\n\t\tlet count = 0;\n\n\t\tconst nodes = normalize( this.document, items );\n\n\t\tfor ( const node of nodes ) {\n\t\t\t// If node that is being added to this element is already inside another element, first remove it from the old parent.\n\t\t\tif ( node.parent !== null ) {\n\t\t\t\tnode._remove();\n\t\t\t}\n\n\t\t\tnode.parent = this;\n\t\t\tnode.document = this.document;\n\n\t\t\tthis._children.splice( index, 0, node );\n\t\t\tindex++;\n\t\t\tcount++;\n\t\t}\n\n\t\treturn count;\n\t}\n\n\t/**\n\t * Removes number of child nodes starting at the given index and set the parent of these nodes to `null`.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#remove\n\t * @protected\n\t * @param {Number} index Number of the first node to remove.\n\t * @param {Number} [howMany=1] Number of nodes to remove.\n\t * @fires module:engine/view/node~Node#change\n\t * @returns {Array.<module:engine/view/node~Node>} The array of removed nodes.\n\t */\n\t_removeChildren( index, howMany = 1 ) {\n\t\tthis._fireChange( 'children', this );\n\n\t\tfor ( let i = index; i < index + howMany; i++ ) {\n\t\t\tthis._children[ i ].parent = null;\n\t\t}\n\n\t\treturn this._children.splice( index, howMany );\n\t}\n\n\t/**\n\t * Adds or overwrite attribute with a specified key and value.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#setAttribute\n\t * @protected\n\t * @param {String} key Attribute key.\n\t * @param {String} value Attribute value.\n\t * @fires module:engine/view/node~Node#change\n\t */\n\t_setAttribute( key, value ) {\n\t\tvalue = String( value );\n\n\t\tthis._fireChange( 'attributes', this );\n\n\t\tif ( key == 'class' ) {\n\t\t\tparseClasses( this._classes, value );\n\t\t} else if ( key == 'style' ) {\n\t\t\tthis._styles.setTo( value );\n\t\t} else {\n\t\t\tthis._attrs.set( key, value );\n\t\t}\n\t}\n\n\t/**\n\t * Removes attribute from the element.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#removeAttribute\n\t * @protected\n\t * @param {String} key Attribute key.\n\t * @returns {Boolean} Returns true if an attribute existed and has been removed.\n\t * @fires module:engine/view/node~Node#change\n\t */\n\t_removeAttribute( key ) {\n\t\tthis._fireChange( 'attributes', this );\n\n\t\t// Remove class attribute.\n\t\tif ( key == 'class' ) {\n\t\t\tif ( this._classes.size > 0 ) {\n\t\t\t\tthis._classes.clear();\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\t// Remove style attribute.\n\t\tif ( key == 'style' ) {\n\t\t\tif ( !this._styles.isEmpty ) {\n\t\t\t\tthis._styles.clear();\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\t// Remove other attributes.\n\t\treturn this._attrs.delete( key );\n\t}\n\n\t/**\n\t * Adds specified class.\n\t *\n\t *\t\telement._addClass( 'foo' ); // Adds 'foo' class.\n\t *\t\telement._addClass( [ 'foo', 'bar' ] ); // Adds 'foo' and 'bar' classes.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#addClass\n\t * @protected\n\t * @param {Array.<String>|String} className\n\t * @fires module:engine/view/node~Node#change\n\t */\n\t_addClass( className ) {\n\t\tthis._fireChange( 'attributes', this );\n\n\t\tclassName = Array.isArray( className ) ? className : [ className ];\n\t\tclassName.forEach( name => this._classes.add( name ) );\n\t}\n\n\t/**\n\t * Removes specified class.\n\t *\n\t *\t\telement._removeClass( 'foo' );  // Removes 'foo' class.\n\t *\t\telement._removeClass( [ 'foo', 'bar' ] ); // Removes both 'foo' and 'bar' classes.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#removeClass\n\t * @protected\n\t * @param {Array.<String>|String} className\n\t * @fires module:engine/view/node~Node#change\n\t */\n\t_removeClass( className ) {\n\t\tthis._fireChange( 'attributes', this );\n\n\t\tclassName = Array.isArray( className ) ? className : [ className ];\n\t\tclassName.forEach( name => this._classes.delete( name ) );\n\t}\n\n\t/**\n\t * Adds style to the element.\n\t *\n\t *\t\telement._setStyle( 'color', 'red' );\n\t *\t\telement._setStyle( {\n\t *\t\t\tcolor: 'red',\n\t *\t\t\tposition: 'fixed'\n\t *\t\t} );\n\t *\n\t * **Note**: This method can work with normalized style names if\n\t * {@link module:engine/controller/datacontroller~DataController#addStyleProcessorRules a particular style processor rule is enabled}.\n\t * See {@link module:engine/view/stylesmap~StylesMap#set `StylesMap#set()`} for details.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#setStyle\n\t * @protected\n\t * @param {String|Object} property Property name or object with key - value pairs.\n\t * @param {String} [value] Value to set. This parameter is ignored if object is provided as the first parameter.\n\t * @fires module:engine/view/node~Node#change\n\t */\n\t_setStyle( property, value ) {\n\t\tthis._fireChange( 'attributes', this );\n\n\t\tthis._styles.set( property, value );\n\t}\n\n\t/**\n\t * Removes specified style.\n\t *\n\t *\t\telement._removeStyle( 'color' );  // Removes 'color' style.\n\t *\t\telement._removeStyle( [ 'color', 'border-top' ] ); // Removes both 'color' and 'border-top' styles.\n\t *\n\t * **Note**: This method can work with normalized style names if\n\t * {@link module:engine/controller/datacontroller~DataController#addStyleProcessorRules a particular style processor rule is enabled}.\n\t * See {@link module:engine/view/stylesmap~StylesMap#remove `StylesMap#remove()`} for details.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#removeStyle\n\t * @protected\n\t * @param {Array.<String>|String} property\n\t * @fires module:engine/view/node~Node#change\n\t */\n\t_removeStyle( property ) {\n\t\tthis._fireChange( 'attributes', this );\n\n\t\tproperty = Array.isArray( property ) ? property : [ property ];\n\t\tproperty.forEach( name => this._styles.remove( name ) );\n\t}\n\n\t/**\n\t * Sets a custom property. Unlike attributes, custom properties are not rendered to the DOM,\n\t * so they can be used to add special data to elements.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#setCustomProperty\n\t * @protected\n\t * @param {String|Symbol} key\n\t * @param {*} value\n\t */\n\t_setCustomProperty( key, value ) {\n\t\tthis._customProperties.set( key, value );\n\t}\n\n\t/**\n\t * Removes the custom property stored under the given key.\n\t *\n\t * @see module:engine/view/downcastwriter~DowncastWriter#removeCustomProperty\n\t * @protected\n\t * @param {String|Symbol} key\n\t * @returns {Boolean} Returns true if property was removed.\n\t */\n\t_removeCustomProperty( key ) {\n\t\treturn this._customProperties.delete( key );\n\t}\n\n\t/**\n\t * Returns block {@link module:engine/view/filler filler} offset or `null` if block filler is not needed.\n\t *\n\t * @abstract\n\t * @method module:engine/view/element~Element#getFillerOffset\n\t */\n\n\t// @if CK_DEBUG_ENGINE // printTree( level = 0) {\n\t// @if CK_DEBUG_ENGINE // \tlet string = '';\n\n\t// @if CK_DEBUG_ENGINE //\tstring += '\\t'.repeat( level ) + `<${ this.name }${ convertMapToTags( this.getAttributes() ) }>`;\n\n\t// @if CK_DEBUG_ENGINE //\tfor ( const child of this.getChildren() ) {\n\t// @if CK_DEBUG_ENGINE //\t\tif ( child.is( 'text' ) ) {\n\t// @if CK_DEBUG_ENGINE //\t\t\tstring += '\\n' + '\\t'.repeat( level + 1 ) + child.data;\n\t// @if CK_DEBUG_ENGINE //\t\t} else {\n\t// @if CK_DEBUG_ENGINE //\t\t\tstring += '\\n' + child.printTree( level + 1 );\n\t// @if CK_DEBUG_ENGINE //\t\t}\n\t// @if CK_DEBUG_ENGINE //\t}\n\n\t// @if CK_DEBUG_ENGINE //\tif ( this.childCount ) {\n\t// @if CK_DEBUG_ENGINE //\t\tstring += '\\n' + '\\t'.repeat( level );\n\t// @if CK_DEBUG_ENGINE //\t}\n\n\t// @if CK_DEBUG_ENGINE //\tstring += `</${ this.name }>`;\n\n\t// @if CK_DEBUG_ENGINE //\treturn string;\n\t// @if CK_DEBUG_ENGINE // }\n\n\t// @if CK_DEBUG_ENGINE // logTree() {\n\t// @if CK_DEBUG_ENGINE // \tconsole.log( this.printTree() );\n\t// @if CK_DEBUG_ENGINE // }\n}\n\n// Parses attributes provided to the element constructor before they are applied to an element. If attributes are passed\n// as an object (instead of `Iterable`), the object is transformed to the map. Attributes with `null` value are removed.\n// Attributes with non-`String` value are converted to `String`.\n//\n// @param {Object|Iterable} attrs Attributes to parse.\n// @returns {Map} Parsed attributes.\nfunction parseAttributes( attrs ) {\n\tattrs = toMap( attrs );\n\n\tfor ( const [ key, value ] of attrs ) {\n\t\tif ( value === null ) {\n\t\t\tattrs.delete( key );\n\t\t} else if ( typeof value != 'string' ) {\n\t\t\tattrs.set( key, String( value ) );\n\t\t}\n\t}\n\n\treturn attrs;\n}\n\n// Parses class attribute and puts all classes into classes set.\n// Classes set s cleared before insertion.\n//\n// @param {Set.<String>} classesSet Set to insert parsed classes.\n// @param {String} classesString String with classes to parse.\nfunction parseClasses( classesSet, classesString ) {\n\tconst classArray = classesString.split( /\\s+/ );\n\tclassesSet.clear();\n\tclassArray.forEach( name => classesSet.add( name ) );\n}\n\n// Converts strings to Text and non-iterables to arrays.\n//\n// @param {String|module:engine/view/item~Item|Iterable.<String|module:engine/view/item~Item>}\n// @returns {Iterable.<module:engine/view/node~Node>}\nfunction normalize( document, nodes ) {\n\t// Separate condition because string is iterable.\n\tif ( typeof nodes == 'string' ) {\n\t\treturn [ new Text( document, nodes ) ];\n\t}\n\n\tif ( !isIterable( nodes ) ) {\n\t\tnodes = [ nodes ];\n\t}\n\n\t// Array.from to enable .map() on non-arrays.\n\treturn Array.from( nodes )\n\t\t.map( node => {\n\t\t\tif ( typeof node == 'string' ) {\n\t\t\t\treturn new Text( document, node );\n\t\t\t}\n\n\t\t\tif ( node instanceof TextProxy ) {\n\t\t\t\treturn new Text( document, node.data );\n\t\t\t}\n\n\t\t\treturn node;\n\t\t} );\n}\n"]}]}