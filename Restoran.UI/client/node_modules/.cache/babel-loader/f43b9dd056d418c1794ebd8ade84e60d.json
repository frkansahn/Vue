{"remainingRequest":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-engine\\src\\utils\\bindtwostepcarettoattribute.js","dependencies":[{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-engine\\src\\utils\\bindtwostepcarettoattribute.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-dev-webpack-plugin\\lib\\translatesourceloader.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1581760768702},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1581760768279}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOlxcVXNlcnNcXHBjXFxEZXNrdG9wXFxSZXN0b3JhblxcUmVzdG9yYW5cXFJlc3RvcmFuLlVJXFxjbGllbnRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJDOlxcVXNlcnNcXHBjXFxEZXNrdG9wXFxSZXN0b3JhblxcUmVzdG9yYW5cXFJlc3RvcmFuLlVJXFxjbGllbnRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKCi8qKgogKiBAbGljZW5zZSBDb3B5cmlnaHQgKGMpIDIwMDMtMjAyMCwgQ0tTb3VyY2UgLSBGcmVkZXJpY28gS25hYmJlbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICogRm9yIGxpY2Vuc2luZywgc2VlIExJQ0VOU0UubWQgb3IgaHR0cHM6Ly9ja2VkaXRvci5jb20vbGVnYWwvY2tlZGl0b3Itb3NzLWxpY2Vuc2UKICovCgovKioKICogQG1vZHVsZSBlbmdpbmUvdXRpbHMvYmluZHR3b3N0ZXBjYXJldHRvYXR0cmlidXRlCiAqLwppbXBvcnQgeyBrZXlDb2RlcyB9IGZyb20gJ0Bja2VkaXRvci9ja2VkaXRvcjUtdXRpbHMvc3JjL2tleWJvYXJkJzsKaW1wb3J0IHByaW9yaXRpZXMgZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11dGlscy9zcmMvcHJpb3JpdGllcyc7Ci8qKgogKiBUaGlzIGhlbHBlciBlbmFibGVzIHRoZSB0d28tc3RlcCBjYXJldCAocGhhbnRvbSkgbW92ZW1lbnQgYmVoYXZpb3IgZm9yIHRoZSBnaXZlbiB7QGxpbmsgbW9kdWxlOmVuZ2luZS9tb2RlbC9tb2RlbH5Nb2RlbH0KICogYXR0cmlidXRlIG9uIGFycm93IHJpZ2h0ICg8a2JkPuKGkjwva2JkPikgYW5kIGxlZnQgKDxrYmQ+4oaQPC9rYmQ+KSBrZXkgcHJlc3MuCiAqCiAqIFRoYW5rcyB0byB0aGlzIChwaGFudG9tKSBjYXJldCBtb3ZlbWVudCB0aGUgdXNlciBpcyBhYmxlIHRvIHR5cGUgYmVmb3JlL2FmdGVyIGFzIHdlbGwgYXMgYXQgdGhlCiAqIGJlZ2lubmluZy9lbmQgb2YgYW4gYXR0cmlidXRlLgogKgogKiAqKk5vdGU6KiogVGhpcyBoZWxwZXIgc3VwcG9ydCByaWdodOKAk3Rv4oCTbGVmdCAoQXJhYmljLCBIZWJyZXcsIGV0Yy4pIGNvbnRlbnQgYnkgbWlycm9yaW5nIGl0cyBiZWhhdmlvcgogKiBidXQgZm9yIHRoZSBzYWtlIG9mIHNpbXBsaWNpdHkgZXhhbXBsZXMgc2hvd2Nhc2Ugb25seSBsZWZ04oCTdG/igJNyaWdodCB1c2XigJNjYXNlcy4KICoKICogIyBGb3J3YXJkIG1vdmVtZW50CiAqCiAqICMjICJFbnRlcmluZyIgYW4gYXR0cmlidXRlOgogKgogKiBXaGVuIHRoaXMgYmVoYXZpb3IgaXMgZW5hYmxlZCBmb3IgdGhlIGBhYCBhdHRyaWJ1dGUgYW5kIHRoZSBzZWxlY3Rpb24gaXMgcmlnaHQgYmVmb3JlIGl0CiAqIChhdCB0aGUgYXR0cmlidXRlIGJvdW5kYXJ5KSwgcHJlc3NpbmcgdGhlIHJpZ2h0IGFycm93IGtleSB3aWxsIG5vdCBtb3ZlIHRoZSBzZWxlY3Rpb24gYnV0IHVwZGF0ZSBpdHMKICogYXR0cmlidXRlcyBhY2NvcmRpbmdseToKICoKICogKiBXaGVuIGVuYWJsZWQ6CiAqCiAqICAgCQlmb297fTwkdGV4dCBhPSJ0cnVlIj5iYXI8LyR0ZXh0PgogKgogKiAgICA8a2JkPuKGkjwva2JkPgogKgogKiAgIAkJZm9vPCR0ZXh0IGE9InRydWUiPnt9YmFyPC8kdGV4dD4KICoKICogKiBXaGVuIGRpc2FibGVkOgogKgogKiAgIAkJZm9ve308JHRleHQgYT0idHJ1ZSI+YmFyPC8kdGV4dD4KICoKICogICA8a2JkPuKGkjwva2JkPgogKgogKiAgIAkJZm9vPCR0ZXh0IGE9InRydWUiPmJ7fWFyPC8kdGV4dD4KICoKICoKICogIyMgIkxlYXZpbmciIGFuIGF0dHJpYnV0ZToKICoKICogKiBXaGVuIGVuYWJsZWQ6CiAqCiAqICAgCQk8JHRleHQgYT0idHJ1ZSI+YmFye308LyR0ZXh0PmJhegogKgogKiAgICA8a2JkPuKGkjwva2JkPgogKgogKiAgIAkJPCR0ZXh0IGE9InRydWUiPmJhcjwvJHRleHQ+e31iYXoKICoKICogKiBXaGVuIGRpc2FibGVkOgogKgogKiAgIAkJPCR0ZXh0IGE9InRydWUiPmJhcnt9PC8kdGV4dD5iYXoKICoKICogICA8a2JkPuKGkjwva2JkPgogKgogKiAgIAkJPCR0ZXh0IGE9InRydWUiPmJhcjwvJHRleHQ+Ynt9YXoKICoKICogIyBCYWNrd2FyZCBtb3ZlbWVudAogKgogKiAqIFdoZW4gZW5hYmxlZDoKICoKICogICAJCTwkdGV4dCBhPSJ0cnVlIj5iYXI8LyR0ZXh0Pnt9YmF6CiAqCiAqICAgIDxrYmQ+4oaQPC9rYmQ+CiAqCiAqICAgCQk8JHRleHQgYT0idHJ1ZSI+YmFye308LyR0ZXh0PmJhegogKgogKiAqIFdoZW4gZGlzYWJsZWQ6CiAqCiAqICAgCQk8JHRleHQgYT0idHJ1ZSI+YmFyPC8kdGV4dD57fWJhegogKgogKiAgIDxrYmQ+4oaQPC9rYmQ+CiAqCiAqICAgCQk8JHRleHQgYT0idHJ1ZSI+YmF7fXI8LyR0ZXh0PmJ7fWF6CiAqCiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIEhlbHBlciBvcHRpb25zLgogKiBAcGFyYW0ge21vZHVsZTplbmdpbmUvdmlldy92aWV3flZpZXd9IG9wdGlvbnMudmlldyBWaWV3IGNvbnRyb2xsZXIgaW5zdGFuY2UuCiAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS9tb2RlbC9tb2RlbH5Nb2RlbH0gb3B0aW9ucy5tb2RlbCBEYXRhIG1vZGVsIGluc3RhbmNlLgogKiBAcGFyYW0ge21vZHVsZTp1dGlscy9kb20vZW1pdHRlcm1peGlufkVtaXR0ZXJ9IG9wdGlvbnMuZW1pdHRlciBUaGUgZW1pdHRlciB0byB3aGljaCB0aGlzIGJlaGF2aW9yIHNob3VsZCBiZSBhZGRlZAogKiAoZS5nLiBhIHBsdWdpbiBpbnN0YW5jZSkuCiAqIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zLmF0dHJpYnV0ZSBBdHRyaWJ1dGUgZm9yIHdoaWNoIHRoaXMgYmVoYXZpb3Igd2lsbCBiZSBhZGRlZC4KICogQHBhcmFtIHttb2R1bGU6dXRpbHMvbG9jYWxlfkxvY2FsZX0gb3B0aW9ucy5sb2NhbGUgVGhlIHtAbGluayBtb2R1bGU6Y29yZS9lZGl0b3IvZWRpdG9yfkVkaXRvciNsb2NhbGV9IGluc3RhbmNlLgogKi8KCmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGJpbmRUd29TdGVwQ2FyZXRUb0F0dHJpYnV0ZShfcmVmKSB7CiAgdmFyIHZpZXcgPSBfcmVmLnZpZXcsCiAgICAgIG1vZGVsID0gX3JlZi5tb2RlbCwKICAgICAgZW1pdHRlciA9IF9yZWYuZW1pdHRlciwKICAgICAgYXR0cmlidXRlID0gX3JlZi5hdHRyaWJ1dGUsCiAgICAgIGxvY2FsZSA9IF9yZWYubG9jYWxlOwogIHZhciB0d29TdGVwQ2FyZXRIYW5kbGVyID0gbmV3IFR3b1N0ZXBDYXJldEhhbmRsZXIobW9kZWwsIGVtaXR0ZXIsIGF0dHJpYnV0ZSk7CiAgdmFyIG1vZGVsU2VsZWN0aW9uID0gbW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uOyAvLyBMaXN0ZW4gdG8ga2V5Ym9hcmQgZXZlbnRzIGFuZCBoYW5kbGUgdGhlIGNhcmV0IG1vdmVtZW50IGFjY29yZGluZyB0byB0aGUgMi1zdGVwIGNhcmV0IGxvZ2ljLgogIC8vCiAgLy8gTm90ZTogVGhpcyBsaXN0ZW5lciBoYXMgdGhlICJoaWdoKzEiIHByaW9yaXR5OgogIC8vICogImhpZ2giIGJlY2F1c2Ugb2YgdGhlIGZpbGxlciBsb2dpYyBpbXBsZW1lbnRlZCBpbiB0aGUgcmVuZGVyZXIgd2hpY2ggYWxzbyBlbmdhZ2VzIG9uICNrZXlkb3duLgogIC8vIFdoZW4gdGhlIGdyYXZpdHkgaXMgb3ZlcnJpZGRlbiB0aGUgYXR0cmlidXRlcyBvZiB0aGUgKG1vZGVsKSBzZWxlY3Rpb24gYXR0cmlidXRlcyBhcmUgcmVzZXQuCiAgLy8gSXQgbWF5IGVuZCB1cCB3aXRoIHRoZSBmaWxsZXIga2lja2luZyBpbiBhbmQgYnJlYWtpbmcgdGhlIHNlbGVjdGlvbi4KICAvLyAqICIrMSIgYmVjYXVzZSB3ZSB3b3VsZCBsaWtlIHRvIGF2b2lkIGNvbGxpc2lvbnMgd2l0aCBvdGhlciBmZWF0dXJlcyAobGlrZSBXaWRnZXRzKSwgd2hpY2gKICAvLyB0YWtlIG92ZXIgdGhlIGtleWRvd24gZXZlbnRzIHdpdGggdGhlICJoaWdoIiBwcmlvcml0eS4gVHdvLXN0ZXAgY2FyZXQgbW92ZW1lbnQgdGFrZXMgcHJlY2VkZW5jZQogIC8vIG92ZXIgV2lkZ2V0cyBpbiB0aGF0IG1hdHRlci4KICAvLwogIC8vIEZpbmQgb3V0IG1vcmUgaW4gaHR0cHM6Ly9naXRodWIuY29tL2NrZWRpdG9yL2NrZWRpdG9yNS1lbmdpbmUvaXNzdWVzLzEzMDEuCgogIGVtaXR0ZXIubGlzdGVuVG8odmlldy5kb2N1bWVudCwgJ2tleWRvd24nLCBmdW5jdGlvbiAoZXZ0LCBkYXRhKSB7CiAgICAvLyBUaGlzIGltcGxlbWVudGF0aW9uIHdvcmtzIG9ubHkgZm9yIGNvbGxhcHNlZCBzZWxlY3Rpb24uCiAgICBpZiAoIW1vZGVsU2VsZWN0aW9uLmlzQ29sbGFwc2VkKSB7CiAgICAgIHJldHVybjsKICAgIH0gLy8gV2hlbiB1c2VyIHRyaWVzIHRvIGV4cGFuZCB0aGUgc2VsZWN0aW9uIG9yIGp1bXAgb3ZlciB0aGUgd2hvbGUgd29yZCBvciB0byB0aGUgYmVnaW5uaW5nL2VuZCB0aGVuCiAgICAvLyB0d28tc3RlcHMgbW92ZW1lbnQgaXMgbm90IG5lY2Vzc2FyeS4KCgogICAgaWYgKGRhdGEuc2hpZnRLZXkgfHwgZGF0YS5hbHRLZXkgfHwgZGF0YS5jdHJsS2V5KSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgYXJyb3dSaWdodFByZXNzZWQgPSBkYXRhLmtleUNvZGUgPT0ga2V5Q29kZXMuYXJyb3dyaWdodDsKICAgIHZhciBhcnJvd0xlZnRQcmVzc2VkID0gZGF0YS5rZXlDb2RlID09IGtleUNvZGVzLmFycm93bGVmdDsgLy8gV2hlbiBuZWl0aGVyIGxlZnQgb3IgcmlnaHQgYXJyb3cgaGFzIGJlZW4gcHJlc3NlZCB0aGVuIGRvIG5vdGluZy4KCiAgICBpZiAoIWFycm93UmlnaHRQcmVzc2VkICYmICFhcnJvd0xlZnRQcmVzc2VkKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgcG9zaXRpb24gPSBtb2RlbFNlbGVjdGlvbi5nZXRGaXJzdFBvc2l0aW9uKCk7CiAgICB2YXIgY29udGVudERpcmVjdGlvbiA9IGxvY2FsZS5jb250ZW50TGFuZ3VhZ2VEaXJlY3Rpb247CiAgICB2YXIgaXNNb3ZlbWVudEhhbmRsZWQ7CgogICAgaWYgKGNvbnRlbnREaXJlY3Rpb24gPT09ICdsdHInICYmIGFycm93UmlnaHRQcmVzc2VkIHx8IGNvbnRlbnREaXJlY3Rpb24gPT09ICdydGwnICYmIGFycm93TGVmdFByZXNzZWQpIHsKICAgICAgaXNNb3ZlbWVudEhhbmRsZWQgPSB0d29TdGVwQ2FyZXRIYW5kbGVyLmhhbmRsZUZvcndhcmRNb3ZlbWVudChwb3NpdGlvbiwgZGF0YSk7CiAgICB9IGVsc2UgewogICAgICBpc01vdmVtZW50SGFuZGxlZCA9IHR3b1N0ZXBDYXJldEhhbmRsZXIuaGFuZGxlQmFja3dhcmRNb3ZlbWVudChwb3NpdGlvbiwgZGF0YSk7CiAgICB9IC8vIFN0b3AgdGhlIGtleWRvd24gZXZlbnQgaWYgdGhlIHR3by1zdGVwIGNhcmV0IG1vdmVtZW50IGhhbmRsZWQgaXQuIEF2b2lkIGNvbGxpc2lvbnMKICAgIC8vIHdpdGggb3RoZXIgZmVhdHVyZXMgd2hpY2ggbWF5IGFsc28gdGFrZSBvdmVyIHRoZSBjYXJldCBtb3ZlbWVudCAoZS5nLiBXaWRnZXQpLgoKCiAgICBpZiAoaXNNb3ZlbWVudEhhbmRsZWQpIHsKICAgICAgZXZ0LnN0b3AoKTsKICAgIH0KICB9LCB7CiAgICBwcmlvcml0eTogcHJpb3JpdGllcy5nZXQoJ2hpZ2gnKSArIDEKICB9KTsKfQovKioKICogVGhpcyBpcyBhIHByb3RlY3RlZCBoZWxwZXLigJNjbGFzcyBmb3Ige0BsaW5rIG1vZHVsZTplbmdpbmUvdXRpbHMvYmluZHR3b3N0ZXBjYXJldHRvYXR0cmlidXRlfS4KICogSXQgaGFuZGxlcyB0aGUgc3RhdGUgb2YgdGhlIDItc3RlcCBjYXJldCBtb3ZlbWVudCBmb3IgYSBzaW5nbGUge0BsaW5rIG1vZHVsZTplbmdpbmUvbW9kZWwvbW9kZWx+TW9kZWx9CiAqIGF0dHJpYnV0ZSB1cG9uIHRoZSBga2V5cHJlc3NgIGluIHRoZSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3ZpZXd+Vmlld30uCiAqCiAqIEBwcm90ZWN0ZWQKICovCgpleHBvcnQgdmFyIFR3b1N0ZXBDYXJldEhhbmRsZXIgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uICgpIHsKICAvKgogICAqIENyZWF0ZXMgdHdvIHN0ZXAgaGFuZGxlciBpbnN0YW5jZS4KICAgKgogICAqIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS9tb2RlbC9tb2RlbH5Nb2RlbH0gbW9kZWwgRGF0YSBtb2RlbCBpbnN0YW5jZS4KICAgKiBAcGFyYW0ge21vZHVsZTp1dGlscy9kb20vZW1pdHRlcm1peGlufkVtaXR0ZXJ9IGVtaXR0ZXIgVGhlIGVtaXR0ZXIgdG8gd2hpY2ggdGhpcyBiZWhhdmlvciBzaG91bGQgYmUgYWRkZWQKICAgKiAoZS5nLiBhIHBsdWdpbiBpbnN0YW5jZSkuCiAgICogQHBhcmFtIHtTdHJpbmd9IGF0dHJpYnV0ZSBBdHRyaWJ1dGUgZm9yIHdoaWNoIHRoZSBiZWhhdmlvciB3aWxsIGJlIGFkZGVkLgogICAqLwogIGZ1bmN0aW9uIFR3b1N0ZXBDYXJldEhhbmRsZXIobW9kZWwsIGVtaXR0ZXIsIGF0dHJpYnV0ZSkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVHdvU3RlcENhcmV0SGFuZGxlcik7CgogICAgLyoqCiAgICAgKiBUaGUgbW9kZWwgaW5zdGFuY2UgdGhpcyBjbGFzcyBpbnN0YW5jZSBvcGVyYXRlcyBvbi4KICAgICAqCiAgICAgKiBAcmVhZG9ubHkKICAgICAqIEBtZW1iZXIge21vZHVsZTplbmdpbmUvbW9kZWwvbW9kZWx+TW9kZWwjc2NoZW1hfQogICAgICovCiAgICB0aGlzLm1vZGVsID0gbW9kZWw7CiAgICAvKioKICAgICAqIFRoZSBBdHRyaWJ1dGUgdGhpcyBjbGFzcyBpbnN0YW5jZSBvcGVyYXRlcyBvbi4KICAgICAqCiAgICAgKiBAcmVhZG9ubHkKICAgICAqIEBtZW1iZXIge1N0cmluZ30KICAgICAqLwoKICAgIHRoaXMuYXR0cmlidXRlID0gYXR0cmlidXRlOwogICAgLyoqCiAgICAgKiBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgc2VsZWN0aW9uLgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKiBAbWVtYmVyIHttb2R1bGU6ZW5naW5lL21vZGVsL3NlbGVjdGlvbn5TZWxlY3Rpb259CiAgICAgKi8KCiAgICB0aGlzLl9tb2RlbFNlbGVjdGlvbiA9IG1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbjsKICAgIC8qKgogICAgICogVGhlIGN1cnJlbnQgVUlEIG9mIHRoZSBvdmVycmlkZGVuIGdyYXZpdHksIGFzIHJldHVybmVkIGJ5CiAgICAgKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS9tb2RlbC93cml0ZXJ+V3JpdGVyI292ZXJyaWRlU2VsZWN0aW9uR3Jhdml0eX0uCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqIEBtZW1iZXIge1N0cmluZ30KICAgICAqLwoKICAgIHRoaXMuX292ZXJyaWRlVWlkID0gbnVsbDsKICAgIC8qKgogICAgICogQSBmbGFnIGluZGljYXRpbmcgdGhhdCB0aGUgYXV0b21hdGljIGdyYXZpdHkgcmVzdG9yYXRpb24gZm9yIHRoaXMgYXR0cmlidXRlCiAgICAgKiBzaG91bGQgbm90IGhhcHBlbiB1cG9uIHRoZSBuZXh0CiAgICAgKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS9tb2RlbC9zZWxlY3Rpb25+U2VsZWN0aW9uI2V2ZW50OmNoYW5nZTpyYW5nZX0gZXZlbnQuCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqIEBtZW1iZXIge1N0cmluZ30KICAgICAqLwoKICAgIHRoaXMuX2lzTmV4dEdyYXZpdHlSZXN0b3JhdGlvblNraXBwZWQgPSBmYWxzZTsgLy8gVGhlIGF1dG9tYXRpYyBncmF2aXR5IHJlc3RvcmF0aW9uIGxvZ2ljLgoKICAgIGVtaXR0ZXIubGlzdGVuVG8odGhpcy5fbW9kZWxTZWxlY3Rpb24sICdjaGFuZ2U6cmFuZ2UnLCBmdW5jdGlvbiAoZXZ0LCBkYXRhKSB7CiAgICAgIC8vIFNraXBwaW5nIHRoZSBhdXRvbWF0aWMgcmVzdG9yYXRpb24gaXMgbmVlZGVkIGlmIHRoZSBzZWxlY3Rpb24gc2hvdWxkIGNoYW5nZQogICAgICAvLyBidXQgdGhlIGdyYXZpdHkgbXVzdCByZW1haW4gb3ZlcnJpZGRlbiBhZnRlcndhcmRzLiBTZWUgdGhlICNoYW5kbGVCYWNrd2FyZE1vdmVtZW50CiAgICAgIC8vIHRvIGxlYXJuIG1vcmUuCiAgICAgIGlmIChfdGhpcy5faXNOZXh0R3Jhdml0eVJlc3RvcmF0aW9uU2tpcHBlZCkgewogICAgICAgIF90aGlzLl9pc05leHRHcmF2aXR5UmVzdG9yYXRpb25Ta2lwcGVkID0gZmFsc2U7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIFNraXAgYXV0b21hdGljIHJlc3RvcmUgd2hlbiB0aGUgZ3Jhdml0eSBpcyBub3Qgb3ZlcnJpZGRlbiDigJQgc2ltcGx5LCB0aGVyZSdzIG5vdGhpbmcgdG8gcmVzdG9yZQogICAgICAvLyBhdCB0aGlzIG1vbWVudC4KCgogICAgICBpZiAoIV90aGlzLl9pc0dyYXZpdHlPdmVycmlkZGVuKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIFNraXAgYXV0b21hdGljIHJlc3RvcmUgd2hlbiB0aGUgY2hhbmdlIGlzIGluZGlyZWN0IEFORCB0aGUgc2VsZWN0aW9uIGlzIGF0IHRoZSBhdHRyaWJ1dGUgYm91bmRhcnkuCiAgICAgIC8vIEl0IG1lYW5zIHRoYXQgZS5nLiBpZiB0aGUgY2hhbmdlIHdhcyBleHRlcm5hbCAoY29sbGFib3JhdGlvbikgYW5kIHRoZSB1c2VyIGhhZCB0aGVpcgogICAgICAvLyBzZWxlY3Rpb24gYXJvdW5kIHRoZSBsaW5rLCBpdHMgZ3Jhdml0eSBzaG91bGQgcmVtYWluIGludGFjdCBpbiB0aGlzIGNoYW5nZTpyYW5nZSBldmVudC4KCgogICAgICBpZiAoIWRhdGEuZGlyZWN0Q2hhbmdlICYmIGlzQXRCb3VuZGFyeShfdGhpcy5fbW9kZWxTZWxlY3Rpb24uZ2V0Rmlyc3RQb3NpdGlvbigpLCBhdHRyaWJ1dGUpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBfdGhpcy5fcmVzdG9yZUdyYXZpdHkoKTsKICAgIH0pOwogIH0KICAvKioKICAgKiBVcGRhdGVzIHRoZSBkb2N1bWVudCBzZWxlY3Rpb24gYW5kIHRoZSB2aWV3IGFjY29yZGluZyB0byB0aGUgdHdv4oCTc3RlcCBjYXJldCBtb3ZlbWVudCBzdGF0ZQogICAqIHdoZW4gbW92aW5nICoqZm9yd2FyZHMqKi4gRXhlY3V0ZWQgdXBvbiBga2V5cHJlc3NgIGluIHRoZSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3ZpZXd+Vmlld30uCiAgICoKICAgKiBAcGFyYW0ge21vZHVsZTplbmdpbmUvbW9kZWwvcG9zaXRpb25+UG9zaXRpb259IHBvc2l0aW9uIFRoZSBtb2RlbCBwb3NpdGlvbiBhdCB0aGUgbW9tZW50IG9mIHRoZSBrZXkgcHJlc3MuCiAgICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvb2JzZXJ2ZXIvZG9tZXZlbnRkYXRhfkRvbUV2ZW50RGF0YX0gZGF0YSBEYXRhIG9mIHRoZSBrZXkgcHJlc3MuCiAgICogQHJldHVybnMge0Jvb2xlYW59IGB0cnVlYCB3aGVuIHRoZSBoYW5kbGVyIHByZXZlbnRlZCBjYXJldCBtb3ZlbWVudAogICAqLwoKCiAgX2NyZWF0ZUNsYXNzKFR3b1N0ZXBDYXJldEhhbmRsZXIsIFt7CiAgICBrZXk6ICJoYW5kbGVGb3J3YXJkTW92ZW1lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZUZvcndhcmRNb3ZlbWVudChwb3NpdGlvbiwgZGF0YSkgewogICAgICB2YXIgYXR0cmlidXRlID0gdGhpcy5hdHRyaWJ1dGU7IC8vIERPTidUIEVOR0FHRSAyLVNDTSBpZiBncmF2aXR5IGlzIGFscmVhZHkgb3ZlcnJpZGRlbi4gSXQgbWVhbnMgdGhhdCB3ZSBqdXN0IGVudGVyZWQKICAgICAgLy8KICAgICAgLy8gCQk8cGFyYWdyYXBoPmZvbzwkdGV4dCBhdHRyaWJ1dGU+e31iYXI8LyR0ZXh0PmJhejwvcGFyYWdyYXBoPgogICAgICAvLwogICAgICAvLyBvciBsZWZ0IHRoZSBhdHRyaWJ1dGUKICAgICAgLy8KICAgICAgLy8gCQk8cGFyYWdyYXBoPmZvbzwkdGV4dCBhdHRyaWJ1dGU+YmFyPC8kdGV4dD57fWJhejwvcGFyYWdyYXBoPgogICAgICAvLwogICAgICAvLyBhbmQgdGhlIGdyYXZpdHkgd2lsbCBiZSByZXN0b3JlZCBhdXRvbWF0aWNhbGx5LgoKICAgICAgaWYgKHRoaXMuX2lzR3Jhdml0eU92ZXJyaWRkZW4pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gRE9OJ1QgRU5HQUdFIDItU0NNIHdoZW4gdGhlIHNlbGVjdGlvbiBpcyBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBibG9jayBBTkQgYWxyZWFkeSBoYXMgdGhlCiAgICAgIC8vIGF0dHJpYnV0ZToKICAgICAgLy8gKiB3aGVuIHRoZSBzZWxlY3Rpb24gd2FzIGluaXRpYWxseSBzZXQgdGhlcmUgdXNpbmcgdGhlIG1vdXNlLAogICAgICAvLyAqIHdoZW4gdGhlIGVkaXRvciBoYXMganVzdCBzdGFydGVkCiAgICAgIC8vCiAgICAgIC8vCQk8cGFyYWdyYXBoPjwkdGV4dCBhdHRyaWJ1dGU+e31iYXI8LyR0ZXh0PmJhejwvcGFyYWdyYXBoPgogICAgICAvLwoKCiAgICAgIGlmIChwb3NpdGlvbi5pc0F0U3RhcnQgJiYgdGhpcy5faGFzU2VsZWN0aW9uQXR0cmlidXRlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIEVOR0FHRSAyLVNDTSB3aGVuIGFib3V0IHRvIGxlYXZlIG9uZSBhdHRyaWJ1dGUgdmFsdWUgYW5kIGVudGVyIGFub3RoZXI6CiAgICAgIC8vCiAgICAgIC8vIAkJPHBhcmFncmFwaD48JHRleHQgYXR0cmlidXRlPSIxIj5mb297fTwvJHRleHQ+PCR0ZXh0IGF0dHJpYnV0ZT0iMiI+YmFyPC8kdGV4dD48L3BhcmFncmFwaD4KICAgICAgLy8KICAgICAgLy8gYnV0IERPTidUIHdoZW4gYWxyZWFkeSBpbiBiZXR3ZWVuIG9mIHRoZW0gKG5vIGF0dHJpYnV0ZSBzZWxlY3Rpb24pOgogICAgICAvLwogICAgICAvLyAJCTxwYXJhZ3JhcGg+PCR0ZXh0IGF0dHJpYnV0ZT0iMSI+Zm9vPC8kdGV4dD57fTwkdGV4dCBhdHRyaWJ1dGU9IjIiPmJhcjwvJHRleHQ+PC9wYXJhZ3JhcGg+CiAgICAgIC8vCgoKICAgICAgaWYgKGlzQmV0d2VlbkRpZmZlcmVudFZhbHVlcyhwb3NpdGlvbiwgYXR0cmlidXRlKSAmJiB0aGlzLl9oYXNTZWxlY3Rpb25BdHRyaWJ1dGUpIHsKICAgICAgICB0aGlzLl9wcmV2ZW50Q2FyZXRNb3ZlbWVudChkYXRhKTsKCiAgICAgICAgdGhpcy5fcmVtb3ZlU2VsZWN0aW9uQXR0cmlidXRlKCk7CgogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9IC8vIEVOR0FHRSAyLVNDTSB3aGVuIGVudGVyaW5nIGFuIGF0dHJpYnV0ZToKICAgICAgLy8KICAgICAgLy8gCQk8cGFyYWdyYXBoPmZvb3t9PCR0ZXh0IGF0dHJpYnV0ZT5iYXI8LyR0ZXh0PmJhejwvcGFyYWdyYXBoPgogICAgICAvLwoKCiAgICAgIGlmIChpc0F0U3RhcnRCb3VuZGFyeShwb3NpdGlvbiwgYXR0cmlidXRlKSkgewogICAgICAgIHRoaXMuX3ByZXZlbnRDYXJldE1vdmVtZW50KGRhdGEpOwoKICAgICAgICB0aGlzLl9vdmVycmlkZUdyYXZpdHkoKTsKCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gLy8gRU5HQUdFIDItU0NNIHdoZW4gbGVhdmluZyBhbiBhdHRyaWJ1dGU6CiAgICAgIC8vCiAgICAgIC8vCQk8cGFyYWdyYXBoPmZvbzwkdGV4dCBhdHRyaWJ1dGU+YmFye308LyR0ZXh0PmJhejwvcGFyYWdyYXBoPgogICAgICAvLwoKCiAgICAgIGlmIChpc0F0RW5kQm91bmRhcnkocG9zaXRpb24sIGF0dHJpYnV0ZSkgJiYgdGhpcy5faGFzU2VsZWN0aW9uQXR0cmlidXRlKSB7CiAgICAgICAgdGhpcy5fcHJldmVudENhcmV0TW92ZW1lbnQoZGF0YSk7CgogICAgICAgIHRoaXMuX292ZXJyaWRlR3Jhdml0eSgpOwoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGVzIHRoZSBkb2N1bWVudCBzZWxlY3Rpb24gYW5kIHRoZSB2aWV3IGFjY29yZGluZyB0byB0aGUgdHdv4oCTc3RlcCBjYXJldCBtb3ZlbWVudCBzdGF0ZQogICAgICogd2hlbiBtb3ZpbmcgKipiYWNrd2FyZHMqKi4gRXhlY3V0ZWQgdXBvbiBga2V5cHJlc3NgIGluIHRoZSB7QGxpbmsgbW9kdWxlOmVuZ2luZS92aWV3L3ZpZXd+Vmlld30uCiAgICAgKgogICAgICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL21vZGVsL3Bvc2l0aW9uflBvc2l0aW9ufSBwb3NpdGlvbiBUaGUgbW9kZWwgcG9zaXRpb24gYXQgdGhlIG1vbWVudCBvZiB0aGUga2V5IHByZXNzLgogICAgICogQHBhcmFtIHttb2R1bGU6ZW5naW5lL3ZpZXcvb2JzZXJ2ZXIvZG9tZXZlbnRkYXRhfkRvbUV2ZW50RGF0YX0gZGF0YSBEYXRhIG9mIHRoZSBrZXkgcHJlc3MuCiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gYHRydWVgIHdoZW4gdGhlIGhhbmRsZXIgcHJldmVudGVkIGNhcmV0IG1vdmVtZW50CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaGFuZGxlQmFja3dhcmRNb3ZlbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlQmFja3dhcmRNb3ZlbWVudChwb3NpdGlvbiwgZGF0YSkgewogICAgICB2YXIgYXR0cmlidXRlID0gdGhpcy5hdHRyaWJ1dGU7IC8vIFdoZW4gdGhlIGdyYXZpdHkgaXMgYWxyZWFkeSBvdmVycmlkZGVuLi4uCgogICAgICBpZiAodGhpcy5faXNHcmF2aXR5T3ZlcnJpZGRlbikgewogICAgICAgIC8vIEVOR0FHRSAyLVNDTSAmIFJFTU9WRSBTRUxFQ1RJT04gQVRUUklCVVRFCiAgICAgICAgLy8gd2hlbiBhYm91dCB0byBsZWF2ZSBvbmUgYXR0cmlidXRlIHZhbHVlIGFuZCBlbnRlciBhbm90aGVyOgogICAgICAgIC8vCiAgICAgICAgLy8gCQk8cGFyYWdyYXBoPjwkdGV4dCBhdHRyaWJ1dGU9IjEiPmZvbzwvJHRleHQ+PCR0ZXh0IGF0dHJpYnV0ZT0iMiI+e31iYXI8LyR0ZXh0PjwvcGFyYWdyYXBoPgogICAgICAgIC8vCiAgICAgICAgLy8gYnV0IERPTidUIHdoZW4gYWxyZWFkeSBpbiBiZXR3ZWVuIG9mIHRoZW0gKG5vIGF0dHJpYnV0ZSBzZWxlY3Rpb24pOgogICAgICAgIC8vCiAgICAgICAgLy8gCQk8cGFyYWdyYXBoPjwkdGV4dCBhdHRyaWJ1dGU9IjEiPmZvbzwvJHRleHQ+e308JHRleHQgYXR0cmlidXRlPSIyIj5iYXI8LyR0ZXh0PjwvcGFyYWdyYXBoPgogICAgICAgIC8vCiAgICAgICAgaWYgKGlzQmV0d2VlbkRpZmZlcmVudFZhbHVlcyhwb3NpdGlvbiwgYXR0cmlidXRlKSAmJiB0aGlzLl9oYXNTZWxlY3Rpb25BdHRyaWJ1dGUpIHsKICAgICAgICAgIHRoaXMuX3ByZXZlbnRDYXJldE1vdmVtZW50KGRhdGEpOwoKICAgICAgICAgIHRoaXMuX3Jlc3RvcmVHcmF2aXR5KCk7CgogICAgICAgICAgdGhpcy5fcmVtb3ZlU2VsZWN0aW9uQXR0cmlidXRlKCk7CgogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSAvLyBFTkdBR0UgMi1TQ00gd2hlbiBhdCBhbnkgYm91bmRhcnkgb2YgdGhlIGF0dHJpYnV0ZToKICAgICAgICAvLwogICAgICAgIC8vIAkJPHBhcmFncmFwaD5mb288JHRleHQgYXR0cmlidXRlPmJhcjwvJHRleHQ+e31iYXo8L3BhcmFncmFwaD4KICAgICAgICAvLyAJCTxwYXJhZ3JhcGg+Zm9vPCR0ZXh0IGF0dHJpYnV0ZT57fWJhcjwvJHRleHQ+YmF6PC9wYXJhZ3JhcGg+CiAgICAgICAgLy8KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgdGhpcy5fcHJldmVudENhcmV0TW92ZW1lbnQoZGF0YSk7CgogICAgICAgICAgICB0aGlzLl9yZXN0b3JlR3Jhdml0eSgpOyAvLyBSRU1PVkUgU0VMRUNUSU9OIEFUUklCVVRFIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIGJsb2NrLgogICAgICAgICAgICAvLyBJdCdzIGxpa2UgcmVzdG9yaW5nIGdyYXZpdHkgYnV0IHRvd2FyZHMgYSBub24tZXhpc3RlbnQgY29udGVudCB3aGVuCiAgICAgICAgICAgIC8vIHRoZSBncmF2aXR5IGlzIG92ZXJyaWRkZW46CiAgICAgICAgICAgIC8vCiAgICAgICAgICAgIC8vIAkJPHBhcmFncmFwaD48JHRleHQgYXR0cmlidXRlPnt9YmFyPC8kdGV4dD48L3BhcmFncmFwaD4KICAgICAgICAgICAgLy8KICAgICAgICAgICAgLy8gYmVjb21lczoKICAgICAgICAgICAgLy8KICAgICAgICAgICAgLy8gCQk8cGFyYWdyYXBoPnt9PCR0ZXh0IGF0dHJpYnV0ZT5iYXI8LyR0ZXh0PjwvcGFyYWdyYXBoPgogICAgICAgICAgICAvLwoKCiAgICAgICAgICAgIGlmIChwb3NpdGlvbi5pc0F0U3RhcnQpIHsKICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVTZWxlY3Rpb25BdHRyaWJ1dGUoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gRU5HQUdFIDItU0NNIHdoZW4gYmV0d2VlbiB0d28gZGlmZmVyZW50IGF0dHJpYnV0ZSB2YWx1ZXMgYnV0IHNlbGVjdGlvbiBoYXMgbm8gYXR0cmlidXRlOgogICAgICAgIC8vCiAgICAgICAgLy8gCQk8cGFyYWdyYXBoPjwkdGV4dCBhdHRyaWJ1dGU9IjEiPmZvbzwvJHRleHQ+e308JHRleHQgYXR0cmlidXRlPSIyIj5iYXI8LyR0ZXh0PjwvcGFyYWdyYXBoPgogICAgICAgIC8vCiAgICAgICAgaWYgKGlzQmV0d2VlbkRpZmZlcmVudFZhbHVlcyhwb3NpdGlvbiwgYXR0cmlidXRlKSAmJiAhdGhpcy5faGFzU2VsZWN0aW9uQXR0cmlidXRlKSB7CiAgICAgICAgICB0aGlzLl9wcmV2ZW50Q2FyZXRNb3ZlbWVudChkYXRhKTsKCiAgICAgICAgICB0aGlzLl9zZXRTZWxlY3Rpb25BdHRyaWJ1dGVGcm9tVGhlTm9kZUJlZm9yZShwb3NpdGlvbik7CgogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSAvLyBFbmQgb2YgYmxvY2sgYm91bmRhcnkgY2FzZXM6CiAgICAgICAgLy8KICAgICAgICAvLyAJCTxwYXJhZ3JhcGg+PCR0ZXh0IGF0dHJpYnV0ZT5iYXJ7fTwvJHRleHQ+PC9wYXJhZ3JhcGg+CiAgICAgICAgLy8gCQk8cGFyYWdyYXBoPjwkdGV4dCBhdHRyaWJ1dGU+YmFyPC8kdGV4dD57fTwvcGFyYWdyYXBoPgogICAgICAgIC8vCgoKICAgICAgICBpZiAocG9zaXRpb24uaXNBdEVuZCAmJiBpc0F0RW5kQm91bmRhcnkocG9zaXRpb24sIGF0dHJpYnV0ZSkpIHsKICAgICAgICAgIC8vIERPTidUIEVOR0FHRSAyLVNDTSBpZiB0aGUgc2VsZWN0aW9uIGhhcyB0aGUgYXR0cmlidXRlIGFscmVhZHkuCiAgICAgICAgICAvLyBUaGlzIGlzIGEgY29tbW9uIHNlbGVjdGlvbiBpZiBzZXQgdXNpbmcgdGhlIG1vdXNlLgogICAgICAgICAgLy8KICAgICAgICAgIC8vIAkJPHBhcmFncmFwaD48JHRleHQgYXR0cmlidXRlPmJhcnt9PC8kdGV4dD48L3BhcmFncmFwaD4KICAgICAgICAgIC8vCiAgICAgICAgICBpZiAodGhpcy5faGFzU2VsZWN0aW9uQXR0cmlidXRlKSB7CiAgICAgICAgICAgIC8vIERPTidUIEVOR0FHRSAyLVNDTSBpZiB0aGUgYXR0cmlidXRlIGF0IHRoZSBlbmQgb2YgdGhlIGJsb2NrIHdoaWNoIGhhcyBsZW5ndGggPT0gMS4KICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRoZSBzZWxlY3Rpb24gd2lsbCBub3QgdGhlIGF0dHJpYnV0ZSBhZnRlciBpdCBtb3ZlcyBiYWNrd2FyZHMuCiAgICAgICAgICAgIC8vCiAgICAgICAgICAgIC8vIAkJPHBhcmFncmFwaD5mb288JHRleHQgYXR0cmlidXRlPmJ7fTwvJHRleHQ+PC9wYXJhZ3JhcGg+CiAgICAgICAgICAgIC8vCiAgICAgICAgICAgIGlmIChpc1N0ZXBBZnRlclRoZUF0dHJpYnV0ZUJvdW5kYXJ5KHBvc2l0aW9uLCBhdHRyaWJ1dGUpKSB7CiAgICAgICAgICAgICAgLy8gU2tpcCB0aGUgYXV0b21hdGljIGdyYXZpdHkgcmVzdG9yZSB1cG9uIHRoZSBuZXh0IHNlbGVjdGlvbiNjaGFuZ2U6cmFuZ2UgZXZlbnQuCiAgICAgICAgICAgICAgLy8gSWYgbm90IHNraXBwZWQsIGl0IHdvdWxkIGF1dG9tYXRpY2FsbHkgcmVzdG9yZSB0aGUgZ3Jhdml0eSwgd2hpY2ggc2hvdWxkIHJlbWFpbgogICAgICAgICAgICAgIC8vIG92ZXJyaWRkZW4uCiAgICAgICAgICAgICAgdGhpcy5fc2tpcE5leHRBdXRvbWF0aWNHcmF2aXR5UmVzdG9yYXRpb24oKTsKCiAgICAgICAgICAgICAgdGhpcy5fb3ZlcnJpZGVHcmF2aXR5KCk7IC8vIERvbid0IHJldHVybiAidHJ1ZSIgaGVyZSBiZWNhdXNlIHdlIGRpZG4ndCBjYWxsIF9wcmV2ZW50Q2FyZXRNb3ZlbWVudC4KICAgICAgICAgICAgICAvLyBSZXR1cm5pbmcgaGVyZSB3aWxsIGRlc3RhYmlsaXplIHRoZSBmaWxsZXIgbG9naWMsIHdoaWNoIGFsc28gbGlzdGVucyB0bwogICAgICAgICAgICAgIC8vIGtleWRvd24gKGFuZCB0aGUgZXZlbnQgd291bGQgYmUgc3RvcHBlZCkuCgogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9IC8vIEVOR0FHRSAyLVNDTSBpZiB0aGUgc2VsZWN0aW9uIGhhcyBubyBhdHRyaWJ1dGUuIFRoaXMgbWF5IGhhcHBlbiB3aGVuIHRoZSB1c2VyCiAgICAgICAgICAvLyBsZWZ0IHRoZSBhdHRyaWJ1dGUgdXNpbmcgYSBGT1JXQVJEIDItU0NNLgogICAgICAgICAgLy8KICAgICAgICAgIC8vIAkJPHBhcmFncmFwaD48JHRleHQgYXR0cmlidXRlPmJhcjwvJHRleHQ+e308L3BhcmFncmFwaD4KICAgICAgICAgIC8vCiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLl9wcmV2ZW50Q2FyZXRNb3ZlbWVudChkYXRhKTsKCiAgICAgICAgICAgICAgdGhpcy5fc2V0U2VsZWN0aW9uQXR0cmlidXRlRnJvbVRoZU5vZGVCZWZvcmUocG9zaXRpb24pOwoKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0gLy8gUkVNT1ZFIFNFTEVDVElPTiBBVFJJQlVURSB3aGVuIHJlc3RvcmluZyBncmF2aXR5IHRvd2FyZHMgYSBub24tZXhpc3RlbnQgY29udGVudCBhdCB0aGUKICAgICAgICAvLyBiZWdpbm5pbmcgb2YgdGhlIGJsb2NrLgogICAgICAgIC8vCiAgICAgICAgLy8gCQk8cGFyYWdyYXBoPnt9PCR0ZXh0IGF0dHJpYnV0ZT5iYXI8LyR0ZXh0PjwvcGFyYWdyYXBoPgogICAgICAgIC8vCgoKICAgICAgICBpZiAocG9zaXRpb24uaXNBdFN0YXJ0KSB7CiAgICAgICAgICBpZiAodGhpcy5faGFzU2VsZWN0aW9uQXR0cmlidXRlKSB7CiAgICAgICAgICAgIHRoaXMuX3JlbW92ZVNlbGVjdGlvbkF0dHJpYnV0ZSgpOwoKICAgICAgICAgICAgdGhpcy5fcHJldmVudENhcmV0TW92ZW1lbnQoZGF0YSk7CgogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSAvLyBET04nVCBFTkdBR0UgMi1TQ00gd2hlbiBhYm91dCB0byBlbnRlciBvZiBsZWF2ZSBhbiBhdHRyaWJ1dGUuCiAgICAgICAgLy8gV2UgbmVlZCB0byBjaGVjayBpZiB0aGUgY2FyZXQgaXMgYSBvbmUgcG9zaXRpb24gYmVmb3JlIHRoZSBhdHRyaWJ1dGUgYm91bmRhcnk6CiAgICAgICAgLy8KICAgICAgICAvLyAJCTxwYXJhZ3JhcGg+Zm9vPCR0ZXh0IGF0dHJpYnV0ZT5ie31hcjwvJHRleHQ+YmF6PC9wYXJhZ3JhcGg+CiAgICAgICAgLy8gCQk8cGFyYWdyYXBoPmZvbzwkdGV4dCBhdHRyaWJ1dGU+YmFyPC8kdGV4dD5ie31hejwvcGFyYWdyYXBoPgogICAgICAgIC8vCgoKICAgICAgICBpZiAoaXNTdGVwQWZ0ZXJUaGVBdHRyaWJ1dGVCb3VuZGFyeShwb3NpdGlvbiwgYXR0cmlidXRlKSkgewogICAgICAgICAgLy8gU2tpcCB0aGUgYXV0b21hdGljIGdyYXZpdHkgcmVzdG9yZSB1cG9uIHRoZSBuZXh0IHNlbGVjdGlvbiNjaGFuZ2U6cmFuZ2UgZXZlbnQuCiAgICAgICAgICAvLyBJZiBub3Qgc2tpcHBlZCwgaXQgd291bGQgYXV0b21hdGljYWxseSByZXN0b3JlIHRoZSBncmF2aXR5LCB3aGljaCBzaG91bGQgcmVtYWluCiAgICAgICAgICAvLyBvdmVycmlkZGVuLgogICAgICAgICAgdGhpcy5fc2tpcE5leHRBdXRvbWF0aWNHcmF2aXR5UmVzdG9yYXRpb24oKTsKCiAgICAgICAgICB0aGlzLl9vdmVycmlkZUdyYXZpdHkoKTsgLy8gRG9uJ3QgcmV0dXJuICJ0cnVlIiBoZXJlIGJlY2F1c2Ugd2UgZGlkbid0IGNhbGwgX3ByZXZlbnRDYXJldE1vdmVtZW50LgogICAgICAgICAgLy8gUmV0dXJuaW5nIGhlcmUgd2lsbCBkZXN0YWJpbGl6ZSB0aGUgZmlsbGVyIGxvZ2ljLCB3aGljaCBhbHNvIGxpc3RlbnMgdG8KICAgICAgICAgIC8vIGtleWRvd24gKGFuZCB0aGUgZXZlbnQgd291bGQgYmUgc3RvcHBlZCkuCgogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBgdHJ1ZWAgd2hlbiB0aGUgZ3Jhdml0eSBpcyBvdmVycmlkZGVuIGZvciB0aGUge0BsaW5rICNhdHRyaWJ1dGV9LgogICAgICoKICAgICAqIEByZWFkb25seQogICAgICogQHByaXZhdGUKICAgICAqIEB0eXBlIHtCb29sZWFufQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9vdmVycmlkZUdyYXZpdHkiLAoKICAgIC8qKgogICAgICogT3ZlcnJpZGVzIHRoZSBncmF2aXR5IHVzaW5nIHRoZSB7QGxpbmsgbW9kdWxlOmVuZ2luZS9tb2RlbC93cml0ZXJ+V3JpdGVyIG1vZGVsIHdyaXRlcn0KICAgICAqIGFuZCBzdG9yZXMgdGhlIGluZm9ybWF0aW9uIGFib3V0IHRoaXMgZmFjdCBpbiB0aGUge0BsaW5rICNfb3ZlcnJpZGVVaWR9LgogICAgICoKICAgICAqIEEgc2hvcnRoYW5kIGZvciB7QGxpbmsgbW9kdWxlOmVuZ2luZS9tb2RlbC93cml0ZXJ+V3JpdGVyI292ZXJyaWRlU2VsZWN0aW9uR3Jhdml0eX0uCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIF9vdmVycmlkZUdyYXZpdHkoKSB7CiAgICAgIHRoaXMuX292ZXJyaWRlVWlkID0gdGhpcy5tb2RlbC5jaGFuZ2UoZnVuY3Rpb24gKHdyaXRlcikgewogICAgICAgIHJldHVybiB3cml0ZXIub3ZlcnJpZGVTZWxlY3Rpb25HcmF2aXR5KCk7CiAgICAgIH0pOwogICAgfQogICAgLyoqCiAgICAgKiBSZXN0b3JlcyB0aGUgZ3Jhdml0eSB1c2luZyB0aGUge0BsaW5rIG1vZHVsZTplbmdpbmUvbW9kZWwvd3JpdGVyfldyaXRlciBtb2RlbCB3cml0ZXJ9LgogICAgICoKICAgICAqIEEgc2hvcnRoYW5kIGZvciB7QGxpbmsgbW9kdWxlOmVuZ2luZS9tb2RlbC93cml0ZXJ+V3JpdGVyI3Jlc3RvcmVTZWxlY3Rpb25HcmF2aXR5fS4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9yZXN0b3JlR3Jhdml0eSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3Jlc3RvcmVHcmF2aXR5KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMubW9kZWwuY2hhbmdlKGZ1bmN0aW9uICh3cml0ZXIpIHsKICAgICAgICB3cml0ZXIucmVzdG9yZVNlbGVjdGlvbkdyYXZpdHkoX3RoaXMyLl9vdmVycmlkZVVpZCk7CiAgICAgICAgX3RoaXMyLl9vdmVycmlkZVVpZCA9IG51bGw7CiAgICAgIH0pOwogICAgfQogICAgLyoqCiAgICAgKiBQcmV2ZW50cyB0aGUgY2FyZXQgbW92ZW1lbnQgaW4gdGhlIHZpZXcgYnkgY2FsbGluZyBgcHJldmVudERlZmF1bHRgIG9uIHRoZSBldmVudCBkYXRhLgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3ByZXZlbnRDYXJldE1vdmVtZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcHJldmVudENhcmV0TW92ZW1lbnQoZGF0YSkgewogICAgICBkYXRhLnByZXZlbnREZWZhdWx0KCk7CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZXMgdGhlIHtAbGluayAjYXR0cmlidXRlfSBmcm9tIHRoZSBzZWxlY3Rpb24gdXNpbmcgdXNpbmcgdGhlCiAgICAgKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS9tb2RlbC93cml0ZXJ+V3JpdGVyIG1vZGVsIHdyaXRlcn0uCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfcmVtb3ZlU2VsZWN0aW9uQXR0cmlidXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVtb3ZlU2VsZWN0aW9uQXR0cmlidXRlKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMubW9kZWwuY2hhbmdlKGZ1bmN0aW9uICh3cml0ZXIpIHsKICAgICAgICB3cml0ZXIucmVtb3ZlU2VsZWN0aW9uQXR0cmlidXRlKF90aGlzMy5hdHRyaWJ1dGUpOwogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogQXBwbGllcyB0aGUge0BsaW5rICNhdHRyaWJ1dGV9IHRvIHRoZSBjdXJyZW50IHNlbGVjdGlvbiB1c2luZyB1c2luZyB0aGUKICAgICAqIHZhbHVlIGZyb20gdGhlIG5vZGUgYmVmb3JlIHRoZSBjdXJyZW50IHBvc2l0aW9uLiBVc2VzCiAgICAgKiB0aGUge0BsaW5rIG1vZHVsZTplbmdpbmUvbW9kZWwvd3JpdGVyfldyaXRlciBtb2RlbCB3cml0ZXJ9LgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKiBAcGFyYW0ge21vZHVsZTplbmdpbmUvbW9kZWwvcG9zaXRpb25+UG9zaXRpb259IHBvc2l0aW9uCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3NldFNlbGVjdGlvbkF0dHJpYnV0ZUZyb21UaGVOb2RlQmVmb3JlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0U2VsZWN0aW9uQXR0cmlidXRlRnJvbVRoZU5vZGVCZWZvcmUocG9zaXRpb24pIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB2YXIgYXR0cmlidXRlID0gdGhpcy5hdHRyaWJ1dGU7CiAgICAgIHRoaXMubW9kZWwuY2hhbmdlKGZ1bmN0aW9uICh3cml0ZXIpIHsKICAgICAgICB3cml0ZXIuc2V0U2VsZWN0aW9uQXR0cmlidXRlKF90aGlzNC5hdHRyaWJ1dGUsIHBvc2l0aW9uLm5vZGVCZWZvcmUuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZSkpOwogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogU2tpcHMgdGhlIG5leHQgYXV0b21hdGljIHNlbGVjdGlvbiBncmF2aXR5IHJlc3RvcmF0aW9uIHVwb24gdGhlCiAgICAgKiB7QGxpbmsgbW9kdWxlOmVuZ2luZS9tb2RlbC9zZWxlY3Rpb25+U2VsZWN0aW9uI2V2ZW50OmNoYW5nZTpyYW5nZX0gZXZlbnQuCiAgICAgKgogICAgICogU2VlIHtAbGluayAjX2lzTmV4dEdyYXZpdHlSZXN0b3JhdGlvblNraXBwZWR9LgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3NraXBOZXh0QXV0b21hdGljR3Jhdml0eVJlc3RvcmF0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfc2tpcE5leHRBdXRvbWF0aWNHcmF2aXR5UmVzdG9yYXRpb24oKSB7CiAgICAgIHRoaXMuX2lzTmV4dEdyYXZpdHlSZXN0b3JhdGlvblNraXBwZWQgPSB0cnVlOwogICAgfQogIH0sIHsKICAgIGtleTogIl9pc0dyYXZpdHlPdmVycmlkZGVuIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gISF0aGlzLl9vdmVycmlkZVVpZDsKICAgIH0KICAgIC8qKgogICAgICogYHRydWVgIHdoZW4gdGhlIHtAbGluayBtb2R1bGU6ZW5naW5lL21vZGVsL3NlbGVjdGlvbn5TZWxlY3Rpb259IGhhcyB0aGUge0BsaW5rICNhdHRyaWJ1dGV9LgogICAgICoKICAgICAqIEByZWFkb25seQogICAgICogQHByaXZhdGUKICAgICAqIEB0eXBlIHtCb29sZWFufQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9oYXNTZWxlY3Rpb25BdHRyaWJ1dGUiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9tb2RlbFNlbGVjdGlvbi5oYXNBdHRyaWJ1dGUodGhpcy5hdHRyaWJ1dGUpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFR3b1N0ZXBDYXJldEhhbmRsZXI7Cn0oKTsgLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL21vZGVsL3Bvc2l0aW9uflBvc2l0aW9ufSBwb3NpdGlvbgovLyBAcGFyYW0ge1N0cmluZ30gYXR0cmlidXRlCi8vIEByZXR1cm5zIHtCb29sZWFufSBgdHJ1ZWAgd2hlbiBwb3NpdGlvbiBiZXR3ZWVuIHRoZSBub2RlcyBzdGlja3MgdG8gdGhlIGJvdW5kIG9mIHRleHQgd2l0aCBnaXZlbiBhdHRyaWJ1dGUuCgpmdW5jdGlvbiBpc0F0Qm91bmRhcnkocG9zaXRpb24sIGF0dHJpYnV0ZSkgewogIHJldHVybiBpc0F0U3RhcnRCb3VuZGFyeShwb3NpdGlvbiwgYXR0cmlidXRlKSB8fCBpc0F0RW5kQm91bmRhcnkocG9zaXRpb24sIGF0dHJpYnV0ZSk7Cn0gLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL21vZGVsL3Bvc2l0aW9uflBvc2l0aW9ufSBwb3NpdGlvbgovLyBAcGFyYW0ge1N0cmluZ30gYXR0cmlidXRlCgoKZnVuY3Rpb24gaXNBdFN0YXJ0Qm91bmRhcnkocG9zaXRpb24sIGF0dHJpYnV0ZSkgewogIHZhciBub2RlQmVmb3JlID0gcG9zaXRpb24ubm9kZUJlZm9yZSwKICAgICAgbm9kZUFmdGVyID0gcG9zaXRpb24ubm9kZUFmdGVyOwogIHZhciBpc0F0dHJCZWZvcmUgPSBub2RlQmVmb3JlID8gbm9kZUJlZm9yZS5oYXNBdHRyaWJ1dGUoYXR0cmlidXRlKSA6IGZhbHNlOwogIHZhciBpc0F0dHJBZnRlciA9IG5vZGVBZnRlciA/IG5vZGVBZnRlci5oYXNBdHRyaWJ1dGUoYXR0cmlidXRlKSA6IGZhbHNlOwogIHJldHVybiBpc0F0dHJBZnRlciAmJiAoIWlzQXR0ckJlZm9yZSB8fCBub2RlQmVmb3JlLmdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpICE9PSBub2RlQWZ0ZXIuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZSkpOwp9IC8vIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS9tb2RlbC9wb3NpdGlvbn5Qb3NpdGlvbn0gcG9zaXRpb24KLy8gQHBhcmFtIHtTdHJpbmd9IGF0dHJpYnV0ZQoKCmZ1bmN0aW9uIGlzQXRFbmRCb3VuZGFyeShwb3NpdGlvbiwgYXR0cmlidXRlKSB7CiAgdmFyIG5vZGVCZWZvcmUgPSBwb3NpdGlvbi5ub2RlQmVmb3JlLAogICAgICBub2RlQWZ0ZXIgPSBwb3NpdGlvbi5ub2RlQWZ0ZXI7CiAgdmFyIGlzQXR0ckJlZm9yZSA9IG5vZGVCZWZvcmUgPyBub2RlQmVmb3JlLmhhc0F0dHJpYnV0ZShhdHRyaWJ1dGUpIDogZmFsc2U7CiAgdmFyIGlzQXR0ckFmdGVyID0gbm9kZUFmdGVyID8gbm9kZUFmdGVyLmhhc0F0dHJpYnV0ZShhdHRyaWJ1dGUpIDogZmFsc2U7CiAgcmV0dXJuIGlzQXR0ckJlZm9yZSAmJiAoIWlzQXR0ckFmdGVyIHx8IG5vZGVCZWZvcmUuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZSkgIT09IG5vZGVBZnRlci5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlKSk7Cn0gLy8gQHBhcmFtIHttb2R1bGU6ZW5naW5lL21vZGVsL3Bvc2l0aW9uflBvc2l0aW9ufSBwb3NpdGlvbgovLyBAcGFyYW0ge1N0cmluZ30gYXR0cmlidXRlCgoKZnVuY3Rpb24gaXNCZXR3ZWVuRGlmZmVyZW50VmFsdWVzKHBvc2l0aW9uLCBhdHRyaWJ1dGUpIHsKICB2YXIgbm9kZUJlZm9yZSA9IHBvc2l0aW9uLm5vZGVCZWZvcmUsCiAgICAgIG5vZGVBZnRlciA9IHBvc2l0aW9uLm5vZGVBZnRlcjsKICB2YXIgaXNBdHRyQmVmb3JlID0gbm9kZUJlZm9yZSA/IG5vZGVCZWZvcmUuaGFzQXR0cmlidXRlKGF0dHJpYnV0ZSkgOiBmYWxzZTsKICB2YXIgaXNBdHRyQWZ0ZXIgPSBub2RlQWZ0ZXIgPyBub2RlQWZ0ZXIuaGFzQXR0cmlidXRlKGF0dHJpYnV0ZSkgOiBmYWxzZTsKCiAgaWYgKCFpc0F0dHJBZnRlciB8fCAhaXNBdHRyQmVmb3JlKSB7CiAgICByZXR1cm47CiAgfQoKICByZXR1cm4gbm9kZUFmdGVyLmdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpICE9PSBub2RlQmVmb3JlLmdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpOwp9IC8vIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS9tb2RlbC9wb3NpdGlvbn5Qb3NpdGlvbn0gcG9zaXRpb24KLy8gQHBhcmFtIHtTdHJpbmd9IGF0dHJpYnV0ZQoKCmZ1bmN0aW9uIGlzU3RlcEFmdGVyVGhlQXR0cmlidXRlQm91bmRhcnkocG9zaXRpb24sIGF0dHJpYnV0ZSkgewogIHJldHVybiBpc0F0Qm91bmRhcnkocG9zaXRpb24uZ2V0U2hpZnRlZEJ5KC0xKSwgYXR0cmlidXRlKTsKfQ=="},{"version":3,"sources":["C:/Users/pc/Desktop/Restoran/Restoran/Restoran.UI/client/node_modules/@ckeditor/ckeditor5-engine/src/utils/bindtwostepcarettoattribute.js"],"names":["keyCodes","priorities","bindTwoStepCaretToAttribute","view","model","emitter","attribute","locale","twoStepCaretHandler","TwoStepCaretHandler","modelSelection","document","selection","listenTo","evt","data","isCollapsed","shiftKey","altKey","ctrlKey","arrowRightPressed","keyCode","arrowright","arrowLeftPressed","arrowleft","position","getFirstPosition","contentDirection","contentLanguageDirection","isMovementHandled","handleForwardMovement","handleBackwardMovement","stop","priority","get","_modelSelection","_overrideUid","_isNextGravityRestorationSkipped","_isGravityOverridden","directChange","isAtBoundary","_restoreGravity","isAtStart","_hasSelectionAttribute","isBetweenDifferentValues","_preventCaretMovement","_removeSelectionAttribute","isAtStartBoundary","_overrideGravity","isAtEndBoundary","_setSelectionAttributeFromTheNodeBefore","isAtEnd","isStepAfterTheAttributeBoundary","_skipNextAutomaticGravityRestoration","change","writer","overrideSelectionGravity","restoreSelectionGravity","preventDefault","removeSelectionAttribute","setSelectionAttribute","nodeBefore","getAttribute","hasAttribute","nodeAfter","isAttrBefore","isAttrAfter","getShiftedBy"],"mappings":"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","sourcesContent":["/**\n * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module engine/utils/bindtwostepcarettoattribute\n */\n\nimport { keyCodes } from '@ckeditor/ckeditor5-utils/src/keyboard';\nimport priorities from '@ckeditor/ckeditor5-utils/src/priorities';\n\n/**\n * This helper enables the two-step caret (phantom) movement behavior for the given {@link module:engine/model/model~Model}\n * attribute on arrow right (<kbd>→</kbd>) and left (<kbd>←</kbd>) key press.\n *\n * Thanks to this (phantom) caret movement the user is able to type before/after as well as at the\n * beginning/end of an attribute.\n *\n * **Note:** This helper support right–to–left (Arabic, Hebrew, etc.) content by mirroring its behavior\n * but for the sake of simplicity examples showcase only left–to–right use–cases.\n *\n * # Forward movement\n *\n * ## \"Entering\" an attribute:\n *\n * When this behavior is enabled for the `a` attribute and the selection is right before it\n * (at the attribute boundary), pressing the right arrow key will not move the selection but update its\n * attributes accordingly:\n *\n * * When enabled:\n *\n *   \t\tfoo{}<$text a=\"true\">bar</$text>\n *\n *    <kbd>→</kbd>\n *\n *   \t\tfoo<$text a=\"true\">{}bar</$text>\n *\n * * When disabled:\n *\n *   \t\tfoo{}<$text a=\"true\">bar</$text>\n *\n *   <kbd>→</kbd>\n *\n *   \t\tfoo<$text a=\"true\">b{}ar</$text>\n *\n *\n * ## \"Leaving\" an attribute:\n *\n * * When enabled:\n *\n *   \t\t<$text a=\"true\">bar{}</$text>baz\n *\n *    <kbd>→</kbd>\n *\n *   \t\t<$text a=\"true\">bar</$text>{}baz\n *\n * * When disabled:\n *\n *   \t\t<$text a=\"true\">bar{}</$text>baz\n *\n *   <kbd>→</kbd>\n *\n *   \t\t<$text a=\"true\">bar</$text>b{}az\n *\n * # Backward movement\n *\n * * When enabled:\n *\n *   \t\t<$text a=\"true\">bar</$text>{}baz\n *\n *    <kbd>←</kbd>\n *\n *   \t\t<$text a=\"true\">bar{}</$text>baz\n *\n * * When disabled:\n *\n *   \t\t<$text a=\"true\">bar</$text>{}baz\n *\n *   <kbd>←</kbd>\n *\n *   \t\t<$text a=\"true\">ba{}r</$text>b{}az\n *\n * @param {Object} options Helper options.\n * @param {module:engine/view/view~View} options.view View controller instance.\n * @param {module:engine/model/model~Model} options.model Data model instance.\n * @param {module:utils/dom/emittermixin~Emitter} options.emitter The emitter to which this behavior should be added\n * (e.g. a plugin instance).\n * @param {String} options.attribute Attribute for which this behavior will be added.\n * @param {module:utils/locale~Locale} options.locale The {@link module:core/editor/editor~Editor#locale} instance.\n */\nexport default function bindTwoStepCaretToAttribute( { view, model, emitter, attribute, locale } ) {\n\tconst twoStepCaretHandler = new TwoStepCaretHandler( model, emitter, attribute );\n\tconst modelSelection = model.document.selection;\n\n\t// Listen to keyboard events and handle the caret movement according to the 2-step caret logic.\n\t//\n\t// Note: This listener has the \"high+1\" priority:\n\t// * \"high\" because of the filler logic implemented in the renderer which also engages on #keydown.\n\t// When the gravity is overridden the attributes of the (model) selection attributes are reset.\n\t// It may end up with the filler kicking in and breaking the selection.\n\t// * \"+1\" because we would like to avoid collisions with other features (like Widgets), which\n\t// take over the keydown events with the \"high\" priority. Two-step caret movement takes precedence\n\t// over Widgets in that matter.\n\t//\n\t// Find out more in https://github.com/ckeditor/ckeditor5-engine/issues/1301.\n\temitter.listenTo( view.document, 'keydown', ( evt, data ) => {\n\t\t// This implementation works only for collapsed selection.\n\t\tif ( !modelSelection.isCollapsed ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// When user tries to expand the selection or jump over the whole word or to the beginning/end then\n\t\t// two-steps movement is not necessary.\n\t\tif ( data.shiftKey || data.altKey || data.ctrlKey ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst arrowRightPressed = data.keyCode == keyCodes.arrowright;\n\t\tconst arrowLeftPressed = data.keyCode == keyCodes.arrowleft;\n\n\t\t// When neither left or right arrow has been pressed then do noting.\n\t\tif ( !arrowRightPressed && !arrowLeftPressed ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst position = modelSelection.getFirstPosition();\n\t\tconst contentDirection = locale.contentLanguageDirection;\n\t\tlet isMovementHandled;\n\n\t\tif ( ( contentDirection === 'ltr' && arrowRightPressed ) || ( contentDirection === 'rtl' && arrowLeftPressed ) ) {\n\t\t\tisMovementHandled = twoStepCaretHandler.handleForwardMovement( position, data );\n\t\t} else {\n\t\t\tisMovementHandled = twoStepCaretHandler.handleBackwardMovement( position, data );\n\t\t}\n\n\t\t// Stop the keydown event if the two-step caret movement handled it. Avoid collisions\n\t\t// with other features which may also take over the caret movement (e.g. Widget).\n\t\tif ( isMovementHandled ) {\n\t\t\tevt.stop();\n\t\t}\n\t}, { priority: priorities.get( 'high' ) + 1 } );\n}\n\n/**\n * This is a protected helper–class for {@link module:engine/utils/bindtwostepcarettoattribute}.\n * It handles the state of the 2-step caret movement for a single {@link module:engine/model/model~Model}\n * attribute upon the `keypress` in the {@link module:engine/view/view~View}.\n *\n * @protected\n */\nexport class TwoStepCaretHandler {\n\t/*\n\t * Creates two step handler instance.\n\t *\n\t * @param {module:engine/model/model~Model} model Data model instance.\n\t * @param {module:utils/dom/emittermixin~Emitter} emitter The emitter to which this behavior should be added\n\t * (e.g. a plugin instance).\n\t * @param {String} attribute Attribute for which the behavior will be added.\n\t */\n\tconstructor( model, emitter, attribute ) {\n\t\t/**\n\t\t * The model instance this class instance operates on.\n\t\t *\n\t\t * @readonly\n\t\t * @member {module:engine/model/model~Model#schema}\n\t\t */\n\t\tthis.model = model;\n\n\t\t/**\n\t\t * The Attribute this class instance operates on.\n\t\t *\n\t\t * @readonly\n\t\t * @member {String}\n\t\t */\n\t\tthis.attribute = attribute;\n\n\t\t/**\n\t\t * A reference to the document selection.\n\t\t *\n\t\t * @private\n\t\t * @member {module:engine/model/selection~Selection}\n\t\t */\n\t\tthis._modelSelection = model.document.selection;\n\n\t\t/**\n\t\t * The current UID of the overridden gravity, as returned by\n\t\t * {@link module:engine/model/writer~Writer#overrideSelectionGravity}.\n\t\t *\n\t\t * @private\n\t\t * @member {String}\n\t\t */\n\t\tthis._overrideUid = null;\n\n\t\t/**\n\t\t * A flag indicating that the automatic gravity restoration for this attribute\n\t\t * should not happen upon the next\n\t\t * {@link module:engine/model/selection~Selection#event:change:range} event.\n\t\t *\n\t\t * @private\n\t\t * @member {String}\n\t\t */\n\t\tthis._isNextGravityRestorationSkipped = false;\n\n\t\t// The automatic gravity restoration logic.\n\t\temitter.listenTo( this._modelSelection, 'change:range', ( evt, data ) => {\n\t\t\t// Skipping the automatic restoration is needed if the selection should change\n\t\t\t// but the gravity must remain overridden afterwards. See the #handleBackwardMovement\n\t\t\t// to learn more.\n\t\t\tif ( this._isNextGravityRestorationSkipped ) {\n\t\t\t\tthis._isNextGravityRestorationSkipped = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Skip automatic restore when the gravity is not overridden — simply, there's nothing to restore\n\t\t\t// at this moment.\n\t\t\tif ( !this._isGravityOverridden ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Skip automatic restore when the change is indirect AND the selection is at the attribute boundary.\n\t\t\t// It means that e.g. if the change was external (collaboration) and the user had their\n\t\t\t// selection around the link, its gravity should remain intact in this change:range event.\n\t\t\tif ( !data.directChange && isAtBoundary( this._modelSelection.getFirstPosition(), attribute ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._restoreGravity();\n\t\t} );\n\t}\n\n\t/**\n\t * Updates the document selection and the view according to the two–step caret movement state\n\t * when moving **forwards**. Executed upon `keypress` in the {@link module:engine/view/view~View}.\n\t *\n\t * @param {module:engine/model/position~Position} position The model position at the moment of the key press.\n\t * @param {module:engine/view/observer/domeventdata~DomEventData} data Data of the key press.\n\t * @returns {Boolean} `true` when the handler prevented caret movement\n\t */\n\thandleForwardMovement( position, data ) {\n\t\tconst attribute = this.attribute;\n\n\t\t// DON'T ENGAGE 2-SCM if gravity is already overridden. It means that we just entered\n\t\t//\n\t\t// \t\t<paragraph>foo<$text attribute>{}bar</$text>baz</paragraph>\n\t\t//\n\t\t// or left the attribute\n\t\t//\n\t\t// \t\t<paragraph>foo<$text attribute>bar</$text>{}baz</paragraph>\n\t\t//\n\t\t// and the gravity will be restored automatically.\n\t\tif ( this._isGravityOverridden ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// DON'T ENGAGE 2-SCM when the selection is at the beginning of the block AND already has the\n\t\t// attribute:\n\t\t// * when the selection was initially set there using the mouse,\n\t\t// * when the editor has just started\n\t\t//\n\t\t//\t\t<paragraph><$text attribute>{}bar</$text>baz</paragraph>\n\t\t//\n\t\tif ( position.isAtStart && this._hasSelectionAttribute ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// ENGAGE 2-SCM when about to leave one attribute value and enter another:\n\t\t//\n\t\t// \t\t<paragraph><$text attribute=\"1\">foo{}</$text><$text attribute=\"2\">bar</$text></paragraph>\n\t\t//\n\t\t// but DON'T when already in between of them (no attribute selection):\n\t\t//\n\t\t// \t\t<paragraph><$text attribute=\"1\">foo</$text>{}<$text attribute=\"2\">bar</$text></paragraph>\n\t\t//\n\t\tif ( isBetweenDifferentValues( position, attribute ) && this._hasSelectionAttribute ) {\n\t\t\tthis._preventCaretMovement( data );\n\t\t\tthis._removeSelectionAttribute();\n\n\t\t\treturn true;\n\t\t}\n\n\t\t// ENGAGE 2-SCM when entering an attribute:\n\t\t//\n\t\t// \t\t<paragraph>foo{}<$text attribute>bar</$text>baz</paragraph>\n\t\t//\n\t\tif ( isAtStartBoundary( position, attribute ) ) {\n\t\t\tthis._preventCaretMovement( data );\n\t\t\tthis._overrideGravity();\n\n\t\t\treturn true;\n\t\t}\n\n\t\t// ENGAGE 2-SCM when leaving an attribute:\n\t\t//\n\t\t//\t\t<paragraph>foo<$text attribute>bar{}</$text>baz</paragraph>\n\t\t//\n\t\tif ( isAtEndBoundary( position, attribute ) && this._hasSelectionAttribute ) {\n\t\t\tthis._preventCaretMovement( data );\n\t\t\tthis._overrideGravity();\n\n\t\t\treturn true;\n\t\t}\n\t}\n\n\t/**\n\t * Updates the document selection and the view according to the two–step caret movement state\n\t * when moving **backwards**. Executed upon `keypress` in the {@link module:engine/view/view~View}.\n\t *\n\t * @param {module:engine/model/position~Position} position The model position at the moment of the key press.\n\t * @param {module:engine/view/observer/domeventdata~DomEventData} data Data of the key press.\n\t * @returns {Boolean} `true` when the handler prevented caret movement\n\t */\n\thandleBackwardMovement( position, data ) {\n\t\tconst attribute = this.attribute;\n\n\t\t// When the gravity is already overridden...\n\t\tif ( this._isGravityOverridden ) {\n\t\t\t// ENGAGE 2-SCM & REMOVE SELECTION ATTRIBUTE\n\t\t\t// when about to leave one attribute value and enter another:\n\t\t\t//\n\t\t\t// \t\t<paragraph><$text attribute=\"1\">foo</$text><$text attribute=\"2\">{}bar</$text></paragraph>\n\t\t\t//\n\t\t\t// but DON'T when already in between of them (no attribute selection):\n\t\t\t//\n\t\t\t// \t\t<paragraph><$text attribute=\"1\">foo</$text>{}<$text attribute=\"2\">bar</$text></paragraph>\n\t\t\t//\n\t\t\tif ( isBetweenDifferentValues( position, attribute ) && this._hasSelectionAttribute ) {\n\t\t\t\tthis._preventCaretMovement( data );\n\t\t\t\tthis._restoreGravity();\n\t\t\t\tthis._removeSelectionAttribute();\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// ENGAGE 2-SCM when at any boundary of the attribute:\n\t\t\t//\n\t\t\t// \t\t<paragraph>foo<$text attribute>bar</$text>{}baz</paragraph>\n\t\t\t// \t\t<paragraph>foo<$text attribute>{}bar</$text>baz</paragraph>\n\t\t\t//\n\t\t\telse {\n\t\t\t\tthis._preventCaretMovement( data );\n\t\t\t\tthis._restoreGravity();\n\n\t\t\t\t// REMOVE SELECTION ATRIBUTE at the beginning of the block.\n\t\t\t\t// It's like restoring gravity but towards a non-existent content when\n\t\t\t\t// the gravity is overridden:\n\t\t\t\t//\n\t\t\t\t// \t\t<paragraph><$text attribute>{}bar</$text></paragraph>\n\t\t\t\t//\n\t\t\t\t// becomes:\n\t\t\t\t//\n\t\t\t\t// \t\t<paragraph>{}<$text attribute>bar</$text></paragraph>\n\t\t\t\t//\n\t\t\t\tif ( position.isAtStart ) {\n\t\t\t\t\tthis._removeSelectionAttribute();\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\t// ENGAGE 2-SCM when between two different attribute values but selection has no attribute:\n\t\t\t//\n\t\t\t// \t\t<paragraph><$text attribute=\"1\">foo</$text>{}<$text attribute=\"2\">bar</$text></paragraph>\n\t\t\t//\n\t\t\tif ( isBetweenDifferentValues( position, attribute ) && !this._hasSelectionAttribute ) {\n\t\t\t\tthis._preventCaretMovement( data );\n\t\t\t\tthis._setSelectionAttributeFromTheNodeBefore( position );\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// End of block boundary cases:\n\t\t\t//\n\t\t\t// \t\t<paragraph><$text attribute>bar{}</$text></paragraph>\n\t\t\t// \t\t<paragraph><$text attribute>bar</$text>{}</paragraph>\n\t\t\t//\n\t\t\tif ( position.isAtEnd && isAtEndBoundary( position, attribute ) ) {\n\t\t\t\t// DON'T ENGAGE 2-SCM if the selection has the attribute already.\n\t\t\t\t// This is a common selection if set using the mouse.\n\t\t\t\t//\n\t\t\t\t// \t\t<paragraph><$text attribute>bar{}</$text></paragraph>\n\t\t\t\t//\n\t\t\t\tif ( this._hasSelectionAttribute ) {\n\t\t\t\t\t// DON'T ENGAGE 2-SCM if the attribute at the end of the block which has length == 1.\n\t\t\t\t\t// Make sure the selection will not the attribute after it moves backwards.\n\t\t\t\t\t//\n\t\t\t\t\t// \t\t<paragraph>foo<$text attribute>b{}</$text></paragraph>\n\t\t\t\t\t//\n\t\t\t\t\tif ( isStepAfterTheAttributeBoundary( position, attribute ) ) {\n\t\t\t\t\t\t// Skip the automatic gravity restore upon the next selection#change:range event.\n\t\t\t\t\t\t// If not skipped, it would automatically restore the gravity, which should remain\n\t\t\t\t\t\t// overridden.\n\t\t\t\t\t\tthis._skipNextAutomaticGravityRestoration();\n\t\t\t\t\t\tthis._overrideGravity();\n\n\t\t\t\t\t\t// Don't return \"true\" here because we didn't call _preventCaretMovement.\n\t\t\t\t\t\t// Returning here will destabilize the filler logic, which also listens to\n\t\t\t\t\t\t// keydown (and the event would be stopped).\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// ENGAGE 2-SCM if the selection has no attribute. This may happen when the user\n\t\t\t\t// left the attribute using a FORWARD 2-SCM.\n\t\t\t\t//\n\t\t\t\t// \t\t<paragraph><$text attribute>bar</$text>{}</paragraph>\n\t\t\t\t//\n\t\t\t\telse {\n\t\t\t\t\tthis._preventCaretMovement( data );\n\t\t\t\t\tthis._setSelectionAttributeFromTheNodeBefore( position );\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// REMOVE SELECTION ATRIBUTE when restoring gravity towards a non-existent content at the\n\t\t\t// beginning of the block.\n\t\t\t//\n\t\t\t// \t\t<paragraph>{}<$text attribute>bar</$text></paragraph>\n\t\t\t//\n\t\t\tif ( position.isAtStart ) {\n\t\t\t\tif ( this._hasSelectionAttribute ) {\n\t\t\t\t\tthis._removeSelectionAttribute();\n\t\t\t\t\tthis._preventCaretMovement( data );\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// DON'T ENGAGE 2-SCM when about to enter of leave an attribute.\n\t\t\t// We need to check if the caret is a one position before the attribute boundary:\n\t\t\t//\n\t\t\t// \t\t<paragraph>foo<$text attribute>b{}ar</$text>baz</paragraph>\n\t\t\t// \t\t<paragraph>foo<$text attribute>bar</$text>b{}az</paragraph>\n\t\t\t//\n\t\t\tif ( isStepAfterTheAttributeBoundary( position, attribute ) ) {\n\t\t\t\t// Skip the automatic gravity restore upon the next selection#change:range event.\n\t\t\t\t// If not skipped, it would automatically restore the gravity, which should remain\n\t\t\t\t// overridden.\n\t\t\t\tthis._skipNextAutomaticGravityRestoration();\n\t\t\t\tthis._overrideGravity();\n\n\t\t\t\t// Don't return \"true\" here because we didn't call _preventCaretMovement.\n\t\t\t\t// Returning here will destabilize the filler logic, which also listens to\n\t\t\t\t// keydown (and the event would be stopped).\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * `true` when the gravity is overridden for the {@link #attribute}.\n\t *\n\t * @readonly\n\t * @private\n\t * @type {Boolean}\n\t */\n\tget _isGravityOverridden() {\n\t\treturn !!this._overrideUid;\n\t}\n\n\t/**\n\t * `true` when the {@link module:engine/model/selection~Selection} has the {@link #attribute}.\n\t *\n\t * @readonly\n\t * @private\n\t * @type {Boolean}\n\t */\n\tget _hasSelectionAttribute() {\n\t\treturn this._modelSelection.hasAttribute( this.attribute );\n\t}\n\n\t/**\n\t * Overrides the gravity using the {@link module:engine/model/writer~Writer model writer}\n\t * and stores the information about this fact in the {@link #_overrideUid}.\n\t *\n\t * A shorthand for {@link module:engine/model/writer~Writer#overrideSelectionGravity}.\n\t *\n\t * @private\n\t */\n\t_overrideGravity() {\n\t\tthis._overrideUid = this.model.change( writer => writer.overrideSelectionGravity() );\n\t}\n\n\t/**\n\t * Restores the gravity using the {@link module:engine/model/writer~Writer model writer}.\n\t *\n\t * A shorthand for {@link module:engine/model/writer~Writer#restoreSelectionGravity}.\n\t *\n\t * @private\n\t */\n\t_restoreGravity() {\n\t\tthis.model.change( writer => {\n\t\t\twriter.restoreSelectionGravity( this._overrideUid );\n\t\t\tthis._overrideUid = null;\n\t\t} );\n\t}\n\n\t/**\n\t * Prevents the caret movement in the view by calling `preventDefault` on the event data.\n\t *\n\t * @private\n\t */\n\t_preventCaretMovement( data ) {\n\t\tdata.preventDefault();\n\t}\n\n\t/**\n\t * Removes the {@link #attribute} from the selection using using the\n\t * {@link module:engine/model/writer~Writer model writer}.\n\t *\n\t * @private\n\t */\n\t_removeSelectionAttribute() {\n\t\tthis.model.change( writer => {\n\t\t\twriter.removeSelectionAttribute( this.attribute );\n\t\t} );\n\t}\n\n\t/**\n\t * Applies the {@link #attribute} to the current selection using using the\n\t * value from the node before the current position. Uses\n\t * the {@link module:engine/model/writer~Writer model writer}.\n\t *\n\t * @private\n\t * @param {module:engine/model/position~Position} position\n\t */\n\t_setSelectionAttributeFromTheNodeBefore( position ) {\n\t\tconst attribute = this.attribute;\n\n\t\tthis.model.change( writer => {\n\t\t\twriter.setSelectionAttribute( this.attribute, position.nodeBefore.getAttribute( attribute ) );\n\t\t} );\n\t}\n\n\t/**\n\t * Skips the next automatic selection gravity restoration upon the\n\t * {@link module:engine/model/selection~Selection#event:change:range} event.\n\t *\n\t * See {@link #_isNextGravityRestorationSkipped}.\n\t *\n\t * @private\n\t */\n\t_skipNextAutomaticGravityRestoration() {\n\t\tthis._isNextGravityRestorationSkipped = true;\n\t}\n}\n\n// @param {module:engine/model/position~Position} position\n// @param {String} attribute\n// @returns {Boolean} `true` when position between the nodes sticks to the bound of text with given attribute.\nfunction isAtBoundary( position, attribute ) {\n\treturn isAtStartBoundary( position, attribute ) || isAtEndBoundary( position, attribute );\n}\n\n// @param {module:engine/model/position~Position} position\n// @param {String} attribute\nfunction isAtStartBoundary( position, attribute ) {\n\tconst { nodeBefore, nodeAfter } = position;\n\tconst isAttrBefore = nodeBefore ? nodeBefore.hasAttribute( attribute ) : false;\n\tconst isAttrAfter = nodeAfter ? nodeAfter.hasAttribute( attribute ) : false;\n\n\treturn isAttrAfter && ( !isAttrBefore || nodeBefore.getAttribute( attribute ) !== nodeAfter.getAttribute( attribute ) );\n}\n\n// @param {module:engine/model/position~Position} position\n// @param {String} attribute\nfunction isAtEndBoundary( position, attribute ) {\n\tconst { nodeBefore, nodeAfter } = position;\n\tconst isAttrBefore = nodeBefore ? nodeBefore.hasAttribute( attribute ) : false;\n\tconst isAttrAfter = nodeAfter ? nodeAfter.hasAttribute( attribute ) : false;\n\n\treturn isAttrBefore && ( !isAttrAfter || nodeBefore.getAttribute( attribute ) !== nodeAfter.getAttribute( attribute ) );\n}\n\n// @param {module:engine/model/position~Position} position\n// @param {String} attribute\nfunction isBetweenDifferentValues( position, attribute ) {\n\tconst { nodeBefore, nodeAfter } = position;\n\tconst isAttrBefore = nodeBefore ? nodeBefore.hasAttribute( attribute ) : false;\n\tconst isAttrAfter = nodeAfter ? nodeAfter.hasAttribute( attribute ) : false;\n\n\tif ( !isAttrAfter || !isAttrBefore ) {\n\t\treturn;\n\t}\n\n\treturn nodeAfter.getAttribute( attribute ) !== nodeBefore.getAttribute( attribute );\n}\n\n// @param {module:engine/model/position~Position} position\n// @param {String} attribute\nfunction isStepAfterTheAttributeBoundary( position, attribute ) {\n\treturn isAtBoundary( position.getShiftedBy( -1 ), attribute );\n}\n"]}]}