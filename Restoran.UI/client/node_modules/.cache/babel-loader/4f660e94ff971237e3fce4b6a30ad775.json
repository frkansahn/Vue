{"remainingRequest":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-core\\src\\plugincollection.js","dependencies":[{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-core\\src\\plugincollection.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-dev-webpack-plugin\\lib\\translatesourceloader.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1581760768702},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1581760786382},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1581760768279}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnJlZHVjZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc2V0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7CmltcG9ydCBfc2xpY2VkVG9BcnJheSBmcm9tICJDOlxcVXNlcnNcXHBjXFxEZXNrdG9wXFxSZXN0b3JhblxcUmVzdG9yYW5cXFJlc3RvcmFuLlVJXFxjbGllbnRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL3NsaWNlZFRvQXJyYXkiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkM6XFxVc2Vyc1xccGNcXERlc2t0b3BcXFJlc3RvcmFuXFxSZXN0b3JhblxcUmVzdG9yYW4uVUlcXGNsaWVudFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6XFxVc2Vyc1xccGNcXERlc2t0b3BcXFJlc3RvcmFuXFxSZXN0b3JhblxcUmVzdG9yYW4uVUlcXGNsaWVudFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwoKLyoqCiAqIEBsaWNlbnNlIENvcHlyaWdodCAoYykgMjAwMy0yMDIwLCBDS1NvdXJjZSAtIEZyZWRlcmljbyBLbmFiYmVuLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiBGb3IgbGljZW5zaW5nLCBzZWUgTElDRU5TRS5tZCBvciBodHRwczovL2NrZWRpdG9yLmNvbS9sZWdhbC9ja2VkaXRvci1vc3MtbGljZW5zZQogKi8KCi8qKgogKiBAbW9kdWxlIGNvcmUvcGx1Z2luY29sbGVjdGlvbgogKi8KCi8qIGdsb2JhbHMgY29uc29sZSAqLwppbXBvcnQgQ0tFZGl0b3JFcnJvciwgeyBhdHRhY2hMaW5rVG9Eb2N1bWVudGF0aW9uIH0gZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11dGlscy9zcmMvY2tlZGl0b3JlcnJvcic7CmltcG9ydCBFbWl0dGVyTWl4aW4gZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11dGlscy9zcmMvZW1pdHRlcm1peGluJzsKaW1wb3J0IG1peCBmcm9tICdAY2tlZGl0b3IvY2tlZGl0b3I1LXV0aWxzL3NyYy9taXgnOwovKioKICogTWFuYWdlcyBhIGxpc3Qgb2YgQ0tFZGl0b3IgcGx1Z2lucywgaW5jbHVkaW5nIGxvYWRpbmcsIHJlc29sdmluZyBkZXBlbmRlbmNpZXMgYW5kIGluaXRpYWxpemF0aW9uLgogKgogKiBAbWl4ZXMgbW9kdWxlOnV0aWxzL2VtaXR0ZXJtaXhpbn5FbWl0dGVyTWl4aW4KICovCgp2YXIgUGx1Z2luQ29sbGVjdGlvbiA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKCkgewogIC8qKgogICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgdGhlIHBsdWdpbiBjb2xsZWN0aW9uIGNsYXNzLgogICAqIEFsbG93cyBsb2FkaW5nIGFuZCBpbml0aWFsaXppbmcgcGx1Z2lucyBhbmQgdGhlaXIgZGVwZW5kZW5jaWVzLgogICAqIEFsbG93cyB0byBwcm92aWRlIGEgbGlzdCBvZiBhbHJlYWR5IGxvYWRlZCBwbHVnaW5zLiBUaGVzZSBwbHVnaW5zIHdpbGwgbm90IGJlIGRlc3Ryb3llZCBhbG9uZyB3aXRoIHRoaXMgY29sbGVjdGlvbi4KICAgKgogICAqIEBwYXJhbSB7bW9kdWxlOmNvcmUvZWRpdG9yL2VkaXRvcn5FZGl0b3J8bW9kdWxlOmNvcmUvY29udGV4dH5Db250ZXh0fSBjb250ZXh0CiAgICogQHBhcmFtIHtBcnJheS48RnVuY3Rpb24+fSBbYXZhaWxhYmxlUGx1Z2luc10gUGx1Z2lucyAoY29uc3RydWN0b3JzKSB3aGljaCB0aGUgY29sbGVjdGlvbiB3aWxsIGJlIGFibGUgdG8gdXNlCiAgICogd2hlbiB7QGxpbmsgbW9kdWxlOmNvcmUvcGx1Z2luY29sbGVjdGlvbn5QbHVnaW5Db2xsZWN0aW9uI2luaXR9IGlzIHVzZWQgd2l0aCBwbHVnaW4gbmFtZXMgKHN0cmluZ3MsIGluc3RlYWQgb2YgY29uc3RydWN0b3JzKS4KICAgKiBVc3VhbGx5LCB0aGUgZWRpdG9yIHdpbGwgcGFzcyBpdHMgYnVpbHQtaW4gcGx1Z2lucyB0byB0aGUgY29sbGVjdGlvbiBzbyB0aGV5IGNhbiBsYXRlciBiZQogICAqIHVzZWQgaW4gYGNvbmZpZy5wbHVnaW5zYCBvciBgY29uZmlnLnJlbW92ZVBsdWdpbnNgIGJ5IG5hbWVzLgogICAqIEBwYXJhbSB7SXRlcmFibGUuPEFycmF5Pn0gY29udGV4dFBsdWdpbnMgQSBsaXN0IG9mIGFscmVhZHkgaW5pdGlhbGl6ZWQgcGx1Z2lucyByZXByZXNlbnRlZCBieSBhCiAgICogYFsgUGx1Z2luQ29uc3RydWN0b3IsIHBsdWdpbkluc3RhbmNlIF1gIHBhaXIuCiAgICovCiAgZnVuY3Rpb24gUGx1Z2luQ29sbGVjdGlvbihjb250ZXh0KSB7CiAgICB2YXIgYXZhaWxhYmxlUGx1Z2lucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogW107CiAgICB2YXIgY29udGV4dFBsdWdpbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IFtdOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQbHVnaW5Db2xsZWN0aW9uKTsKCiAgICAvKioKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEB0eXBlIHttb2R1bGU6Y29yZS9lZGl0b3IvZWRpdG9yfkVkaXRvcnxtb2R1bGU6Y29yZS9jb250ZXh0fkNvbnRleHR9CiAgICAgKi8KICAgIHRoaXMuX2NvbnRleHQgPSBjb250ZXh0OwogICAgLyoqCiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAdHlwZSB7TWFwfQogICAgICovCgogICAgdGhpcy5fcGx1Z2lucyA9IG5ldyBNYXAoKTsKICAgIC8qKgogICAgICogQSBtYXAgb2YgcGx1Z2luIGNvbnN0cnVjdG9ycyB0aGF0IGNhbiBiZSByZXRyaWV2ZWQgYnkgdGhlaXIgbmFtZXMuCiAgICAgKgogICAgICogQHByb3RlY3RlZAogICAgICogQHR5cGUge01hcC48U3RyaW5nfEZ1bmN0aW9uLEZ1bmN0aW9uPn0KICAgICAqLwoKICAgIHRoaXMuX2F2YWlsYWJsZVBsdWdpbnMgPSBuZXcgTWFwKCk7CiAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7CiAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IgPSBmYWxzZTsKICAgIHZhciBfaXRlcmF0b3JFcnJvciA9IHVuZGVmaW5lZDsKCiAgICB0cnkgewogICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBhdmFpbGFibGVQbHVnaW5zW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IChfc3RlcCA9IF9pdGVyYXRvci5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZSkgewogICAgICAgIHZhciBQbHVnaW5Db25zdHJ1Y3RvciA9IF9zdGVwLnZhbHVlOwoKICAgICAgICBpZiAoUGx1Z2luQ29uc3RydWN0b3IucGx1Z2luTmFtZSkgewogICAgICAgICAgdGhpcy5fYXZhaWxhYmxlUGx1Z2lucy5zZXQoUGx1Z2luQ29uc3RydWN0b3IucGx1Z2luTmFtZSwgUGx1Z2luQ29uc3RydWN0b3IpOwogICAgICAgIH0KICAgICAgfQogICAgICAvKioKICAgICAgICogTWFwIG9mIHtAbGluayBtb2R1bGU6Y29yZS9jb250ZXh0cGx1Z2lufkNvbnRleHRQbHVnaW4gY29udGV4dCBwbHVnaW5zfSB3aGljaCBjYW4gYmUgcmV0cmlldmVkIGJ5IHRoZWlyIGNvbnN0cnVjdG9ycyBvciBpbnN0YW5jZXMuCiAgICAgICAqCiAgICAgICAqIEBwcm90ZWN0ZWQKICAgICAgICogQHR5cGUge01hcDxGdW5jdGlvbixGdW5jdGlvbj59CiAgICAgICAqLwoKICAgIH0gY2F0Y2ggKGVycikgewogICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7CiAgICAgIF9pdGVyYXRvckVycm9yID0gZXJyOwogICAgfSBmaW5hbGx5IHsKICAgICAgdHJ5IHsKICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gJiYgX2l0ZXJhdG9yLnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICBfaXRlcmF0b3IucmV0dXJuKCk7CiAgICAgICAgfQogICAgICB9IGZpbmFsbHkgewogICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikgewogICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgdGhpcy5fY29udGV4dFBsdWdpbnMgPSBuZXcgTWFwKCk7CiAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSB0cnVlOwogICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMiA9IGZhbHNlOwogICAgdmFyIF9pdGVyYXRvckVycm9yMiA9IHVuZGVmaW5lZDsKCiAgICB0cnkgewogICAgICBmb3IgKHZhciBfaXRlcmF0b3IyID0gY29udGV4dFBsdWdpbnNbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDI7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSAoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWUpIHsKICAgICAgICB2YXIgX3N0ZXAyJHZhbHVlID0gX3NsaWNlZFRvQXJyYXkoX3N0ZXAyLnZhbHVlLCAyKSwKICAgICAgICAgICAgX1BsdWdpbkNvbnN0cnVjdG9yID0gX3N0ZXAyJHZhbHVlWzBdLAogICAgICAgICAgICBwbHVnaW5JbnN0YW5jZSA9IF9zdGVwMiR2YWx1ZVsxXTsKCiAgICAgICAgdGhpcy5fY29udGV4dFBsdWdpbnMuc2V0KF9QbHVnaW5Db25zdHJ1Y3RvciwgcGx1Z2luSW5zdGFuY2UpOwoKICAgICAgICB0aGlzLl9jb250ZXh0UGx1Z2lucy5zZXQocGx1Z2luSW5zdGFuY2UsIF9QbHVnaW5Db25zdHJ1Y3Rvcik7IC8vIFRvIG1ha2UgaXQgcG9zc2libGUgdG8gcmVxdWlyZSBhIHBsdWdpbiBieSBpdHMgbmFtZS4KCgogICAgICAgIGlmIChfUGx1Z2luQ29uc3RydWN0b3IucGx1Z2luTmFtZSkgewogICAgICAgICAgdGhpcy5fYXZhaWxhYmxlUGx1Z2lucy5zZXQoX1BsdWdpbkNvbnN0cnVjdG9yLnBsdWdpbk5hbWUsIF9QbHVnaW5Db25zdHJ1Y3Rvcik7CiAgICAgICAgfQogICAgICB9CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IyID0gdHJ1ZTsKICAgICAgX2l0ZXJhdG9yRXJyb3IyID0gZXJyOwogICAgfSBmaW5hbGx5IHsKICAgICAgdHJ5IHsKICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yICYmIF9pdGVyYXRvcjIucmV0dXJuICE9IG51bGwpIHsKICAgICAgICAgIF9pdGVyYXRvcjIucmV0dXJuKCk7CiAgICAgICAgfQogICAgICB9IGZpbmFsbHkgewogICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjIpIHsKICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMjsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgLyoqCiAgICogSXRlcmFibGUgaW50ZXJmYWNlLgogICAqCiAgICogUmV0dXJucyBgWyBQbHVnaW5Db25zdHJ1Y3RvciwgcGx1Z2luSW5zdGFuY2UgXWAgcGFpcnMuCiAgICoKICAgKiBAcmV0dXJucyB7SXRlcmFibGUuPEFycmF5Pn0KICAgKi8KCgogIF9jcmVhdGVDbGFzcyhQbHVnaW5Db2xsZWN0aW9uLCBbewogICAga2V5OiBTeW1ib2wuaXRlcmF0b3IsCiAgICB2YWx1ZToKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIHZhbHVlKCkgewogICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMsIF9kaWRJdGVyYXRvckVycm9yMywgX2l0ZXJhdG9yRXJyb3IzLCBfaXRlcmF0b3IzLCBfc3RlcDMsIGVudHJ5OwoKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIHZhbHVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IHRydWU7CiAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IzID0gZmFsc2U7CiAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IzID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAzOwogICAgICAgICAgICAgIF9pdGVyYXRvcjMgPSB0aGlzLl9wbHVnaW5zW1N5bWJvbC5pdGVyYXRvcl0oKTsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICBpZiAoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMgPSAoX3N0ZXAzID0gX2l0ZXJhdG9yMy5uZXh0KCkpLmRvbmUpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMzsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZW50cnkgPSBfc3RlcDMudmFsdWU7CgogICAgICAgICAgICAgIGlmICghKHR5cGVvZiBlbnRyeVswXSA9PSAnZnVuY3Rpb24nKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgcmV0dXJuIGVudHJ5OwoKICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IHRydWU7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDU7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxOTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE1OwogICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMyk7CiAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IzID0gdHJ1ZTsKICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvcjMgPSBfY29udGV4dC50MDsKCiAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE5OwogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyMDsKCiAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyAmJiBfaXRlcmF0b3IzLnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBfaXRlcmF0b3IzLnJldHVybigpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDIyOwoKICAgICAgICAgICAgICBpZiAoIV9kaWRJdGVyYXRvckVycm9yMykgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjM7CgogICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5maW5pc2goMjIpOwoKICAgICAgICAgICAgY2FzZSAyNjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuZmluaXNoKDE5KTsKCiAgICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIHZhbHVlLCB0aGlzLCBbWzMsIDE1LCAxOSwgMjddLCBbMjAsLCAyMiwgMjZdXSk7CiAgICB9KQogICAgLyoqCiAgICAgKiBHZXRzIHRoZSBwbHVnaW4gaW5zdGFuY2UgYnkgaXRzIGNvbnN0cnVjdG9yIG9yIG5hbWUuCiAgICAgKgogICAgICoJCS8vIENoZWNrIGlmICdDbGlwYm9hcmQnIHBsdWdpbiB3YXMgbG9hZGVkLgogICAgICoJCWlmICggZWRpdG9yLnBsdWdpbnMuaGFzKCAnQ2xpcGJvYXJkJyApICkgewogICAgICoJCQkvLyBHZXQgY2xpcGJvYXJkIHBsdWdpbiBpbnN0YW5jZQogICAgICoJCQljb25zdCBjbGlwYm9hcmQgPSBlZGl0b3IucGx1Z2lucy5nZXQoICdDbGlwYm9hcmQnICk7CiAgICAgKgogICAgICoJCQl0aGlzLmxpc3RlblRvKCBjbGlwYm9hcmQsICdpbnB1dFRyYW5zZm9ybWF0aW9uJywgKCBldnQsIGRhdGEgKSA9PiB7CiAgICAgKgkJCQkvLyBEbyBzb21ldGhpbmcgb24gY2xpcGJvYXJkIGlucHV0LgogICAgICoJCQl9ICk7CiAgICAgKgkJfQogICAgICoKICAgICAqICoqTm90ZSoqOiBUaGlzIG1ldGhvZCB3aWxsIHRocm93IGVycm9yIGlmIHBsdWdpbiBpcyBub3QgbG9hZGVkLiBVc2UgYHtAbGluayAjaGFzIGVkaXRvci5wbHVnaW5zLmhhcygpfWAKICAgICAqIHRvIGNoZWNrIGlmIHBsdWdpbiBpcyBhdmFpbGFibGUuCiAgICAgKgogICAgICogQHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IGtleSBUaGUgcGx1Z2luIGNvbnN0cnVjdG9yIG9yIHtAbGluayBtb2R1bGU6Y29yZS9wbHVnaW5+UGx1Z2luSW50ZXJmYWNlLnBsdWdpbk5hbWUgbmFtZX0uCiAgICAgKiBAcmV0dXJucyB7bW9kdWxlOmNvcmUvcGx1Z2luflBsdWdpbkludGVyZmFjZX0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldChrZXkpIHsKICAgICAgdmFyIHBsdWdpbiA9IHRoaXMuX3BsdWdpbnMuZ2V0KGtleSk7CgogICAgICBpZiAoIXBsdWdpbikgewogICAgICAgIC8qKgogICAgICAgICAqIFRoZSBwbHVnaW4gaXMgbm90IGxvYWRlZCBhbmQgY291bGQgbm90IGJlIG9idGFpbmVkLgogICAgICAgICAqCiAgICAgICAgICogUGx1Z2luIGNsYXNzZXMgKGNvbnN0cnVjdG9ycykgbmVlZCB0byBiZSBwcm92aWRlZCB0byB0aGUgZWRpdG9yIGFuZCBtdXN0IGJlIGxvYWRlZCBiZWZvcmUgdGhleSBjYW4gYmUgb2J0YWluZWQgZnJvbQogICAgICAgICAqIHRoZSBwbHVnaW4gY29sbGVjdGlvbi4KICAgICAgICAgKiBUaGlzIGlzIHVzdWFsbHkgZG9uZSBpbiBDS0VkaXRvciA1IGJ1aWxkcyBieSBzZXR0aW5nIHRoZSB7QGxpbmsgbW9kdWxlOmNvcmUvZWRpdG9yL2VkaXRvcn5FZGl0b3IuYnVpbHRpblBsdWdpbnN9CiAgICAgICAgICogcHJvcGVydHkuCiAgICAgICAgICoKICAgICAgICAgKiAqKk5vdGUqKjogWW91IGNhbiB1c2UgYHtAbGluayBtb2R1bGU6Y29yZS9wbHVnaW5jb2xsZWN0aW9uflBsdWdpbkNvbGxlY3Rpb24jaGFzIGVkaXRvci5wbHVnaW5zLmhhcygpfWAKICAgICAgICAgKiB0byBjaGVjayBpZiBwbHVnaW4gd2FzIGxvYWRlZC4KICAgICAgICAgKgogICAgICAgICAqIEBlcnJvciBwbHVnaW5jb2xsZWN0aW9uLXBsdWdpbi1ub3QtbG9hZGVkCiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IHBsdWdpbiBUaGUgbmFtZSBvZiB0aGUgcGx1Z2luIHdoaWNoIGlzIG5vdCBsb2FkZWQuCiAgICAgICAgICovCiAgICAgICAgdmFyIGVycm9yTXNnID0gJ3BsdWdpbmNvbGxlY3Rpb24tcGx1Z2luLW5vdC1sb2FkZWQ6IFRoZSByZXF1ZXN0ZWQgcGx1Z2luIGlzIG5vdCBsb2FkZWQuJzsKICAgICAgICB2YXIgcGx1Z2luTmFtZSA9IGtleTsKCiAgICAgICAgaWYgKHR5cGVvZiBrZXkgPT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgcGx1Z2luTmFtZSA9IGtleS5wbHVnaW5OYW1lIHx8IGtleS5uYW1lOwogICAgICAgIH0KCiAgICAgICAgdGhyb3cgbmV3IENLRWRpdG9yRXJyb3IoZXJyb3JNc2csIHRoaXMuX2NvbnRleHQsIHsKICAgICAgICAgIHBsdWdpbjogcGx1Z2luTmFtZQogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gcGx1Z2luOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVja3MgaWYgYSBwbHVnaW4gaXMgbG9hZGVkLgogICAgICoKICAgICAqCQkvLyBDaGVjayBpZiB0aGUgJ0NsaXBib2FyZCcgcGx1Z2luIHdhcyBsb2FkZWQuCiAgICAgKgkJaWYgKCBlZGl0b3IucGx1Z2lucy5oYXMoICdDbGlwYm9hcmQnICkgKSB7CiAgICAgKgkJCS8vIE5vdyB1c2UgdGhlIGNsaXBib2FyZCBwbHVnaW4gaW5zdGFuY2U6CiAgICAgKgkJCWNvbnN0IGNsaXBib2FyZCA9IGVkaXRvci5wbHVnaW5zLmdldCggJ0NsaXBib2FyZCcgKTsKICAgICAqCiAgICAgKgkJCS8vIC4uLgogICAgICoJCX0KICAgICAqCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufFN0cmluZ30ga2V5IFRoZSBwbHVnaW4gY29uc3RydWN0b3Igb3Ige0BsaW5rIG1vZHVsZTpjb3JlL3BsdWdpbn5QbHVnaW5JbnRlcmZhY2UucGx1Z2luTmFtZSBuYW1lfS4KICAgICAqIEByZXR1cm5zIHtCb29sZWFufQogICAgICovCgogIH0sIHsKICAgIGtleTogImhhcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzKGtleSkgewogICAgICByZXR1cm4gdGhpcy5fcGx1Z2lucy5oYXMoa2V5KTsKICAgIH0KICAgIC8qKgogICAgICogSW5pdGlhbGl6ZXMgYSBzZXQgb2YgcGx1Z2lucyBhbmQgYWRkcyB0aGVtIHRvIHRoZSBjb2xsZWN0aW9uLgogICAgICoKICAgICAqIEBwYXJhbSB7QXJyYXkuPEZ1bmN0aW9ufFN0cmluZz59IHBsdWdpbnMgQW4gYXJyYXkgb2Yge0BsaW5rIG1vZHVsZTpjb3JlL3BsdWdpbn5QbHVnaW5JbnRlcmZhY2UgcGx1Z2luIGNvbnN0cnVjdG9yc30KICAgICAqIG9yIHtAbGluayBtb2R1bGU6Y29yZS9wbHVnaW5+UGx1Z2luSW50ZXJmYWNlLnBsdWdpbk5hbWUgcGx1Z2luIG5hbWVzfS4gVGhlIHNlY29uZCBvcHRpb24gKG5hbWVzKSB3b3JrcyBvbmx5IGlmCiAgICAgKiBgYXZhaWxhYmxlUGx1Z2luc2Agd2VyZSBwYXNzZWQgdG8gdGhlIHtAbGluayAjY29uc3RydWN0b3J9LgogICAgICogQHBhcmFtIHtBcnJheS48U3RyaW5nfEZ1bmN0aW9uPn0gW3JlbW92ZVBsdWdpbnNdIE5hbWVzIG9mIHBsdWdpbnMgb3IgcGx1Z2luIGNvbnN0cnVjdG9ycwogICAgICogdGhhdCBzaG91bGQgbm90IGJlIGxvYWRlZCAoZGVzcGl0ZSBiZWluZyBzcGVjaWZpZWQgaW4gdGhlIGBwbHVnaW5zYCBhcnJheSkuCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZS48bW9kdWxlOmNvcmUvcGx1Z2lufkxvYWRlZFBsdWdpbnM+fSBBIHByb21pc2Ugd2hpY2ggZ2V0cyByZXNvbHZlZCBvbmNlIGFsbCBwbHVnaW5zIGFyZSBsb2FkZWQKICAgICAqIGFuZCBhdmFpbGFibGUgaW4gdGhlIGNvbGxlY3Rpb24uCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaW5pdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdChwbHVnaW5zKSB7CiAgICAgIHZhciByZW1vdmVQbHVnaW5zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBbXTsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICB2YXIgY29udGV4dCA9IHRoaXMuX2NvbnRleHQ7CiAgICAgIHZhciBsb2FkaW5nID0gbmV3IFNldCgpOwogICAgICB2YXIgbG9hZGVkID0gW107CiAgICAgIHZhciBwbHVnaW5Db25zdHJ1Y3RvcnMgPSBtYXBUb0F2YWlsYWJsZUNvbnN0cnVjdG9ycyhwbHVnaW5zKTsKICAgICAgdmFyIHJlbW92ZVBsdWdpbkNvbnN0cnVjdG9ycyA9IG1hcFRvQXZhaWxhYmxlQ29uc3RydWN0b3JzKHJlbW92ZVBsdWdpbnMpOwogICAgICB2YXIgbWlzc2luZ1BsdWdpbnMgPSBnZXRNaXNzaW5nUGx1Z2luTmFtZXMocGx1Z2lucyk7CgogICAgICBpZiAobWlzc2luZ1BsdWdpbnMpIHsKICAgICAgICAvKioKICAgICAgICAgKiBTb21lIHBsdWdpbnMgYXJlIG5vdCBhdmFpbGFibGUgYW5kIGNvdWxkIG5vdCBiZSBsb2FkZWQuCiAgICAgICAgICoKICAgICAgICAgKiBQbHVnaW4gY2xhc3NlcyAoY29uc3RydWN0b3JzKSBuZWVkIHRvIGJlIHByb3ZpZGVkIHRvIHRoZSBlZGl0b3IgYmVmb3JlIHRoZXkgY2FuIGJlIGxvYWRlZCBieSBuYW1lLgogICAgICAgICAqIFRoaXMgaXMgdXN1YWxseSBkb25lIGluIENLRWRpdG9yIDUgYnVpbGRzIGJ5IHNldHRpbmcgdGhlIHtAbGluayBtb2R1bGU6Y29yZS9lZGl0b3IvZWRpdG9yfkVkaXRvci5idWlsdGluUGx1Z2luc30KICAgICAgICAgKiBwcm9wZXJ0eS4KICAgICAgICAgKgogICAgICAgICAqICoqSWYgeW91IHNlZSB0aGlzIHdhcm5pbmcgd2hlbiB1c2luZyBvbmUgb2YgdGhlIHtAZ2xpbmsgYnVpbGRzL2luZGV4IENLRWRpdG9yIDUgQnVpbGRzfSoqLCBpdCBtZWFucwogICAgICAgICAqIHRoYXQgeW91IHRyeSB0byBlbmFibGUgYSBwbHVnaW4gd2hpY2ggd2FzIG5vdCBpbmNsdWRlZCBpbiB0aGF0IGJ1aWxkLiBUaGlzIG1heSBiZSBkdWUgdG8gYSB0eXBvCiAgICAgICAgICogaW4gdGhlIHBsdWdpbiBuYW1lIG9yIHNpbXBseSBiZWNhdXNlIHRoYXQgcGx1Z2luIGlzIG5vdCBhIHBhcnQgb2YgdGhpcyBidWlsZC4gSW4gdGhlIGxhdHRlciBzY2VuYXJpbywKICAgICAgICAgKiByZWFkIG1vcmUgYWJvdXQge0BnbGluayBidWlsZHMvZ3VpZGVzL2RldmVsb3BtZW50L2N1c3RvbS1idWlsZHMgY3VzdG9tIGJ1aWxkc30uCiAgICAgICAgICoKICAgICAgICAgKiAqKklmIHlvdSBzZWUgdGhpcyB3YXJuaW5nIHdoZW4gdXNpbmcgb25lIG9mIHRoZSBlZGl0b3IgY3JlYXRvcnMgZGlyZWN0bHkqKiAobm90IGEgYnVpbGQpLCB0aGVuIGl0IG1lYW5zCiAgICAgICAgICogdGhhdCB5b3UgdHJpZWQgbG9hZGluZyBwbHVnaW5zIGJ5IG5hbWUuIEhvd2V2ZXIsIHVubGlrZSBDS0VkaXRvciA0LCBDS0VkaXRvciA1IGRvZXMgbm90IGltcGxlbWVudCBhICJwbHVnaW4gbG9hZGVyIi4KICAgICAgICAgKiBUaGlzIG1lYW5zIHRoYXQgQ0tFZGl0b3IgNSBkb2VzIG5vdCBrbm93IHdoZXJlIHRvIGxvYWQgdGhlIHBsdWdpbiBtb2R1bGVzIGZyb20uIFRoZXJlZm9yZSwgeW91IG5lZWQgdG8KICAgICAgICAgKiBwcm92aWRlIGVhY2ggcGx1Z2luIHRocm91Z2ggcmVmZXJlbmNlIChhcyBhIGNvbnN0cnVjdG9yIGZ1bmN0aW9uKS4gQ2hlY2sgb3V0IHRoZSBleGFtcGxlcyBpbgogICAgICAgICAqIHtAZ2xpbmsgYnVpbGRzL2d1aWRlcy9pbnRlZ3JhdGlvbi9hZHZhbmNlZC1zZXR1cCNzY2VuYXJpby0yLWJ1aWxkaW5nLWZyb20tc291cmNlICJCdWlsZGluZyBmcm9tIHNvdXJjZSJ9LgogICAgICAgICAqCiAgICAgICAgICogQGVycm9yIHBsdWdpbmNvbGxlY3Rpb24tcGx1Z2luLW5vdC1mb3VuZAogICAgICAgICAqIEBwYXJhbSB7QXJyYXkuPFN0cmluZz59IHBsdWdpbnMgVGhlIG5hbWUgb2YgdGhlIHBsdWdpbnMgd2hpY2ggY291bGQgbm90IGJlIGxvYWRlZC4KICAgICAgICAgKi8KICAgICAgICB2YXIgZXJyb3JNc2cgPSAncGx1Z2luY29sbGVjdGlvbi1wbHVnaW4tbm90LWZvdW5kOiBTb21lIHBsdWdpbnMgYXJlIG5vdCBhdmFpbGFibGUgYW5kIGNvdWxkIG5vdCBiZSBsb2FkZWQuJzsgLy8gTG9nIHRoZSBlcnJvciBzbyBpdCdzIG1vcmUgdmlzaWJsZSBvbiB0aGUgY29uc29sZS4gSG9wZWZ1bGx5LCBmb3IgYmV0dGVyIERYLgoKICAgICAgICBjb25zb2xlLmVycm9yKGF0dGFjaExpbmtUb0RvY3VtZW50YXRpb24oZXJyb3JNc2cpLCB7CiAgICAgICAgICBwbHVnaW5zOiBtaXNzaW5nUGx1Z2lucwogICAgICAgIH0pOwogICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgQ0tFZGl0b3JFcnJvcihlcnJvck1zZywgY29udGV4dCwgewogICAgICAgICAgcGx1Z2luczogbWlzc2luZ1BsdWdpbnMKICAgICAgICB9KSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBQcm9taXNlLmFsbChwbHVnaW5Db25zdHJ1Y3RvcnMubWFwKGxvYWRQbHVnaW4pKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gaW5pdFBsdWdpbnMobG9hZGVkLCAnaW5pdCcpOwogICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gaW5pdFBsdWdpbnMobG9hZGVkLCAnYWZ0ZXJJbml0Jyk7CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBsb2FkZWQ7CiAgICAgIH0pOwoKICAgICAgZnVuY3Rpb24gbG9hZFBsdWdpbihQbHVnaW5Db25zdHJ1Y3RvcikgewogICAgICAgIGlmIChyZW1vdmVQbHVnaW5Db25zdHJ1Y3RvcnMuaW5jbHVkZXMoUGx1Z2luQ29uc3RydWN0b3IpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSAvLyBUaGUgcGx1Z2luIGlzIGFscmVhZHkgbG9hZGVkIG9yIGJlaW5nIGxvYWRlZCAtIGRvIG5vdGhpbmcuCgoKICAgICAgICBpZiAodGhhdC5fcGx1Z2lucy5oYXMoUGx1Z2luQ29uc3RydWN0b3IpIHx8IGxvYWRpbmcuaGFzKFBsdWdpbkNvbnN0cnVjdG9yKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGluc3RhbnRpYXRlUGx1Z2luKFBsdWdpbkNvbnN0cnVjdG9yKS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAvKioKICAgICAgICAgICAqIEl0IHdhcyBub3QgcG9zc2libGUgdG8gbG9hZCB0aGUgcGx1Z2luLgogICAgICAgICAgICoKICAgICAgICAgICAqIFRoaXMgaXMgYSBnZW5lcmljIGVycm9yIGxvZ2dlZCB0byB0aGUgY29uc29sZSB3aGVuIGEgSmF2YVNyaXB0IGVycm9yIGlzIHRocm93biBkdXJpbmcgdGhlIGluaXRpYWxpemF0aW9uCiAgICAgICAgICAgKiBvZiBvbmUgb2YgdGhlIHBsdWdpbnMuCiAgICAgICAgICAgKgogICAgICAgICAgICogSWYgeW91IGNvcnJlY3RseSBoYW5kbGVkIHRoZSBwcm9taXNlIHJldHVybmVkIGJ5IHRoZSBlZGl0b3IncyBgY3JlYXRlKClgIG1ldGhvZCAobGlrZSBzaG93biBiZWxvdyksCiAgICAgICAgICAgKiB5b3Ugd2lsbCBmaW5kIHRoZSBvcmlnaW5hbCBlcnJvciBsb2dnZWQgdG8gdGhlIGNvbnNvbGUsIHRvbzoKICAgICAgICAgICAqCiAgICAgICAgICAgKgkJQ2xhc3NpY0VkaXRvci5jcmVhdGUoIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAnZWRpdG9yJyApICkKICAgICAgICAgICAqCQkJLnRoZW4oIGVkaXRvciA9PiB7CiAgICAgICAgICAgKgkJCQkvLyAuLi4KICAgICAgICAgICAqIAkJCX0gKQogICAgICAgICAgICoJCQkuY2F0Y2goIGVycm9yID0+IHsKICAgICAgICAgICAqCQkJCWNvbnNvbGUuZXJyb3IoIGVycm9yICk7CiAgICAgICAgICAgKgkJCX0gKTsKICAgICAgICAgICAqCiAgICAgICAgICAgKiBAZXJyb3IgcGx1Z2luY29sbGVjdGlvbi1sb2FkCiAgICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGx1Z2luIFRoZSBuYW1lIG9mIHRoZSBwbHVnaW4gdGhhdCBjb3VsZCBub3QgYmUgbG9hZGVkLgogICAgICAgICAgICovCiAgICAgICAgICBjb25zb2xlLmVycm9yKGF0dGFjaExpbmtUb0RvY3VtZW50YXRpb24oJ3BsdWdpbmNvbGxlY3Rpb24tbG9hZDogSXQgd2FzIG5vdCBwb3NzaWJsZSB0byBsb2FkIHRoZSBwbHVnaW4uJyksIHsKICAgICAgICAgICAgcGx1Z2luOiBQbHVnaW5Db25zdHJ1Y3RvcgogICAgICAgICAgfSk7CiAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGluaXRQbHVnaW5zKGxvYWRlZFBsdWdpbnMsIG1ldGhvZCkgewogICAgICAgIHJldHVybiBsb2FkZWRQbHVnaW5zLnJlZHVjZShmdW5jdGlvbiAocHJvbWlzZSwgcGx1Z2luKSB7CiAgICAgICAgICBpZiAoIXBsdWdpblttZXRob2RdKSB7CiAgICAgICAgICAgIHJldHVybiBwcm9taXNlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGF0Ll9jb250ZXh0UGx1Z2lucy5oYXMocGx1Z2luKSkgewogICAgICAgICAgICByZXR1cm4gcHJvbWlzZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gcHJvbWlzZS50aGVuKHBsdWdpblttZXRob2RdLmJpbmQocGx1Z2luKSk7CiAgICAgICAgfSwgUHJvbWlzZS5yZXNvbHZlKCkpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBpbnN0YW50aWF0ZVBsdWdpbihQbHVnaW5Db25zdHJ1Y3RvcikgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgbG9hZGluZy5hZGQoUGx1Z2luQ29uc3RydWN0b3IpOwoKICAgICAgICAgIGlmIChQbHVnaW5Db25zdHJ1Y3Rvci5yZXF1aXJlcykgewogICAgICAgICAgICBQbHVnaW5Db25zdHJ1Y3Rvci5yZXF1aXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChSZXF1aXJlZFBsdWdpbkNvbnN0cnVjdG9yT3JOYW1lKSB7CiAgICAgICAgICAgICAgdmFyIFJlcXVpcmVkUGx1Z2luQ29uc3RydWN0b3IgPSBnZXRQbHVnaW5Db25zdHJ1Y3RvcihSZXF1aXJlZFBsdWdpbkNvbnN0cnVjdG9yT3JOYW1lKTsKCiAgICAgICAgICAgICAgaWYgKFBsdWdpbkNvbnN0cnVjdG9yLmlzQ29udGV4dFBsdWdpbiAmJiAhUmVxdWlyZWRQbHVnaW5Db25zdHJ1Y3Rvci5pc0NvbnRleHRQbHVnaW4pIHsKICAgICAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgICAgICogSWYgYSBwbHVnaW4gaXMgYSBjb250ZXh0IHBsdWdpbiwgYWxsIHBsdWdpbnMgaXQgcmVxdWlyZXMgc2hvdWxkIGFsc28gYmUgY29udGV4dCBwbHVnaW5zCiAgICAgICAgICAgICAgICAgKiBpbnN0ZWFkIG9mIHBsdWdpbnMuIEluIG90aGVyIHdvcmRzLCBpZiBvbmUgcGx1Z2luIGNhbiBiZSB1c2VkIGluIHRoZSBjb250ZXh0LAogICAgICAgICAgICAgICAgICogYWxsIGl0cyByZXF1aXJlbWVudHMgc2hvdWxkIGFsc28gYmUgcmVhZHkgdG8gYmUgdXNlZCBpbiB0aGUgY29udGV4dC4gTm90ZSB0aGF0IHRoZSBjb250ZXh0CiAgICAgICAgICAgICAgICAgKiBwcm92aWRlcyBvbmx5IGEgcGFydCBvZiB0aGUgQVBJIHByb3ZpZGVkIGJ5IHRoZSBlZGl0b3IuIElmIG9uZSBwbHVnaW4gbmVlZHMgYSBmdWxsCiAgICAgICAgICAgICAgICAgKiBlZGl0b3IgQVBJLCBhbGwgcGx1Z2lucyB3aGljaCByZXF1aXJlIGl0IGFyZSBjb25zaWRlcmVkIGFzIHBsdWdpbnMgdGhhdCBuZWVkIGEgZnVsbAogICAgICAgICAgICAgICAgICogZWRpdG9yIEFQSS4KICAgICAgICAgICAgICAgICAqCiAgICAgICAgICAgICAgICAgKiBAZXJyb3IgcGx1Z2luY29sbGVjdGlvbi1jb250ZXh0LXJlcXVpcmVkCiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGx1Z2luIFRoZSBuYW1lIG9mIHRoZSByZXF1aXJlZCBwbHVnaW4uCiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gcmVxdWlyZWRCeSBUaGUgbmFtZSBvZiB0aGUgcGFyZW50IHBsdWdpbi4KICAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgdGhyb3cgbmV3IENLRWRpdG9yRXJyb3IoJ3BsdWdpbmNvbGxlY3Rpb24tY29udGV4dC1yZXF1aXJlZDogQ29udGV4dCBwbHVnaW4gY2FuIG5vdCByZXF1aXJlIHBsdWdpbiB3aGljaCBpcyBub3QgYSBjb250ZXh0IHBsdWdpbicsIG51bGwsIHsKICAgICAgICAgICAgICAgICAgcGx1Z2luOiBSZXF1aXJlZFBsdWdpbkNvbnN0cnVjdG9yLm5hbWUsCiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkQnk6IFBsdWdpbkNvbnN0cnVjdG9yLm5hbWUKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgaWYgKHJlbW92ZVBsdWdpbnMuaW5jbHVkZXMoUmVxdWlyZWRQbHVnaW5Db25zdHJ1Y3RvcikpIHsKICAgICAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgICAgICogQ2Fubm90IGxvYWQgYSBwbHVnaW4gYmVjYXVzZSBvbmUgb2YgaXRzIGRlcGVuZGVuY2llcyBpcyBsaXN0ZWQgaW4gdGhlIGByZW1vdmVQbHVnaW5zYCBvcHRpb24uCiAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICogQGVycm9yIHBsdWdpbmNvbGxlY3Rpb24tcmVxdWlyZWQKICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwbHVnaW4gVGhlIG5hbWUgb2YgdGhlIHJlcXVpcmVkIHBsdWdpbi4KICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSByZXF1aXJlZEJ5IFRoZSBuYW1lIG9mIHRoZSBwYXJlbnQgcGx1Z2luLgogICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQ0tFZGl0b3JFcnJvcigncGx1Z2luY29sbGVjdGlvbi1yZXF1aXJlZDogQ2Fubm90IGxvYWQgYSBwbHVnaW4gYmVjYXVzZSBvbmUgb2YgaXRzIGRlcGVuZGVuY2llcyBpcyBsaXN0ZWQgaW4nICsgJ3RoZSBgcmVtb3ZlUGx1Z2luc2Agb3B0aW9uLicsIGNvbnRleHQsIHsKICAgICAgICAgICAgICAgICAgcGx1Z2luOiBSZXF1aXJlZFBsdWdpbkNvbnN0cnVjdG9yLm5hbWUsCiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkQnk6IFBsdWdpbkNvbnN0cnVjdG9yLm5hbWUKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbG9hZFBsdWdpbihSZXF1aXJlZFBsdWdpbkNvbnN0cnVjdG9yKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHBsdWdpbiA9IHRoYXQuX2NvbnRleHRQbHVnaW5zLmdldChQbHVnaW5Db25zdHJ1Y3RvcikgfHwgbmV3IFBsdWdpbkNvbnN0cnVjdG9yKGNvbnRleHQpOwoKICAgICAgICAgIHRoYXQuX2FkZChQbHVnaW5Db25zdHJ1Y3RvciwgcGx1Z2luKTsKCiAgICAgICAgICBsb2FkZWQucHVzaChwbHVnaW4pOwogICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBmdW5jdGlvbiBnZXRQbHVnaW5Db25zdHJ1Y3RvcihQbHVnaW5Db25zdHJ1Y3Rvck9yTmFtZSkgewogICAgICAgIGlmICh0eXBlb2YgUGx1Z2luQ29uc3RydWN0b3JPck5hbWUgPT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgcmV0dXJuIFBsdWdpbkNvbnN0cnVjdG9yT3JOYW1lOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRoYXQuX2F2YWlsYWJsZVBsdWdpbnMuZ2V0KFBsdWdpbkNvbnN0cnVjdG9yT3JOYW1lKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZ2V0TWlzc2luZ1BsdWdpbk5hbWVzKHBsdWdpbnMpIHsKICAgICAgICB2YXIgbWlzc2luZ1BsdWdpbnMgPSBbXTsKICAgICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjQgPSB0cnVlOwogICAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvcjQgPSBmYWxzZTsKICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3I0ID0gdW5kZWZpbmVkOwoKICAgICAgICB0cnkgewogICAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yNCA9IHBsdWdpbnNbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDQ7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjQgPSAoX3N0ZXA0ID0gX2l0ZXJhdG9yNC5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCA9IHRydWUpIHsKICAgICAgICAgICAgdmFyIHBsdWdpbk5hbWVPckNvbnN0cnVjdG9yID0gX3N0ZXA0LnZhbHVlOwoKICAgICAgICAgICAgaWYgKCFnZXRQbHVnaW5Db25zdHJ1Y3RvcihwbHVnaW5OYW1lT3JDb25zdHJ1Y3RvcikpIHsKICAgICAgICAgICAgICBtaXNzaW5nUGx1Z2lucy5wdXNoKHBsdWdpbk5hbWVPckNvbnN0cnVjdG9yKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3I0ID0gdHJ1ZTsKICAgICAgICAgIF9pdGVyYXRvckVycm9yNCA9IGVycjsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCAmJiBfaXRlcmF0b3I0LnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICAgICAgX2l0ZXJhdG9yNC5yZXR1cm4oKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yNCkgewogICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yNDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG1pc3NpbmdQbHVnaW5zLmxlbmd0aCA/IG1pc3NpbmdQbHVnaW5zIDogbnVsbDsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gbWFwVG9BdmFpbGFibGVDb25zdHJ1Y3RvcnMocGx1Z2lucykgewogICAgICAgIHJldHVybiBwbHVnaW5zLm1hcChmdW5jdGlvbiAocGx1Z2luTmFtZU9yQ29uc3RydWN0b3IpIHsKICAgICAgICAgIHJldHVybiBnZXRQbHVnaW5Db25zdHJ1Y3RvcihwbHVnaW5OYW1lT3JDb25zdHJ1Y3Rvcik7CiAgICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChQbHVnaW5Db25zdHJ1Y3RvcikgewogICAgICAgICAgcmV0dXJuICEhUGx1Z2luQ29uc3RydWN0b3I7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogRGVzdHJveXMgYWxsIGxvYWRlZCBwbHVnaW5zLgogICAgICoKICAgICAqIEByZXR1cm5zIHtQcm9taXNlfQogICAgICovCgogIH0sIHsKICAgIGtleTogImRlc3Ryb3kiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7CiAgICAgIHZhciBwcm9taXNlcyA9IFtdOwogICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjUgPSB0cnVlOwogICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3I1ID0gZmFsc2U7CiAgICAgIHZhciBfaXRlcmF0b3JFcnJvcjUgPSB1bmRlZmluZWQ7CgogICAgICB0cnkgewogICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjUgPSB0aGlzW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA1OyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb241ID0gKF9zdGVwNSA9IF9pdGVyYXRvcjUubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjUgPSB0cnVlKSB7CiAgICAgICAgICB2YXIgX3N0ZXA1JHZhbHVlID0gX3NsaWNlZFRvQXJyYXkoX3N0ZXA1LnZhbHVlLCAyKSwKICAgICAgICAgICAgICBwbHVnaW5JbnN0YW5jZSA9IF9zdGVwNSR2YWx1ZVsxXTsKCiAgICAgICAgICBpZiAodHlwZW9mIHBsdWdpbkluc3RhbmNlLmRlc3Ryb3kgPT0gJ2Z1bmN0aW9uJyAmJiAhdGhpcy5fY29udGV4dFBsdWdpbnMuaGFzKHBsdWdpbkluc3RhbmNlKSkgewogICAgICAgICAgICBwcm9taXNlcy5wdXNoKHBsdWdpbkluc3RhbmNlLmRlc3Ryb3koKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjUgPSB0cnVlOwogICAgICAgIF9pdGVyYXRvckVycm9yNSA9IGVycjsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNSAmJiBfaXRlcmF0b3I1LnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjUucmV0dXJuKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjUpIHsKICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I1OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKTsKICAgIH0KICAgIC8qKgogICAgICogQWRkcyB0aGUgcGx1Z2luIHRvIHRoZSBjb2xsZWN0aW9uLiBFeHBvc2VkIG1haW5seSBmb3IgdGVzdGluZyBwdXJwb3Nlcy4KICAgICAqCiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBQbHVnaW5Db25zdHJ1Y3RvciBUaGUgcGx1Z2luIGNvbnN0cnVjdG9yLgogICAgICogQHBhcmFtIHttb2R1bGU6Y29yZS9wbHVnaW5+UGx1Z2luSW50ZXJmYWNlfSBwbHVnaW4gVGhlIGluc3RhbmNlIG9mIHRoZSBwbHVnaW4uCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX2FkZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FkZChQbHVnaW5Db25zdHJ1Y3RvciwgcGx1Z2luKSB7CiAgICAgIHRoaXMuX3BsdWdpbnMuc2V0KFBsdWdpbkNvbnN0cnVjdG9yLCBwbHVnaW4pOwoKICAgICAgdmFyIHBsdWdpbk5hbWUgPSBQbHVnaW5Db25zdHJ1Y3Rvci5wbHVnaW5OYW1lOwoKICAgICAgaWYgKCFwbHVnaW5OYW1lKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5fcGx1Z2lucy5oYXMocGx1Z2luTmFtZSkpIHsKICAgICAgICAvKioKICAgICAgICAgKiBUd28gcGx1Z2lucyB3aXRoIHRoZSBzYW1lIHtAbGluayBtb2R1bGU6Y29yZS9wbHVnaW5+UGx1Z2luSW50ZXJmYWNlLnBsdWdpbk5hbWV9IHdlcmUgbG9hZGVkLgogICAgICAgICAqIFRoaXMgd2lsbCBsZWFkIHRvIHJ1bnRpbWUgY29uZmxpY3RzIGJldHdlZW4gdGhlc2UgcGx1Z2lucy4KICAgICAgICAgKgogICAgICAgICAqIEluIHByYWN0aWNlLCB0aGlzIHdhcm5pbmcgdXN1YWxseSBtZWFucyB0aGF0IG5ldyBwbHVnaW5zIHdlcmUgYWRkZWQgdG8gYW4gZXhpc3RpbmcgQ0tFZGl0b3IgNSBidWlsZC4KICAgICAgICAgKiBQbHVnaW5zIHNob3VsZCBhbHdheXMgYmUgYWRkZWQgdG8gYSBzb3VyY2UgdmVyc2lvbiBvZiB0aGUgZWRpdG9yIChgQGNrZWRpdG9yL2NrZWRpdG9yNS1lZGl0b3ItKmApLAogICAgICAgICAqIG5vdCB0byBhbiBlZGl0b3IgaW1wb3J0ZWQgZnJvbSBvbmUgb2YgdGhlIGBAY2tlZGl0b3IvY2tlZGl0b3I1LWJ1aWxkLSpgIHBhY2thZ2VzLgogICAgICAgICAqCiAgICAgICAgICogQ2hlY2sgeW91ciBpbXBvcnQgcGF0aHMgYW5kIHRoZSBsaXN0IG9mIHBsdWdpbnMgcGFzc2VkIHRvCiAgICAgICAgICoge0BsaW5rIG1vZHVsZTpjb3JlL2VkaXRvci9lZGl0b3J+RWRpdG9yLmNyZWF0ZSBgRWRpdG9yLmNyZWF0ZSgpYH0KICAgICAgICAgKiBvciBzcGVjaWZpZWQgaW4ge0BsaW5rIG1vZHVsZTpjb3JlL2VkaXRvci9lZGl0b3J+RWRpdG9yLmJ1aWx0aW5QbHVnaW5zIGBFZGl0b3IuYnVpbHRpblBsdWdpbnNgfS4KICAgICAgICAgKgogICAgICAgICAqIFRoZSBzZWNvbmQgb3B0aW9uIGlzIHRoYXQgeW91ciBgbm9kZV9tb2R1bGVzL2AgZGlyZWN0b3J5IGNvbnRhaW5zIGR1cGxpY2F0ZWQgdmVyc2lvbnMgb2YgdGhlIHNhbWUKICAgICAgICAgKiBDS0VkaXRvciA1IHBhY2thZ2VzLiBOb3JtYWxseSwgb24gY2xlYW4gaW5zdGFsbGF0aW9ucywgbnBtIGRlZHVwbGljYXRlcyBwYWNrYWdlcyBpbiBgbm9kZV9tb2R1bGVzL2AsIHNvCiAgICAgICAgICogaXQgbWF5IGJlIGVub3VnaCB0byBjYWxsIGBybSAtcmYgbm9kZV9tb2R1bGVzICYmIG5wbSBpYC4gSG93ZXZlciwgaWYgeW91IGluc3RhbGxlZCBjb25mbGljdGluZyB2ZXJzaW9ucwogICAgICAgICAqIG9mIHBhY2thZ2VzLCB0aGVpciBkZXBlbmRlbmNpZXMgbWF5IG5lZWQgdG8gYmUgaW5zdGFsbGVkIGluIG1vcmUgdGhhbiBvbmUgdmVyc2lvbiB3aGljaCBtYXkgbGVhZCB0byB0aGlzCiAgICAgICAgICogd2FybmluZy4KICAgICAgICAgKgogICAgICAgICAqIFRlY2huaWNhbGx5IHNwZWFraW5nLCB0aGlzIGVycm9yIG9jY3VycyBiZWNhdXNlIGFmdGVyIGFkZGluZyBhIHBsdWdpbiB0byBhbiBleGlzdGluZyBlZGl0b3IgYnVpbGQKICAgICAgICAgKiBkZXBlbmRlbmNpZXMgb2YgdGhpcyBwbHVnaW4gYXJlIGJlaW5nIGR1cGxpY2F0ZWQuCiAgICAgICAgICogVGhleSBhcmUgYWxyZWFkeSBidWlsdCBpbnRvIHRoYXQgZWRpdG9yIGJ1aWxkIGFuZCBub3cgZ2V0IGFkZGVkIGZvciB0aGUgc2Vjb25kIHRpbWUgYXMgZGVwZW5kZW5jaWVzCiAgICAgICAgICogb2YgdGhlIHBsdWdpbiB5b3UgYXJlIGluc3RhbGxpbmcuCiAgICAgICAgICoKICAgICAgICAgKiBSZWFkIG1vcmUgYWJvdXQge0BnbGluayBidWlsZHMvZ3VpZGVzL2ludGVncmF0aW9uL2luc3RhbGxpbmctcGx1Z2lucyBpbnN0YWxsaW5nIHBsdWdpbnN9LgogICAgICAgICAqCiAgICAgICAgICogQGVycm9yIHBsdWdpbmNvbGxlY3Rpb24tcGx1Z2luLW5hbWUtY29uZmxpY3QKICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGx1Z2luTmFtZSBUaGUgZHVwbGljYXRlZCBwbHVnaW4gbmFtZS4KICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwbHVnaW4xIFRoZSBmaXJzdCBwbHVnaW4gY29uc3RydWN0b3IuCiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcGx1Z2luMiBUaGUgc2Vjb25kIHBsdWdpbiBjb25zdHJ1Y3Rvci4KICAgICAgICAgKi8KICAgICAgICB0aHJvdyBuZXcgQ0tFZGl0b3JFcnJvcigncGx1Z2luY29sbGVjdGlvbi1wbHVnaW4tbmFtZS1jb25mbGljdDogVHdvIHBsdWdpbnMgd2l0aCB0aGUgc2FtZSBuYW1lIHdlcmUgbG9hZGVkLicsIG51bGwsIHsKICAgICAgICAgIHBsdWdpbk5hbWU6IHBsdWdpbk5hbWUsCiAgICAgICAgICBwbHVnaW4xOiB0aGlzLl9wbHVnaW5zLmdldChwbHVnaW5OYW1lKS5jb25zdHJ1Y3RvciwKICAgICAgICAgIHBsdWdpbjI6IFBsdWdpbkNvbnN0cnVjdG9yCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMuX3BsdWdpbnMuc2V0KHBsdWdpbk5hbWUsIHBsdWdpbik7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUGx1Z2luQ29sbGVjdGlvbjsKfSgpOwoKZXhwb3J0IHsgUGx1Z2luQ29sbGVjdGlvbiBhcyBkZWZhdWx0IH07Cm1peChQbHVnaW5Db2xsZWN0aW9uLCBFbWl0dGVyTWl4aW4pOw=="},{"version":3,"sources":["C:/Users/pc/Desktop/Restoran/Restoran/Restoran.UI/client/node_modules/@ckeditor/ckeditor5-core/src/plugincollection.js"],"names":["CKEditorError","attachLinkToDocumentation","EmitterMixin","mix","PluginCollection","context","availablePlugins","contextPlugins","_context","_plugins","Map","_availablePlugins","PluginConstructor","pluginName","set","_contextPlugins","pluginInstance","Symbol","iterator","entry","key","plugin","get","errorMsg","name","has","plugins","removePlugins","that","loading","Set","loaded","pluginConstructors","mapToAvailableConstructors","removePluginConstructors","missingPlugins","getMissingPluginNames","console","error","Promise","reject","all","map","loadPlugin","then","initPlugins","includes","instantiatePlugin","catch","err","loadedPlugins","method","reduce","promise","bind","resolve","add","requires","forEach","RequiredPluginConstructorOrName","RequiredPluginConstructor","getPluginConstructor","isContextPlugin","requiredBy","_add","push","PluginConstructorOrName","pluginNameOrConstructor","length","filter","promises","destroy","plugin1","constructor","plugin2"],"mappings":"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","sourcesContent":["/**\n * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module core/plugincollection\n */\n\n/* globals console */\n\nimport CKEditorError, { attachLinkToDocumentation } from '@ckeditor/ckeditor5-utils/src/ckeditorerror';\n\nimport EmitterMixin from '@ckeditor/ckeditor5-utils/src/emittermixin';\nimport mix from '@ckeditor/ckeditor5-utils/src/mix';\n\n/**\n * Manages a list of CKEditor plugins, including loading, resolving dependencies and initialization.\n *\n * @mixes module:utils/emittermixin~EmitterMixin\n */\nexport default class PluginCollection {\n\t/**\n\t * Creates an instance of the plugin collection class.\n\t * Allows loading and initializing plugins and their dependencies.\n\t * Allows to provide a list of already loaded plugins. These plugins will not be destroyed along with this collection.\n\t *\n\t * @param {module:core/editor/editor~Editor|module:core/context~Context} context\n\t * @param {Array.<Function>} [availablePlugins] Plugins (constructors) which the collection will be able to use\n\t * when {@link module:core/plugincollection~PluginCollection#init} is used with plugin names (strings, instead of constructors).\n\t * Usually, the editor will pass its built-in plugins to the collection so they can later be\n\t * used in `config.plugins` or `config.removePlugins` by names.\n\t * @param {Iterable.<Array>} contextPlugins A list of already initialized plugins represented by a\n\t * `[ PluginConstructor, pluginInstance ]` pair.\n\t */\n\tconstructor( context, availablePlugins = [], contextPlugins = [] ) {\n\t\t/**\n\t\t * @protected\n\t\t * @type {module:core/editor/editor~Editor|module:core/context~Context}\n\t\t */\n\t\tthis._context = context;\n\n\t\t/**\n\t\t * @protected\n\t\t * @type {Map}\n\t\t */\n\t\tthis._plugins = new Map();\n\n\t\t/**\n\t\t * A map of plugin constructors that can be retrieved by their names.\n\t\t *\n\t\t * @protected\n\t\t * @type {Map.<String|Function,Function>}\n\t\t */\n\t\tthis._availablePlugins = new Map();\n\n\t\tfor ( const PluginConstructor of availablePlugins ) {\n\t\t\tif ( PluginConstructor.pluginName ) {\n\t\t\t\tthis._availablePlugins.set( PluginConstructor.pluginName, PluginConstructor );\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Map of {@link module:core/contextplugin~ContextPlugin context plugins} which can be retrieved by their constructors or instances.\n\t\t *\n\t\t * @protected\n\t\t * @type {Map<Function,Function>}\n\t\t */\n\t\tthis._contextPlugins = new Map();\n\n\t\tfor ( const [ PluginConstructor, pluginInstance ] of contextPlugins ) {\n\t\t\tthis._contextPlugins.set( PluginConstructor, pluginInstance );\n\t\t\tthis._contextPlugins.set( pluginInstance, PluginConstructor );\n\n\t\t\t// To make it possible to require a plugin by its name.\n\t\t\tif ( PluginConstructor.pluginName ) {\n\t\t\t\tthis._availablePlugins.set( PluginConstructor.pluginName, PluginConstructor );\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Iterable interface.\n\t *\n\t * Returns `[ PluginConstructor, pluginInstance ]` pairs.\n\t *\n\t * @returns {Iterable.<Array>}\n\t */\n\t* [ Symbol.iterator ]() {\n\t\tfor ( const entry of this._plugins ) {\n\t\t\tif ( typeof entry[ 0 ] == 'function' ) {\n\t\t\t\tyield entry;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Gets the plugin instance by its constructor or name.\n\t *\n\t *\t\t// Check if 'Clipboard' plugin was loaded.\n\t *\t\tif ( editor.plugins.has( 'Clipboard' ) ) {\n\t *\t\t\t// Get clipboard plugin instance\n\t *\t\t\tconst clipboard = editor.plugins.get( 'Clipboard' );\n\t *\n\t *\t\t\tthis.listenTo( clipboard, 'inputTransformation', ( evt, data ) => {\n\t *\t\t\t\t// Do something on clipboard input.\n\t *\t\t\t} );\n\t *\t\t}\n\t *\n\t * **Note**: This method will throw error if plugin is not loaded. Use `{@link #has editor.plugins.has()}`\n\t * to check if plugin is available.\n\t *\n\t * @param {Function|String} key The plugin constructor or {@link module:core/plugin~PluginInterface.pluginName name}.\n\t * @returns {module:core/plugin~PluginInterface}\n\t */\n\tget( key ) {\n\t\tconst plugin = this._plugins.get( key );\n\n\t\tif ( !plugin ) {\n\t\t\t/**\n\t\t\t * The plugin is not loaded and could not be obtained.\n\t\t\t *\n\t\t\t * Plugin classes (constructors) need to be provided to the editor and must be loaded before they can be obtained from\n\t\t\t * the plugin collection.\n\t\t\t * This is usually done in CKEditor 5 builds by setting the {@link module:core/editor/editor~Editor.builtinPlugins}\n\t\t\t * property.\n\t\t\t *\n\t\t\t * **Note**: You can use `{@link module:core/plugincollection~PluginCollection#has editor.plugins.has()}`\n\t\t\t * to check if plugin was loaded.\n\t\t\t *\n\t\t\t * @error plugincollection-plugin-not-loaded\n\t\t\t * @param {String} plugin The name of the plugin which is not loaded.\n\t\t\t */\n\t\t\tconst errorMsg = 'plugincollection-plugin-not-loaded: The requested plugin is not loaded.';\n\n\t\t\tlet pluginName = key;\n\n\t\t\tif ( typeof key == 'function' ) {\n\t\t\t\tpluginName = key.pluginName || key.name;\n\t\t\t}\n\n\t\t\tthrow new CKEditorError( errorMsg, this._context, { plugin: pluginName } );\n\t\t}\n\n\t\treturn plugin;\n\t}\n\n\t/**\n\t * Checks if a plugin is loaded.\n\t *\n\t *\t\t// Check if the 'Clipboard' plugin was loaded.\n\t *\t\tif ( editor.plugins.has( 'Clipboard' ) ) {\n\t *\t\t\t// Now use the clipboard plugin instance:\n\t *\t\t\tconst clipboard = editor.plugins.get( 'Clipboard' );\n\t *\n\t *\t\t\t// ...\n\t *\t\t}\n\t *\n\t * @param {Function|String} key The plugin constructor or {@link module:core/plugin~PluginInterface.pluginName name}.\n\t * @returns {Boolean}\n\t */\n\thas( key ) {\n\t\treturn this._plugins.has( key );\n\t}\n\n\t/**\n\t * Initializes a set of plugins and adds them to the collection.\n\t *\n\t * @param {Array.<Function|String>} plugins An array of {@link module:core/plugin~PluginInterface plugin constructors}\n\t * or {@link module:core/plugin~PluginInterface.pluginName plugin names}. The second option (names) works only if\n\t * `availablePlugins` were passed to the {@link #constructor}.\n\t * @param {Array.<String|Function>} [removePlugins] Names of plugins or plugin constructors\n\t * that should not be loaded (despite being specified in the `plugins` array).\n\t * @returns {Promise.<module:core/plugin~LoadedPlugins>} A promise which gets resolved once all plugins are loaded\n\t * and available in the collection.\n\t */\n\tinit( plugins, removePlugins = [] ) {\n\t\tconst that = this;\n\t\tconst context = this._context;\n\t\tconst loading = new Set();\n\t\tconst loaded = [];\n\n\t\tconst pluginConstructors = mapToAvailableConstructors( plugins );\n\t\tconst removePluginConstructors = mapToAvailableConstructors( removePlugins );\n\t\tconst missingPlugins = getMissingPluginNames( plugins );\n\n\t\tif ( missingPlugins ) {\n\t\t\t/**\n\t\t\t * Some plugins are not available and could not be loaded.\n\t\t\t *\n\t\t\t * Plugin classes (constructors) need to be provided to the editor before they can be loaded by name.\n\t\t\t * This is usually done in CKEditor 5 builds by setting the {@link module:core/editor/editor~Editor.builtinPlugins}\n\t\t\t * property.\n\t\t\t *\n\t\t\t * **If you see this warning when using one of the {@glink builds/index CKEditor 5 Builds}**, it means\n\t\t\t * that you try to enable a plugin which was not included in that build. This may be due to a typo\n\t\t\t * in the plugin name or simply because that plugin is not a part of this build. In the latter scenario,\n\t\t\t * read more about {@glink builds/guides/development/custom-builds custom builds}.\n\t\t\t *\n\t\t\t * **If you see this warning when using one of the editor creators directly** (not a build), then it means\n\t\t\t * that you tried loading plugins by name. However, unlike CKEditor 4, CKEditor 5 does not implement a \"plugin loader\".\n\t\t\t * This means that CKEditor 5 does not know where to load the plugin modules from. Therefore, you need to\n\t\t\t * provide each plugin through reference (as a constructor function). Check out the examples in\n\t\t\t * {@glink builds/guides/integration/advanced-setup#scenario-2-building-from-source \"Building from source\"}.\n\t\t\t *\n\t\t\t * @error plugincollection-plugin-not-found\n\t\t\t * @param {Array.<String>} plugins The name of the plugins which could not be loaded.\n\t\t\t */\n\t\t\tconst errorMsg = 'plugincollection-plugin-not-found: Some plugins are not available and could not be loaded.';\n\n\t\t\t// Log the error so it's more visible on the console. Hopefully, for better DX.\n\t\t\tconsole.error( attachLinkToDocumentation( errorMsg ), { plugins: missingPlugins } );\n\n\t\t\treturn Promise.reject( new CKEditorError( errorMsg, context, { plugins: missingPlugins } ) );\n\t\t}\n\n\t\treturn Promise.all( pluginConstructors.map( loadPlugin ) )\n\t\t\t.then( () => initPlugins( loaded, 'init' ) )\n\t\t\t.then( () => initPlugins( loaded, 'afterInit' ) )\n\t\t\t.then( () => loaded );\n\n\t\tfunction loadPlugin( PluginConstructor ) {\n\t\t\tif ( removePluginConstructors.includes( PluginConstructor ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// The plugin is already loaded or being loaded - do nothing.\n\t\t\tif ( that._plugins.has( PluginConstructor ) || loading.has( PluginConstructor ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\treturn instantiatePlugin( PluginConstructor )\n\t\t\t\t.catch( err => {\n\t\t\t\t\t/**\n\t\t\t\t\t * It was not possible to load the plugin.\n\t\t\t\t\t *\n\t\t\t\t\t * This is a generic error logged to the console when a JavaSript error is thrown during the initialization\n\t\t\t\t\t * of one of the plugins.\n\t\t\t\t\t *\n\t\t\t\t\t * If you correctly handled the promise returned by the editor's `create()` method (like shown below),\n\t\t\t\t\t * you will find the original error logged to the console, too:\n\t\t\t\t\t *\n\t\t\t\t\t *\t\tClassicEditor.create( document.getElementById( 'editor' ) )\n\t\t\t\t\t *\t\t\t.then( editor => {\n\t\t\t\t\t *\t\t\t\t// ...\n\t\t\t\t\t * \t\t\t} )\n\t\t\t\t\t *\t\t\t.catch( error => {\n\t\t\t\t\t *\t\t\t\tconsole.error( error );\n\t\t\t\t\t *\t\t\t} );\n\t\t\t\t\t *\n\t\t\t\t\t * @error plugincollection-load\n\t\t\t\t\t * @param {String} plugin The name of the plugin that could not be loaded.\n\t\t\t\t\t */\n\t\t\t\t\tconsole.error( attachLinkToDocumentation(\n\t\t\t\t\t\t'plugincollection-load: It was not possible to load the plugin.'\n\t\t\t\t\t), { plugin: PluginConstructor } );\n\n\t\t\t\t\tthrow err;\n\t\t\t\t} );\n\t\t}\n\n\t\tfunction initPlugins( loadedPlugins, method ) {\n\t\t\treturn loadedPlugins.reduce( ( promise, plugin ) => {\n\t\t\t\tif ( !plugin[ method ] ) {\n\t\t\t\t\treturn promise;\n\t\t\t\t}\n\n\t\t\t\tif ( that._contextPlugins.has( plugin ) ) {\n\t\t\t\t\treturn promise;\n\t\t\t\t}\n\n\t\t\t\treturn promise.then( plugin[ method ].bind( plugin ) );\n\t\t\t}, Promise.resolve() );\n\t\t}\n\n\t\tfunction instantiatePlugin( PluginConstructor ) {\n\t\t\treturn new Promise( resolve => {\n\t\t\t\tloading.add( PluginConstructor );\n\n\t\t\t\tif ( PluginConstructor.requires ) {\n\t\t\t\t\tPluginConstructor.requires.forEach( RequiredPluginConstructorOrName => {\n\t\t\t\t\t\tconst RequiredPluginConstructor = getPluginConstructor( RequiredPluginConstructorOrName );\n\n\t\t\t\t\t\tif ( PluginConstructor.isContextPlugin && !RequiredPluginConstructor.isContextPlugin ) {\n\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t * If a plugin is a context plugin, all plugins it requires should also be context plugins\n\t\t\t\t\t\t\t * instead of plugins. In other words, if one plugin can be used in the context,\n\t\t\t\t\t\t\t * all its requirements should also be ready to be used in the context. Note that the context\n\t\t\t\t\t\t\t * provides only a part of the API provided by the editor. If one plugin needs a full\n\t\t\t\t\t\t\t * editor API, all plugins which require it are considered as plugins that need a full\n\t\t\t\t\t\t\t * editor API.\n\t\t\t\t\t\t\t *\n\t\t\t\t\t\t\t * @error plugincollection-context-required\n\t\t\t\t\t\t\t * @param {String} plugin The name of the required plugin.\n\t\t\t\t\t\t\t * @param {String} requiredBy The name of the parent plugin.\n\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\tthrow new CKEditorError(\n\t\t\t\t\t\t\t\t'plugincollection-context-required: Context plugin can not require plugin which is not a context plugin',\n\t\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t\t{ plugin: RequiredPluginConstructor.name, requiredBy: PluginConstructor.name }\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( removePlugins.includes( RequiredPluginConstructor ) ) {\n\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t * Cannot load a plugin because one of its dependencies is listed in the `removePlugins` option.\n\t\t\t\t\t\t\t *\n\t\t\t\t\t\t\t * @error plugincollection-required\n\t\t\t\t\t\t\t * @param {String} plugin The name of the required plugin.\n\t\t\t\t\t\t\t * @param {String} requiredBy The name of the parent plugin.\n\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\tthrow new CKEditorError(\n\t\t\t\t\t\t\t\t'plugincollection-required: Cannot load a plugin because one of its dependencies is listed in' +\n\t\t\t\t\t\t\t\t'the `removePlugins` option.',\n\t\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\t\t{ plugin: RequiredPluginConstructor.name, requiredBy: PluginConstructor.name }\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tloadPlugin( RequiredPluginConstructor );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\tconst plugin = that._contextPlugins.get( PluginConstructor ) || new PluginConstructor( context );\n\t\t\t\tthat._add( PluginConstructor, plugin );\n\t\t\t\tloaded.push( plugin );\n\n\t\t\t\tresolve();\n\t\t\t} );\n\t\t}\n\n\t\tfunction getPluginConstructor( PluginConstructorOrName ) {\n\t\t\tif ( typeof PluginConstructorOrName == 'function' ) {\n\t\t\t\treturn PluginConstructorOrName;\n\t\t\t}\n\n\t\t\treturn that._availablePlugins.get( PluginConstructorOrName );\n\t\t}\n\n\t\tfunction getMissingPluginNames( plugins ) {\n\t\t\tconst missingPlugins = [];\n\n\t\t\tfor ( const pluginNameOrConstructor of plugins ) {\n\t\t\t\tif ( !getPluginConstructor( pluginNameOrConstructor ) ) {\n\t\t\t\t\tmissingPlugins.push( pluginNameOrConstructor );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn missingPlugins.length ? missingPlugins : null;\n\t\t}\n\n\t\tfunction mapToAvailableConstructors( plugins ) {\n\t\t\treturn plugins\n\t\t\t\t.map( pluginNameOrConstructor => getPluginConstructor( pluginNameOrConstructor ) )\n\t\t\t\t.filter( PluginConstructor => !!PluginConstructor );\n\t\t}\n\t}\n\n\t/**\n\t * Destroys all loaded plugins.\n\t *\n\t * @returns {Promise}\n\t */\n\tdestroy() {\n\t\tconst promises = [];\n\n\t\tfor ( const [ , pluginInstance ] of this ) {\n\t\t\tif ( typeof pluginInstance.destroy == 'function' && !this._contextPlugins.has( pluginInstance ) ) {\n\t\t\t\tpromises.push( pluginInstance.destroy() );\n\t\t\t}\n\t\t}\n\n\t\treturn Promise.all( promises );\n\t}\n\n\t/**\n\t * Adds the plugin to the collection. Exposed mainly for testing purposes.\n\t *\n\t * @protected\n\t * @param {Function} PluginConstructor The plugin constructor.\n\t * @param {module:core/plugin~PluginInterface} plugin The instance of the plugin.\n\t */\n\t_add( PluginConstructor, plugin ) {\n\t\tthis._plugins.set( PluginConstructor, plugin );\n\n\t\tconst pluginName = PluginConstructor.pluginName;\n\n\t\tif ( !pluginName ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( this._plugins.has( pluginName ) ) {\n\t\t\t/**\n\t\t\t * Two plugins with the same {@link module:core/plugin~PluginInterface.pluginName} were loaded.\n\t\t\t * This will lead to runtime conflicts between these plugins.\n\t\t\t *\n\t\t\t * In practice, this warning usually means that new plugins were added to an existing CKEditor 5 build.\n\t\t\t * Plugins should always be added to a source version of the editor (`@ckeditor/ckeditor5-editor-*`),\n\t\t\t * not to an editor imported from one of the `@ckeditor/ckeditor5-build-*` packages.\n\t\t\t *\n\t\t\t * Check your import paths and the list of plugins passed to\n\t\t\t * {@link module:core/editor/editor~Editor.create `Editor.create()`}\n\t\t\t * or specified in {@link module:core/editor/editor~Editor.builtinPlugins `Editor.builtinPlugins`}.\n\t\t\t *\n\t\t\t * The second option is that your `node_modules/` directory contains duplicated versions of the same\n\t\t\t * CKEditor 5 packages. Normally, on clean installations, npm deduplicates packages in `node_modules/`, so\n\t\t\t * it may be enough to call `rm -rf node_modules && npm i`. However, if you installed conflicting versions\n\t\t\t * of packages, their dependencies may need to be installed in more than one version which may lead to this\n\t\t\t * warning.\n\t\t\t *\n\t\t\t * Technically speaking, this error occurs because after adding a plugin to an existing editor build\n\t\t\t * dependencies of this plugin are being duplicated.\n\t\t\t * They are already built into that editor build and now get added for the second time as dependencies\n\t\t\t * of the plugin you are installing.\n\t\t\t *\n\t\t\t * Read more about {@glink builds/guides/integration/installing-plugins installing plugins}.\n\t\t\t *\n\t\t\t * @error plugincollection-plugin-name-conflict\n\t\t\t * @param {String} pluginName The duplicated plugin name.\n\t\t\t * @param {Function} plugin1 The first plugin constructor.\n\t\t\t * @param {Function} plugin2 The second plugin constructor.\n\t\t\t */\n\t\t\tthrow new CKEditorError(\n\t\t\t\t'plugincollection-plugin-name-conflict: Two plugins with the same name were loaded.',\n\t\t\t\tnull,\n\t\t\t\t{ pluginName, plugin1: this._plugins.get( pluginName ).constructor, plugin2: PluginConstructor }\n\t\t\t);\n\t\t}\n\n\t\tthis._plugins.set( pluginName, plugin );\n\t}\n}\n\nmix( PluginCollection, EmitterMixin );\n"]}]}