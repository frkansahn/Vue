{"remainingRequest":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-utils\\src\\observablemixin.js","dependencies":[{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-utils\\src\\observablemixin.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-dev-webpack-plugin\\lib\\translatesourceloader.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1581760768702},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1581760768279}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZXZlcnkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZyb20iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm1hcCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKaW1wb3J0IF90eXBlb2YgZnJvbSAiQzpcXFVzZXJzXFxwY1xcRGVza3RvcFxcUmVzdG9yYW5cXFJlc3RvcmFuXFxSZXN0b3Jhbi5VSVxcY2xpZW50XFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS90eXBlb2YiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIkM6XFxVc2Vyc1xccGNcXERlc2t0b3BcXFJlc3RvcmFuXFxSZXN0b3JhblxcUmVzdG9yYW4uVUlcXGNsaWVudFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwoKLyoqCiAqIEBsaWNlbnNlIENvcHlyaWdodCAoYykgMjAwMy0yMDIwLCBDS1NvdXJjZSAtIEZyZWRlcmljbyBLbmFiYmVuLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiBGb3IgbGljZW5zaW5nLCBzZWUgTElDRU5TRS5tZCBvciBodHRwczovL2NrZWRpdG9yLmNvbS9sZWdhbC9ja2VkaXRvci1vc3MtbGljZW5zZQogKi8KCi8qKgogKiBAbW9kdWxlIHV0aWxzL29ic2VydmFibGVtaXhpbgogKi8KaW1wb3J0IEVtaXR0ZXJNaXhpbiBmcm9tICcuL2VtaXR0ZXJtaXhpbic7CmltcG9ydCBDS0VkaXRvckVycm9yIGZyb20gJy4vY2tlZGl0b3JlcnJvcic7CmltcG9ydCB7IGV4dGVuZCwgaXNPYmplY3QgfSBmcm9tICdsb2Rhc2gtZXMnOwp2YXIgb2JzZXJ2YWJsZVByb3BlcnRpZXNTeW1ib2wgPSBTeW1ib2woJ29ic2VydmFibGVQcm9wZXJ0aWVzJyk7CnZhciBib3VuZE9ic2VydmFibGVzU3ltYm9sID0gU3ltYm9sKCdib3VuZE9ic2VydmFibGVzJyk7CnZhciBib3VuZFByb3BlcnRpZXNTeW1ib2wgPSBTeW1ib2woJ2JvdW5kUHJvcGVydGllcycpOwovKioKICogTWl4aW4gdGhhdCBpbmplY3RzIHRoZSAib2JzZXJ2YWJsZSBwcm9wZXJ0aWVzIiBhbmQgZGF0YSBiaW5kaW5nIGZ1bmN0aW9uYWxpdHkgZGVzY3JpYmVkIGluIHRoZQogKiB7QGxpbmsgfk9ic2VydmFibGV9IGludGVyZmFjZS4KICoKICogUmVhZCBtb3JlIGFib3V0IHRoZSBjb25jZXB0IG9mIG9ic2VydmFibGVzIGluIHRoZToKICogKiB7QGdsaW5rIGZyYW1ld29yay9ndWlkZXMvYXJjaGl0ZWN0dXJlL2NvcmUtZWRpdG9yLWFyY2hpdGVjdHVyZSNldmVudC1zeXN0ZW0tYW5kLW9ic2VydmFibGVzICJFdmVudCBzeXN0ZW0gYW5kIG9ic2VydmFibGVzIn0KICogc2VjdGlvbiBvZiB0aGUge0BnbGluayBmcmFtZXdvcmsvZ3VpZGVzL2FyY2hpdGVjdHVyZS9jb3JlLWVkaXRvci1hcmNoaXRlY3R1cmUgIkNvcmUgZWRpdG9yIGFyY2hpdGVjdHVyZSJ9IGd1aWRlLAogKiAqIHtAZ2xpbmsgZnJhbWV3b3JrL2d1aWRlcy9kZWVwLWRpdmUvb2JzZXJ2YWJsZXMgIk9ic2VydmFibGVzIiBkZWVwIGRpdmV9IGd1aWRlLgogKgogKiBAbWl4aW4gT2JzZXJ2YWJsZU1peGluCiAqIEBtaXhlcyBtb2R1bGU6dXRpbHMvZW1pdHRlcm1peGlufkVtaXR0ZXJNaXhpbgogKiBAaW1wbGVtZW50cyBtb2R1bGU6dXRpbHMvb2JzZXJ2YWJsZW1peGlufk9ic2VydmFibGUKICovCgp2YXIgT2JzZXJ2YWJsZU1peGluID0gewogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgc2V0OiBmdW5jdGlvbiBzZXQobmFtZSwgdmFsdWUpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgLy8gSWYgdGhlIGZpcnN0IHBhcmFtZXRlciBpcyBhbiBPYmplY3QsIGl0ZXJhdGUgb3ZlciBpdHMgcHJvcGVydGllcy4KICAgIGlmIChpc09iamVjdChuYW1lKSkgewogICAgICBPYmplY3Qua2V5cyhuYW1lKS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wZXJ0eSkgewogICAgICAgIF90aGlzLnNldChwcm9wZXJ0eSwgbmFtZVtwcm9wZXJ0eV0pOwogICAgICB9LCB0aGlzKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGluaXRPYnNlcnZhYmxlKHRoaXMpOwogICAgdmFyIHByb3BlcnRpZXMgPSB0aGlzW29ic2VydmFibGVQcm9wZXJ0aWVzU3ltYm9sXTsKCiAgICBpZiAobmFtZSBpbiB0aGlzICYmICFwcm9wZXJ0aWVzLmhhcyhuYW1lKSkgewogICAgICAvKioKICAgICAgICogQ2Fubm90IG92ZXJyaWRlIGFuIGV4aXN0aW5nIHByb3BlcnR5LgogICAgICAgKgogICAgICAgKiBUaGlzIGVycm9yIGlzIHRocm93biB3aGVuIHRyeWluZyB0byB7QGxpbmsgfk9ic2VydmFibGUjc2V0IHNldH0gYW4gcHJvcGVydHkgd2l0aAogICAgICAgKiBhIG5hbWUgb2YgYW4gYWxyZWFkeSBleGlzdGluZyBwcm9wZXJ0eS4gRm9yIGV4YW1wbGU6CiAgICAgICAqCiAgICAgICAqCQlsZXQgb2JzZXJ2YWJsZSA9IG5ldyBNb2RlbCgpOwogICAgICAgKgkJb2JzZXJ2YWJsZS5wcm9wZXJ0eSA9IDE7CiAgICAgICAqCQlvYnNlcnZhYmxlLnNldCggJ3Byb3BlcnR5JywgMiApOwkJCS8vIHRocm93cwogICAgICAgKgogICAgICAgKgkJb2JzZXJ2YWJsZS5zZXQoICdwcm9wZXJ0eScsIDEgKTsKICAgICAgICoJCW9ic2VydmFibGUuc2V0KCAncHJvcGVydHknLCAyICk7CQkJLy8gb2ssIGJlY2F1c2UgdGhpcyBpcyBhbiBleGlzdGluZyBwcm9wZXJ0eS4KICAgICAgICoKICAgICAgICogQGVycm9yIG9ic2VydmFibGUtc2V0LWNhbm5vdC1vdmVycmlkZQogICAgICAgKi8KICAgICAgdGhyb3cgbmV3IENLRWRpdG9yRXJyb3IoJ29ic2VydmFibGUtc2V0LWNhbm5vdC1vdmVycmlkZTogQ2Fubm90IG92ZXJyaWRlIGFuIGV4aXN0aW5nIHByb3BlcnR5LicsIHRoaXMpOwogICAgfQoKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBuYW1lLCB7CiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHByb3BlcnRpZXMuZ2V0KG5hbWUpOwogICAgICB9LAogICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkgewogICAgICAgIHZhciBvbGRWYWx1ZSA9IHByb3BlcnRpZXMuZ2V0KG5hbWUpOyAvLyBGaXJlIGBzZXRgIGV2ZW50IGJlZm9yZSB0aGUgbmV3IHZhbHVlIHdpbGwgYmUgc2V0IHRvIG1ha2UgaXQgcG9zc2libGUKICAgICAgICAvLyB0byBvdmVycmlkZSBvYnNlcnZhYmxlIHByb3BlcnR5IHdpdGhvdXQgYWZmZWN0aW5nIGBjaGFuZ2VgIGV2ZW50LgogICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vY2tlZGl0b3IvY2tlZGl0b3I1LXV0aWxzL2lzc3Vlcy8xNzEuCgogICAgICAgIHZhciBuZXdWYWx1ZSA9IHRoaXMuZmlyZSgnc2V0OicgKyBuYW1lLCBuYW1lLCB2YWx1ZSwgb2xkVmFsdWUpOwoKICAgICAgICBpZiAobmV3VmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgbmV3VmFsdWUgPSB2YWx1ZTsKICAgICAgICB9IC8vIEFsbG93IHVuZGVmaW5lZCBhcyBhbiBpbml0aWFsIHZhbHVlIGxpa2UgQS5kZWZpbmUoICd4JywgdW5kZWZpbmVkICkgKCMxMzIpLgogICAgICAgIC8vIE5vdGU6IFdoZW4gcHJvcGVydGllcyBtYXAgaGFzIG5vIHN1Y2ggb3duIHByb3BlcnR5LCB0aGVuIGl0cyB2YWx1ZSBpcyB1bmRlZmluZWQuCgoKICAgICAgICBpZiAob2xkVmFsdWUgIT09IG5ld1ZhbHVlIHx8ICFwcm9wZXJ0aWVzLmhhcyhuYW1lKSkgewogICAgICAgICAgcHJvcGVydGllcy5zZXQobmFtZSwgbmV3VmFsdWUpOwogICAgICAgICAgdGhpcy5maXJlKCdjaGFuZ2U6JyArIG5hbWUsIG5hbWUsIG5ld1ZhbHVlLCBvbGRWYWx1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIHRoaXNbbmFtZV0gPSB2YWx1ZTsKICB9LAoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogIGJpbmQ6IGZ1bmN0aW9uIGJpbmQoKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYmluZFByb3BlcnRpZXMgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgIGJpbmRQcm9wZXJ0aWVzW19rZXldID0gYXJndW1lbnRzW19rZXldOwogICAgfQoKICAgIGlmICghYmluZFByb3BlcnRpZXMubGVuZ3RoIHx8ICFpc1N0cmluZ0FycmF5KGJpbmRQcm9wZXJ0aWVzKSkgewogICAgICAvKioKICAgICAgICogQWxsIHByb3BlcnRpZXMgbXVzdCBiZSBzdHJpbmdzLgogICAgICAgKgogICAgICAgKiBAZXJyb3Igb2JzZXJ2YWJsZS1iaW5kLXdyb25nLXByb3BlcnRpZXMKICAgICAgICovCiAgICAgIHRocm93IG5ldyBDS0VkaXRvckVycm9yKCdvYnNlcnZhYmxlLWJpbmQtd3JvbmctcHJvcGVydGllczogQWxsIHByb3BlcnRpZXMgbXVzdCBiZSBzdHJpbmdzLicsIHRoaXMpOwogICAgfQoKICAgIGlmIChuZXcgU2V0KGJpbmRQcm9wZXJ0aWVzKS5zaXplICE9PSBiaW5kUHJvcGVydGllcy5sZW5ndGgpIHsKICAgICAgLyoqCiAgICAgICAqIFByb3BlcnRpZXMgbXVzdCBiZSB1bmlxdWUuCiAgICAgICAqCiAgICAgICAqIEBlcnJvciBvYnNlcnZhYmxlLWJpbmQtZHVwbGljYXRlLXByb3BlcnRpZXMKICAgICAgICovCiAgICAgIHRocm93IG5ldyBDS0VkaXRvckVycm9yKCdvYnNlcnZhYmxlLWJpbmQtZHVwbGljYXRlLXByb3BlcnRpZXM6IFByb3BlcnRpZXMgbXVzdCBiZSB1bmlxdWUuJywgdGhpcyk7CiAgICB9CgogICAgaW5pdE9ic2VydmFibGUodGhpcyk7CiAgICB2YXIgYm91bmRQcm9wZXJ0aWVzID0gdGhpc1tib3VuZFByb3BlcnRpZXNTeW1ib2xdOwogICAgYmluZFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAocHJvcGVydHlOYW1lKSB7CiAgICAgIGlmIChib3VuZFByb3BlcnRpZXMuaGFzKHByb3BlcnR5TmFtZSkpIHsKICAgICAgICAvKioKICAgICAgICAgKiBDYW5ub3QgYmluZCB0aGUgc2FtZSBwcm9wZXJ0eSBtb3JlIHRoYW4gb25jZS4KICAgICAgICAgKgogICAgICAgICAqIEBlcnJvciBvYnNlcnZhYmxlLWJpbmQtcmViaW5kCiAgICAgICAgICovCiAgICAgICAgdGhyb3cgbmV3IENLRWRpdG9yRXJyb3IoJ29ic2VydmFibGUtYmluZC1yZWJpbmQ6IENhbm5vdCBiaW5kIHRoZSBzYW1lIHByb3BlcnR5IG1vcmUgdGhhbiBvbmNlLicsIF90aGlzMik7CiAgICAgIH0KICAgIH0pOwogICAgdmFyIGJpbmRpbmdzID0gbmV3IE1hcCgpOyAvLyBAdHlwZWRlZiB7T2JqZWN0fSBCaW5kaW5nCiAgICAvLyBAcHJvcGVydHkge0FycmF5fSBwcm9wZXJ0eSBQcm9wZXJ0eSB3aGljaCBpcyBib3VuZC4KICAgIC8vIEBwcm9wZXJ0eSB7QXJyYXl9IHRvIEFycmF5IG9mIG9ic2VydmFibGXigJNwcm9wZXJ0eSBjb21wb25lbnRzIG9mIHRoZSBiaW5kaW5nIChgeyBvYnNlcnZhYmxlOiAuLi4sIHByb3BlcnR5OiAuLiB9YCkuCiAgICAvLyBAcHJvcGVydHkge0FycmF5fSBjYWxsYmFjayBBIGZ1bmN0aW9uIHdoaWNoIHByb2Nlc3NlcyBgdG9gIGNvbXBvbmVudHMuCgogICAgYmluZFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAoYSkgewogICAgICB2YXIgYmluZGluZyA9IHsKICAgICAgICBwcm9wZXJ0eTogYSwKICAgICAgICB0bzogW10KICAgICAgfTsKICAgICAgYm91bmRQcm9wZXJ0aWVzLnNldChhLCBiaW5kaW5nKTsKICAgICAgYmluZGluZ3Muc2V0KGEsIGJpbmRpbmcpOwogICAgfSk7IC8vIEB0eXBlZGVmIHtPYmplY3R9IEJpbmRDaGFpbgogICAgLy8gQHByb3BlcnR5IHtGdW5jdGlvbn0gdG8gU2VlIHtAbGluayB+T2JzZXJ2YWJsZU1peGluI19iaW5kVG99LgogICAgLy8gQHByb3BlcnR5IHtGdW5jdGlvbn0gdG9NYW55IFNlZSB7QGxpbmsgfk9ic2VydmFibGVNaXhpbiNfYmluZFRvTWFueX0uCiAgICAvLyBAcHJvcGVydHkge21vZHVsZTp1dGlscy9vYnNlcnZhYmxlbWl4aW5+T2JzZXJ2YWJsZX0gX29ic2VydmFibGUgVGhlIG9ic2VydmFibGUgd2hpY2ggaW5pdGlhbGl6ZXMgdGhlIGJpbmRpbmcuCiAgICAvLyBAcHJvcGVydHkge0FycmF5fSBfYmluZFByb3BlcnRpZXMgQXJyYXkgb2YgYF9vYnNlcnZhYmxlYCBwcm9wZXJ0aWVzIHRvIGJlIGJvdW5kLgogICAgLy8gQHByb3BlcnR5IHtBcnJheX0gX3RvIEFycmF5IG9mIGB0bygpYCBvYnNlcnZhYmxl4oCTcHJvcGVydGllcyAoYHsgb2JzZXJ2YWJsZTogdG9PYnNlcnZhYmxlLCBwcm9wZXJ0aWVzOiAuLi50b1Byb3BlcnRpZXMgfWApLgogICAgLy8gQHByb3BlcnR5IHtNYXB9IF9iaW5kaW5ncyBTdG9yZXMgYmluZGluZ3MgdG8gYmUga2VwdCBpbgogICAgLy8ge0BsaW5rIH5PYnNlcnZhYmxlTWl4aW4jX2JvdW5kUHJvcGVydGllc30ve0BsaW5rIH5PYnNlcnZhYmxlTWl4aW4jX2JvdW5kT2JzZXJ2YWJsZXN9CiAgICAvLyBpbml0aWF0ZWQgaW4gdGhpcyBiaW5kaW5nIGNoYWluLgoKICAgIHJldHVybiB7CiAgICAgIHRvOiBiaW5kVG8sCiAgICAgIHRvTWFueTogYmluZFRvTWFueSwKICAgICAgX29ic2VydmFibGU6IHRoaXMsCiAgICAgIF9iaW5kUHJvcGVydGllczogYmluZFByb3BlcnRpZXMsCiAgICAgIF90bzogW10sCiAgICAgIF9iaW5kaW5nczogYmluZGluZ3MKICAgIH07CiAgfSwKCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICB1bmJpbmQ6IGZ1bmN0aW9uIHVuYmluZCgpIHsKICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgIC8vIE5vdGhpbmcgdG8gZG8gaGVyZSBpZiBub3QgaW5pdGVkIHlldC4KICAgIGlmICghKG9ic2VydmFibGVQcm9wZXJ0aWVzU3ltYm9sIGluIHRoaXMpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgYm91bmRQcm9wZXJ0aWVzID0gdGhpc1tib3VuZFByb3BlcnRpZXNTeW1ib2xdOwogICAgdmFyIGJvdW5kT2JzZXJ2YWJsZXMgPSB0aGlzW2JvdW5kT2JzZXJ2YWJsZXNTeW1ib2xdOwoKICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgdW5iaW5kUHJvcGVydGllcyA9IG5ldyBBcnJheShfbGVuMiksIF9rZXkyID0gMDsgX2tleTIgPCBfbGVuMjsgX2tleTIrKykgewogICAgICB1bmJpbmRQcm9wZXJ0aWVzW19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07CiAgICB9CgogICAgaWYgKHVuYmluZFByb3BlcnRpZXMubGVuZ3RoKSB7CiAgICAgIGlmICghaXNTdHJpbmdBcnJheSh1bmJpbmRQcm9wZXJ0aWVzKSkgewogICAgICAgIC8qKgogICAgICAgICAqIFByb3BlcnRpZXMgbXVzdCBiZSBzdHJpbmdzLgogICAgICAgICAqCiAgICAgICAgICogQGVycm9yIG9ic2VydmFibGUtdW5iaW5kLXdyb25nLXByb3BlcnRpZXMKICAgICAgICAgKi8KICAgICAgICB0aHJvdyBuZXcgQ0tFZGl0b3JFcnJvcignb2JzZXJ2YWJsZS11bmJpbmQtd3JvbmctcHJvcGVydGllczogUHJvcGVydGllcyBtdXN0IGJlIHN0cmluZ3MuJywgdGhpcyk7CiAgICAgIH0KCiAgICAgIHVuYmluZFByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbiAocHJvcGVydHlOYW1lKSB7CiAgICAgICAgdmFyIGJpbmRpbmcgPSBib3VuZFByb3BlcnRpZXMuZ2V0KHByb3BlcnR5TmFtZSk7IC8vIE5vdGhpbmcgdG8gZG8gaWYgdGhlIGJpbmRpbmcgaXMgbm90IGRlZmluZWQKCiAgICAgICAgaWYgKCFiaW5kaW5nKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgdG9PYnNlcnZhYmxlLCB0b1Byb3BlcnR5LCB0b1Byb3BlcnRpZXMsIHRvUHJvcGVydHlCaW5kaW5nczsKICAgICAgICBiaW5kaW5nLnRvLmZvckVhY2goZnVuY3Rpb24gKHRvKSB7CiAgICAgICAgICAvLyBUT0RPOiBFUzYgZGVzdHJ1Y3R1cmluZy4KICAgICAgICAgIHRvT2JzZXJ2YWJsZSA9IHRvWzBdOwogICAgICAgICAgdG9Qcm9wZXJ0eSA9IHRvWzFdOwogICAgICAgICAgdG9Qcm9wZXJ0aWVzID0gYm91bmRPYnNlcnZhYmxlcy5nZXQodG9PYnNlcnZhYmxlKTsKICAgICAgICAgIHRvUHJvcGVydHlCaW5kaW5ncyA9IHRvUHJvcGVydGllc1t0b1Byb3BlcnR5XTsKICAgICAgICAgIHRvUHJvcGVydHlCaW5kaW5ncy5kZWxldGUoYmluZGluZyk7CgogICAgICAgICAgaWYgKCF0b1Byb3BlcnR5QmluZGluZ3Muc2l6ZSkgewogICAgICAgICAgICBkZWxldGUgdG9Qcm9wZXJ0aWVzW3RvUHJvcGVydHldOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghT2JqZWN0LmtleXModG9Qcm9wZXJ0aWVzKS5sZW5ndGgpIHsKICAgICAgICAgICAgYm91bmRPYnNlcnZhYmxlcy5kZWxldGUodG9PYnNlcnZhYmxlKTsKCiAgICAgICAgICAgIF90aGlzMy5zdG9wTGlzdGVuaW5nKHRvT2JzZXJ2YWJsZSwgJ2NoYW5nZScpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGJvdW5kUHJvcGVydGllcy5kZWxldGUocHJvcGVydHlOYW1lKTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBib3VuZE9ic2VydmFibGVzLmZvckVhY2goZnVuY3Rpb24gKGJpbmRpbmdzLCBib3VuZE9ic2VydmFibGUpIHsKICAgICAgICBfdGhpczMuc3RvcExpc3RlbmluZyhib3VuZE9ic2VydmFibGUsICdjaGFuZ2UnKTsKICAgICAgfSk7CiAgICAgIGJvdW5kT2JzZXJ2YWJsZXMuY2xlYXIoKTsKICAgICAgYm91bmRQcm9wZXJ0aWVzLmNsZWFyKCk7CiAgICB9CiAgfSwKCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICBkZWNvcmF0ZTogZnVuY3Rpb24gZGVjb3JhdGUobWV0aG9kTmFtZSkgewogICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgdmFyIG9yaWdpbmFsTWV0aG9kID0gdGhpc1ttZXRob2ROYW1lXTsKCiAgICBpZiAoIW9yaWdpbmFsTWV0aG9kKSB7CiAgICAgIC8qKgogICAgICAgKiBDYW5ub3QgZGVjb3JhdGUgYW4gdW5kZWZpbmVkIG1ldGhvZC4KICAgICAgICoKICAgICAgICogQGVycm9yIG9ic2VydmFibGVtaXhpbi1jYW5ub3QtZGVjb3JhdGUtdW5kZWZpbmVkCiAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB3aGljaCBtZXRob2Qgc2hvdWxkIGJlIGRlY29yYXRlZC4KICAgICAgICogQHBhcmFtIHtTdHJpbmd9IG1ldGhvZE5hbWUgTmFtZSBvZiB0aGUgbWV0aG9kIHdoaWNoIGRvZXMgbm90IGV4aXN0LgogICAgICAgKi8KICAgICAgdGhyb3cgbmV3IENLRWRpdG9yRXJyb3IoJ29ic2VydmFibGVtaXhpbi1jYW5ub3QtZGVjb3JhdGUtdW5kZWZpbmVkOiBDYW5ub3QgZGVjb3JhdGUgYW4gdW5kZWZpbmVkIG1ldGhvZC4nLCB0aGlzLCB7CiAgICAgICAgb2JqZWN0OiB0aGlzLAogICAgICAgIG1ldGhvZE5hbWU6IG1ldGhvZE5hbWUKICAgICAgfSk7CiAgICB9CgogICAgdGhpcy5vbihtZXRob2ROYW1lLCBmdW5jdGlvbiAoZXZ0LCBhcmdzKSB7CiAgICAgIGV2dC5yZXR1cm4gPSBvcmlnaW5hbE1ldGhvZC5hcHBseShfdGhpczQsIGFyZ3MpOwogICAgfSk7CgogICAgdGhpc1ttZXRob2ROYW1lXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgZm9yICh2YXIgX2xlbjMgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4zKSwgX2tleTMgPSAwOyBfa2V5MyA8IF9sZW4zOyBfa2V5MysrKSB7CiAgICAgICAgYXJnc1tfa2V5M10gPSBhcmd1bWVudHNbX2tleTNdOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5maXJlKG1ldGhvZE5hbWUsIGFyZ3MpOwogICAgfTsKICB9Cn07CmV4dGVuZChPYnNlcnZhYmxlTWl4aW4sIEVtaXR0ZXJNaXhpbik7CmV4cG9ydCBkZWZhdWx0IE9ic2VydmFibGVNaXhpbjsgLy8gSW5pdCBzeW1ib2wgcHJvcGVydGllcyBuZWVkZWQgdG8gZm9yIHRoZSBvYnNlcnZhYmxlIG1lY2hhbmlzbSB0byB3b3JrLgovLwovLyBAcHJpdmF0ZQovLyBAcGFyYW0ge21vZHVsZTp1dGlscy9vYnNlcnZhYmxlbWl4aW5+T2JzZXJ2YWJsZU1peGlufSBvYnNlcnZhYmxlCgpmdW5jdGlvbiBpbml0T2JzZXJ2YWJsZShvYnNlcnZhYmxlKSB7CiAgLy8gRG8gbm90aGluZyBpZiBhbHJlYWR5IGluaXRlZC4KICBpZiAob2JzZXJ2YWJsZVByb3BlcnRpZXNTeW1ib2wgaW4gb2JzZXJ2YWJsZSkgewogICAgcmV0dXJuOwogIH0gLy8gVGhlIGludGVybmFsIGhhc2ggY29udGFpbmluZyB0aGUgb2JzZXJ2YWJsZSdzIHN0YXRlLgogIC8vCiAgLy8gQHByaXZhdGUKICAvLyBAdHlwZSB7TWFwfQoKCiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9ic2VydmFibGUsIG9ic2VydmFibGVQcm9wZXJ0aWVzU3ltYm9sLCB7CiAgICB2YWx1ZTogbmV3IE1hcCgpCiAgfSk7IC8vIE1hcCBjb250YWluaW5nIGJpbmRpbmdzIHRvIGV4dGVybmFsIG9ic2VydmFibGVzLiBJdCBzaGFyZXMgdGhlIGJpbmRpbmcgb2JqZWN0cwogIC8vIChgeyBvYnNlcnZhYmxlOiBBLCBwcm9wZXJ0eTogJ2EnLCB0bzogLi4uIH1gKSB3aXRoIHtAbGluayBtb2R1bGU6dXRpbHMvb2JzZXJ2YWJsZW1peGlufk9ic2VydmFibGVNaXhpbiNfYm91bmRQcm9wZXJ0aWVzfSBhbmQKICAvLyBpdCBpcyB1c2VkIHRvIG9ic2VydmUgZXh0ZXJuYWwgb2JzZXJ2YWJsZXMgdG8gdXBkYXRlIG93biBwcm9wZXJ0aWVzIGFjY29yZGluZ2x5LgogIC8vIFNlZSB7QGxpbmsgbW9kdWxlOnV0aWxzL29ic2VydmFibGVtaXhpbn5PYnNlcnZhYmxlTWl4aW4jYmluZH0uCiAgLy8KICAvLwkJQS5iaW5kKCAnYScsICdiJywgJ2MnICkudG8oIEIsICd4JywgJ3knLCAneCcgKTsKICAvLwkJY29uc29sZS5sb2coIEEuX2JvdW5kT2JzZXJ2YWJsZXMgKTsKICAvLwogIC8vCQkJTWFwKCB7CiAgLy8JCQkJQjogewogIC8vCQkJCQl4OiBTZXQoIFsKICAvLwkJCQkJCXsgb2JzZXJ2YWJsZTogQSwgcHJvcGVydHk6ICdhJywgdG86IFsgWyBCLCAneCcgXSBdIH0sCiAgLy8JCQkJCQl7IG9ic2VydmFibGU6IEEsIHByb3BlcnR5OiAnYycsIHRvOiBbIFsgQiwgJ3gnIF0gXSB9CiAgLy8JCQkJCV0gKSwKICAvLwkJCQkJeTogU2V0KCBbCiAgLy8JCQkJCQl7IG9ic2VydmFibGU6IEEsIHByb3BlcnR5OiAnYicsIHRvOiBbIFsgQiwgJ3knIF0gXSB9LAogIC8vCQkJCQldICkKICAvLwkJCQl9CiAgLy8JCQl9ICkKICAvLwogIC8vCQlBLmJpbmQoICdkJyApLnRvKCBCLCAneicgKS50byggQywgJ3cnICkuYXMoIGNhbGxiYWNrICk7CiAgLy8JCWNvbnNvbGUubG9nKCBBLl9ib3VuZE9ic2VydmFibGVzICk7CiAgLy8KICAvLwkJCU1hcCggewogIC8vCQkJCUI6IHsKICAvLwkJCQkJeDogU2V0KCBbCiAgLy8JCQkJCQl7IG9ic2VydmFibGU6IEEsIHByb3BlcnR5OiAnYScsIHRvOiBbIFsgQiwgJ3gnIF0gXSB9LAogIC8vCQkJCQkJeyBvYnNlcnZhYmxlOiBBLCBwcm9wZXJ0eTogJ2MnLCB0bzogWyBbIEIsICd4JyBdIF0gfQogIC8vCQkJCQldICksCiAgLy8JCQkJCXk6IFNldCggWwogIC8vCQkJCQkJeyBvYnNlcnZhYmxlOiBBLCBwcm9wZXJ0eTogJ2InLCB0bzogWyBbIEIsICd5JyBdIF0gfSwKICAvLwkJCQkJXSApLAogIC8vCQkJCQl6OiBTZXQoIFsKICAvLwkJCQkJCXsgb2JzZXJ2YWJsZTogQSwgcHJvcGVydHk6ICdkJywgdG86IFsgWyBCLCAneicgXSwgWyBDLCAndycgXSBdLCBjYWxsYmFjazogY2FsbGJhY2sgfQogIC8vCQkJCQldICkKICAvLwkJCQl9LAogIC8vCQkJCUM6IHsKICAvLwkJCQkJdzogU2V0KCBbCiAgLy8JCQkJCQl7IG9ic2VydmFibGU6IEEsIHByb3BlcnR5OiAnZCcsIHRvOiBbIFsgQiwgJ3onIF0sIFsgQywgJ3cnIF0gXSwgY2FsbGJhY2s6IGNhbGxiYWNrIH0KICAvLwkJCQkJXSApCiAgLy8JCQkJfQogIC8vCQkJfSApCiAgLy8KICAvLyBAcHJpdmF0ZQogIC8vIEB0eXBlIHtNYXB9CgogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYnNlcnZhYmxlLCBib3VuZE9ic2VydmFibGVzU3ltYm9sLCB7CiAgICB2YWx1ZTogbmV3IE1hcCgpCiAgfSk7IC8vIE9iamVjdCB0aGF0IHN0b3JlcyB3aGljaCBwcm9wZXJ0aWVzIG9mIHRoaXMgb2JzZXJ2YWJsZSBhcmUgYm91bmQgYW5kIGhvdy4gSXQgc2hhcmVzCiAgLy8gdGhlIGJpbmRpbmcgb2JqZWN0cyAoYHsgb2JzZXJ2YWJsZTogQSwgcHJvcGVydHk6ICdhJywgdG86IC4uLiB9YCkgd2l0aAogIC8vIHtAbGluayBtb2R1bGU6dXRpbHMvb2JzZXJ2YWJsZW1peGlufk9ic2VydmFibGVNaXhpbiNfYm91bmRPYnNlcnZhYmxlc30uIFRoaXMgZGF0YSBzdHJ1Y3R1cmUgaXMKICAvLyBhIHJldmVyc2Ugb2Yge0BsaW5rIG1vZHVsZTp1dGlscy9vYnNlcnZhYmxlbWl4aW5+T2JzZXJ2YWJsZU1peGluI19ib3VuZE9ic2VydmFibGVzfSBhbmQgaXQgaXMgaGVscGZ1bCBmb3IKICAvLyB7QGxpbmsgbW9kdWxlOnV0aWxzL29ic2VydmFibGVtaXhpbn5PYnNlcnZhYmxlTWl4aW4jdW5iaW5kfS4KICAvLwogIC8vIFNlZSB7QGxpbmsgbW9kdWxlOnV0aWxzL29ic2VydmFibGVtaXhpbn5PYnNlcnZhYmxlTWl4aW4jYmluZH0uCiAgLy8KICAvLwkJQS5iaW5kKCAnYScsICdiJywgJ2MnICkudG8oIEIsICd4JywgJ3knLCAneCcgKTsKICAvLwkJY29uc29sZS5sb2coIEEuX2JvdW5kUHJvcGVydGllcyApOwogIC8vCiAgLy8JCQlNYXAoIHsKICAvLwkJCQlhOiB7IG9ic2VydmFibGU6IEEsIHByb3BlcnR5OiAnYScsIHRvOiBbIFsgQiwgJ3gnIF0gXSB9LAogIC8vCQkJCWI6IHsgb2JzZXJ2YWJsZTogQSwgcHJvcGVydHk6ICdiJywgdG86IFsgWyBCLCAneScgXSBdIH0sCiAgLy8JCQkJYzogeyBvYnNlcnZhYmxlOiBBLCBwcm9wZXJ0eTogJ2MnLCB0bzogWyBbIEIsICd4JyBdIF0gfQogIC8vCQkJfSApCiAgLy8KICAvLwkJQS5iaW5kKCAnZCcgKS50byggQiwgJ3onICkudG8oIEMsICd3JyApLmFzKCBjYWxsYmFjayApOwogIC8vCQljb25zb2xlLmxvZyggQS5fYm91bmRQcm9wZXJ0aWVzICk7CiAgLy8KICAvLwkJCU1hcCggewogIC8vCQkJCWE6IHsgb2JzZXJ2YWJsZTogQSwgcHJvcGVydHk6ICdhJywgdG86IFsgWyBCLCAneCcgXSBdIH0sCiAgLy8JCQkJYjogeyBvYnNlcnZhYmxlOiBBLCBwcm9wZXJ0eTogJ2InLCB0bzogWyBbIEIsICd5JyBdIF0gfSwKICAvLwkJCQljOiB7IG9ic2VydmFibGU6IEEsIHByb3BlcnR5OiAnYycsIHRvOiBbIFsgQiwgJ3gnIF0gXSB9LAogIC8vCQkJCWQ6IHsgb2JzZXJ2YWJsZTogQSwgcHJvcGVydHk6ICdkJywgdG86IFsgWyBCLCAneicgXSwgWyBDLCAndycgXSBdLCBjYWxsYmFjazogY2FsbGJhY2sgfQogIC8vCQkJfSApCiAgLy8KICAvLyBAcHJpdmF0ZQogIC8vIEB0eXBlIHtNYXB9CgogIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYnNlcnZhYmxlLCBib3VuZFByb3BlcnRpZXNTeW1ib2wsIHsKICAgIHZhbHVlOiBuZXcgTWFwKCkKICB9KTsKfSAvLyBBIGNoYWluaW5nIGZvciB7QGxpbmsgbW9kdWxlOnV0aWxzL29ic2VydmFibGVtaXhpbn5PYnNlcnZhYmxlTWl4aW4jYmluZH0gcHJvdmlkaW5nIGAudG8oKWAgaW50ZXJmYWNlLgovLwovLyBAcHJpdmF0ZQovLyBAcGFyYW0gey4uLltPYnNlcnZhYmxlfFN0cmluZ3xGdW5jdGlvbl19IGFyZ3MgQXJndW1lbnRzIG9mIHRoZSBgLnRvKCBhcmdzIClgIGJpbmRpbmcuCgoKZnVuY3Rpb24gYmluZFRvKCkgewogIHZhciBfdGhpczUgPSB0aGlzOwoKICB2YXIgcGFyc2VkQXJncyA9IHBhcnNlQmluZFRvQXJncy5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cyk7CiAgdmFyIGJpbmRpbmdzS2V5cyA9IEFycmF5LmZyb20odGhpcy5fYmluZGluZ3Mua2V5cygpKTsKICB2YXIgbnVtYmVyT2ZCaW5kaW5ncyA9IGJpbmRpbmdzS2V5cy5sZW5ndGg7IC8vIEVsaW1pbmF0ZSBBLmJpbmQoICd4JyApLnRvKCBCLCBDICkKCiAgaWYgKCFwYXJzZWRBcmdzLmNhbGxiYWNrICYmIHBhcnNlZEFyZ3MudG8ubGVuZ3RoID4gMSkgewogICAgLyoqCiAgICAgKiBCaW5kaW5nIG11bHRpcGxlIG9ic2VydmFibGVzIG9ubHkgcG9zc2libGUgd2l0aCBjYWxsYmFjay4KICAgICAqCiAgICAgKiBAZXJyb3Igb2JzZXJ2YWJsZS1iaW5kLW5vLWNhbGxiYWNrCiAgICAgKi8KICAgIHRocm93IG5ldyBDS0VkaXRvckVycm9yKCdvYnNlcnZhYmxlLWJpbmQtdG8tbm8tY2FsbGJhY2s6IEJpbmRpbmcgbXVsdGlwbGUgb2JzZXJ2YWJsZXMgb25seSBwb3NzaWJsZSB3aXRoIGNhbGxiYWNrLicsIHRoaXMpOwogIH0gLy8gRWxpbWluYXRlIEEuYmluZCggJ3gnLCAneScgKS50byggQiwgY2FsbGJhY2sgKQoKCiAgaWYgKG51bWJlck9mQmluZGluZ3MgPiAxICYmIHBhcnNlZEFyZ3MuY2FsbGJhY2spIHsKICAgIC8qKgogICAgICogQ2Fubm90IGJpbmQgbXVsdGlwbGUgcHJvcGVydGllcyBhbmQgdXNlIGEgY2FsbGJhY2sgaW4gb25lIGJpbmRpbmcuCiAgICAgKgogICAgICogQGVycm9yIG9ic2VydmFibGUtYmluZC10by1leHRyYS1jYWxsYmFjawogICAgICovCiAgICB0aHJvdyBuZXcgQ0tFZGl0b3JFcnJvcignb2JzZXJ2YWJsZS1iaW5kLXRvLWV4dHJhLWNhbGxiYWNrOiBDYW5ub3QgYmluZCBtdWx0aXBsZSBwcm9wZXJ0aWVzIGFuZCB1c2UgYSBjYWxsYmFjayBpbiBvbmUgYmluZGluZy4nLCB0aGlzKTsKICB9CgogIHBhcnNlZEFyZ3MudG8uZm9yRWFjaChmdW5jdGlvbiAodG8pIHsKICAgIC8vIEVsaW1pbmF0ZSBBLmJpbmQoICd4JywgJ3knICkudG8oIEIsICdhJyApCiAgICBpZiAodG8ucHJvcGVydGllcy5sZW5ndGggJiYgdG8ucHJvcGVydGllcy5sZW5ndGggIT09IG51bWJlck9mQmluZGluZ3MpIHsKICAgICAgLyoqCiAgICAgICAqIFRoZSBudW1iZXIgb2YgcHJvcGVydGllcyBtdXN0IG1hdGNoLgogICAgICAgKgogICAgICAgKiBAZXJyb3Igb2JzZXJ2YWJsZS1iaW5kLXRvLXByb3BlcnRpZXMtbGVuZ3RoCiAgICAgICAqLwogICAgICB0aHJvdyBuZXcgQ0tFZGl0b3JFcnJvcignb2JzZXJ2YWJsZS1iaW5kLXRvLXByb3BlcnRpZXMtbGVuZ3RoOiBUaGUgbnVtYmVyIG9mIHByb3BlcnRpZXMgbXVzdCBtYXRjaC4nLCBfdGhpczUpOwogICAgfSAvLyBXaGVuIG5vIHRvLnByb3BlcnRpZXMgc3BlY2lmaWVkLCBvYnNlcnZpbmcgc291cmNlIHByb3BlcnRpZXMgaW5zdGVhZCBpLmUuCiAgICAvLyBBLmJpbmQoICd4JywgJ3knICkudG8oIEIgKSAtPiBPYnNlcnZlIEIueCBhbmQgQi55CgoKICAgIGlmICghdG8ucHJvcGVydGllcy5sZW5ndGgpIHsKICAgICAgdG8ucHJvcGVydGllcyA9IF90aGlzNS5fYmluZFByb3BlcnRpZXM7CiAgICB9CiAgfSk7CiAgdGhpcy5fdG8gPSBwYXJzZWRBcmdzLnRvOyAvLyBGaWxsIHtAbGluayBCaW5kQ2hhaW4jX2JpbmRpbmdzfSB3aXRoIGNhbGxiYWNrLiBXaGVuIHRoZSBjYWxsYmFjayBpcyBzZXQgdGhlcmUncyBvbmx5IG9uZSBiaW5kaW5nLgoKICBpZiAocGFyc2VkQXJncy5jYWxsYmFjaykgewogICAgdGhpcy5fYmluZGluZ3MuZ2V0KGJpbmRpbmdzS2V5c1swXSkuY2FsbGJhY2sgPSBwYXJzZWRBcmdzLmNhbGxiYWNrOwogIH0KCiAgYXR0YWNoQmluZFRvTGlzdGVuZXJzKHRoaXMuX29ic2VydmFibGUsIHRoaXMuX3RvKTsgLy8gVXBkYXRlIG9ic2VydmFibGUuX2JvdW5kUHJvcGVydGllcyBhbmQgb2JzZXJ2YWJsZS5fYm91bmRPYnNlcnZhYmxlcy4KCiAgdXBkYXRlQmluZFRvQm91bmQodGhpcyk7IC8vIFNldCBpbml0aWFsIHZhbHVlcyBvZiBib3VuZCBwcm9wZXJ0aWVzLgoKICB0aGlzLl9iaW5kUHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wZXJ0eU5hbWUpIHsKICAgIHVwZGF0ZUJvdW5kT2JzZXJ2YWJsZVByb3BlcnR5KF90aGlzNS5fb2JzZXJ2YWJsZSwgcHJvcGVydHlOYW1lKTsKICB9KTsKfSAvLyBCaW5kcyB0byBhbiBhdHRyaWJ1dGUgaW4gYSBzZXQgb2YgaXRlcmFibGUgb2JzZXJ2YWJsZXMuCi8vCi8vIEBwcml2YXRlCi8vIEBwYXJhbSB7QXJyYXkuPE9ic2VydmFibGU+fSBvYnNlcnZhYmxlcwovLyBAcGFyYW0ge1N0cmluZ30gYXR0cmlidXRlCi8vIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrCgoKZnVuY3Rpb24gYmluZFRvTWFueShvYnNlcnZhYmxlcywgYXR0cmlidXRlLCBjYWxsYmFjaykgewogIGlmICh0aGlzLl9iaW5kaW5ncy5zaXplID4gMSkgewogICAgLyoqCiAgICAgKiBCaW5kaW5nIG9uZSBhdHRyaWJ1dGUgdG8gbWFueSBvYnNlcnZhYmxlcyBvbmx5IHBvc3NpYmxlIHdpdGggb25lIGF0dHJpYnV0ZS4KICAgICAqCiAgICAgKiBAZXJyb3Igb2JzZXJ2YWJsZS1iaW5kLXRvLW1hbnktbm90LW9uZS1iaW5kaW5nCiAgICAgKi8KICAgIHRocm93IG5ldyBDS0VkaXRvckVycm9yKCdvYnNlcnZhYmxlLWJpbmQtdG8tbWFueS1ub3Qtb25lLWJpbmRpbmc6IENhbm5vdCBiaW5kIG11bHRpcGxlIHByb3BlcnRpZXMgd2l0aCB0b01hbnkoKS4nLCB0aGlzKTsKICB9CgogIHRoaXMudG8uYXBwbHkodGhpcywgX3RvQ29uc3VtYWJsZUFycmF5KGdldEJpbmRpbmdUYXJnZXRzKG9ic2VydmFibGVzLCBhdHRyaWJ1dGUpKS5jb25jYXQoWy8vIC4uLnVzaW5nIGdpdmVuIGNhbGxiYWNrIHRvIHBhcnNlIGF0dHJpYnV0ZSB2YWx1ZXMuCiAgY2FsbGJhY2tdKSk7Cn0gLy8gUmV0dXJucyBhbiBhcnJheSBvZiBiaW5kaW5nIGNvbXBvbmVudHMgZm9yCi8vIHtAbGluayBPYnNlcnZhYmxlI2JpbmR9IGZyb20gYSBzZXQgb2YgaXRlcmFibGUgb2JzZXJ2YWJsZXMuCi8vCi8vIEBwYXJhbSB7QXJyYXkuPE9ic2VydmFibGU+fSBvYnNlcnZhYmxlcwovLyBAcGFyYW0ge1N0cmluZ30gYXR0cmlidXRlCi8vIEByZXR1cm5zIHtBcnJheS48U3RyaW5nfE9ic2VydmFibGU+fQoKCmZ1bmN0aW9uIGdldEJpbmRpbmdUYXJnZXRzKG9ic2VydmFibGVzLCBhdHRyaWJ1dGUpIHsKICB2YXIgb2JzZXJ2YWJsZUFuZEF0dHJpYnV0ZVBhaXJzID0gb2JzZXJ2YWJsZXMubWFwKGZ1bmN0aW9uIChvYnNlcnZhYmxlKSB7CiAgICByZXR1cm4gW29ic2VydmFibGUsIGF0dHJpYnV0ZV07CiAgfSk7IC8vIE1lcmdlIHBhaXJzIHRvIG9uZS1kaW1lbnNpb24gYXJyYXkgb2Ygb2JzZXJ2YWJsZXMgYW5kIGF0dHJpYnV0ZXMuCgogIHJldHVybiBBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLCBvYnNlcnZhYmxlQW5kQXR0cmlidXRlUGFpcnMpOwp9IC8vIENoZWNrIGlmIGFsbCBlbnRyaWVzIG9mIHRoZSBhcnJheSBhcmUgb2YgYFN0cmluZ2AgdHlwZS4KLy8KLy8gQHByaXZhdGUKLy8gQHBhcmFtIHtBcnJheX0gYXJyIEFuIGFycmF5IHRvIGJlIGNoZWNrZWQuCi8vIEByZXR1cm5zIHtCb29sZWFufQoKCmZ1bmN0aW9uIGlzU3RyaW5nQXJyYXkoYXJyKSB7CiAgcmV0dXJuIGFyci5ldmVyeShmdW5jdGlvbiAoYSkgewogICAgcmV0dXJuIHR5cGVvZiBhID09ICdzdHJpbmcnOwogIH0pOwp9IC8vIFBhcnNlcyBhbmQgdmFsaWRhdGVzIHtAbGluayBPYnNlcnZhYmxlI2JpbmR9YC50byggYXJncyApYCBhcmd1bWVudHMgYW5kIHJldHVybnMKLy8gYW4gb2JqZWN0IHdpdGggYSBwYXJzZWQgc3RydWN0dXJlLiBGb3IgZXhhbXBsZQovLwovLwkJQS5iaW5kKCAneCcgKS50byggQiwgJ2EnLCBDLCAnYicsIGNhbGwgKTsKLy8KLy8gYmVjb21lcwovLwovLwkJewovLwkJCXRvOiBbCi8vCQkJCXsgb2JzZXJ2YWJsZTogQiwgcHJvcGVydGllczogWyAnYScgXSB9LAovLwkJCQl7IG9ic2VydmFibGU6IEMsIHByb3BlcnRpZXM6IFsgJ2InIF0gfSwKLy8JCQldLAovLwkJCWNhbGxiYWNrOiBjYWxsCi8vIAkJfQovLwovLyBAcHJpdmF0ZQovLyBAcGFyYW0gey4uLip9IGFyZ3MgQXJndW1lbnRzIG9mIHtAbGluayBPYnNlcnZhYmxlI2JpbmR9YC50byggYXJncyApYC4KLy8gQHJldHVybnMge09iamVjdH0KCgpmdW5jdGlvbiBwYXJzZUJpbmRUb0FyZ3MoKSB7CiAgZm9yICh2YXIgX2xlbjQgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW40KSwgX2tleTQgPSAwOyBfa2V5NCA8IF9sZW40OyBfa2V5NCsrKSB7CiAgICBhcmdzW19rZXk0XSA9IGFyZ3VtZW50c1tfa2V5NF07CiAgfQoKICAvLyBFbGltaW5hdGUgQS5iaW5kKCAneCcgKS50bygpCiAgaWYgKCFhcmdzLmxlbmd0aCkgewogICAgLyoqCiAgICAgKiBJbnZhbGlkIGFyZ3VtZW50IHN5bnRheCBpbiBgdG8oKWAuCiAgICAgKgogICAgICogQGVycm9yIG9ic2VydmFibGUtYmluZC10by1wYXJzZS1lcnJvcgogICAgICovCiAgICB0aHJvdyBuZXcgQ0tFZGl0b3JFcnJvcignb2JzZXJ2YWJsZS1iaW5kLXRvLXBhcnNlLWVycm9yOiBJbnZhbGlkIGFyZ3VtZW50IHN5bnRheCBpbiBgdG8oKWAuJywgbnVsbCk7CiAgfQoKICB2YXIgcGFyc2VkID0gewogICAgdG86IFtdCiAgfTsKICB2YXIgbGFzdE9ic2VydmFibGU7CgogIGlmICh0eXBlb2YgYXJnc1thcmdzLmxlbmd0aCAtIDFdID09ICdmdW5jdGlvbicpIHsKICAgIHBhcnNlZC5jYWxsYmFjayA9IGFyZ3MucG9wKCk7CiAgfQoKICBhcmdzLmZvckVhY2goZnVuY3Rpb24gKGEpIHsKICAgIGlmICh0eXBlb2YgYSA9PSAnc3RyaW5nJykgewogICAgICBsYXN0T2JzZXJ2YWJsZS5wcm9wZXJ0aWVzLnB1c2goYSk7CiAgICB9IGVsc2UgaWYgKF90eXBlb2YoYSkgPT0gJ29iamVjdCcpIHsKICAgICAgbGFzdE9ic2VydmFibGUgPSB7CiAgICAgICAgb2JzZXJ2YWJsZTogYSwKICAgICAgICBwcm9wZXJ0aWVzOiBbXQogICAgICB9OwogICAgICBwYXJzZWQudG8ucHVzaChsYXN0T2JzZXJ2YWJsZSk7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgQ0tFZGl0b3JFcnJvcignb2JzZXJ2YWJsZS1iaW5kLXRvLXBhcnNlLWVycm9yOiBJbnZhbGlkIGFyZ3VtZW50IHN5bnRheCBpbiBgdG8oKWAuJywgbnVsbCk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIHBhcnNlZDsKfSAvLyBTeW5jaHJvbml6ZXMge0BsaW5rIG1vZHVsZTp1dGlscy9vYnNlcnZhYmxlbWl4aW4jX2JvdW5kT2JzZXJ2YWJsZXN9IHdpdGgge0BsaW5rIEJpbmRpbmd9LgovLwovLyBAcHJpdmF0ZQovLyBAcGFyYW0ge0JpbmRpbmd9IGJpbmRpbmcgQSBiaW5kaW5nIHRvIHN0b3JlIGluIHtAbGluayBPYnNlcnZhYmxlI19ib3VuZE9ic2VydmFibGVzfS4KLy8gQHBhcmFtIHtPYnNlcnZhYmxlfSB0b09ic2VydmFibGUgQSBvYnNlcnZhYmxlLCB3aGljaCBpcyBhIG5ldyBjb21wb25lbnQgb2YgYGJpbmRpbmdgLgovLyBAcGFyYW0ge1N0cmluZ30gdG9Qcm9wZXJ0eU5hbWUgQSBuYW1lIG9mIGB0b09ic2VydmFibGVgJ3MgcHJvcGVydHksIGEgbmV3IGNvbXBvbmVudCBvZiB0aGUgYGJpbmRpbmdgLgoKCmZ1bmN0aW9uIHVwZGF0ZUJvdW5kT2JzZXJ2YWJsZXMob2JzZXJ2YWJsZSwgYmluZGluZywgdG9PYnNlcnZhYmxlLCB0b1Byb3BlcnR5TmFtZSkgewogIHZhciBib3VuZE9ic2VydmFibGVzID0gb2JzZXJ2YWJsZVtib3VuZE9ic2VydmFibGVzU3ltYm9sXTsKICB2YXIgYmluZGluZ3NUb09ic2VydmFibGUgPSBib3VuZE9ic2VydmFibGVzLmdldCh0b09ic2VydmFibGUpOwogIHZhciBiaW5kaW5ncyA9IGJpbmRpbmdzVG9PYnNlcnZhYmxlIHx8IHt9OwoKICBpZiAoIWJpbmRpbmdzW3RvUHJvcGVydHlOYW1lXSkgewogICAgYmluZGluZ3NbdG9Qcm9wZXJ0eU5hbWVdID0gbmV3IFNldCgpOwogIH0gLy8gUGFzcyB0aGUgYmluZGluZyB0byBhIGNvcnJlc3BvbmRpbmcgU2V0IGluIGBvYnNlcnZhYmxlLl9ib3VuZE9ic2VydmFibGVzYC4KCgogIGJpbmRpbmdzW3RvUHJvcGVydHlOYW1lXS5hZGQoYmluZGluZyk7CgogIGlmICghYmluZGluZ3NUb09ic2VydmFibGUpIHsKICAgIGJvdW5kT2JzZXJ2YWJsZXMuc2V0KHRvT2JzZXJ2YWJsZSwgYmluZGluZ3MpOwogIH0KfSAvLyBTeW5jaHJvbml6ZXMge0BsaW5rIE9ic2VydmFibGUjX2JvdW5kUHJvcGVydGllc30gYW5kIHtAbGluayBPYnNlcnZhYmxlI19ib3VuZE9ic2VydmFibGVzfQovLyB3aXRoIHtAbGluayBCaW5kQ2hhaW59LgovLwovLyBBc3N1bWluZyB0aGUgZm9sbG93aW5nIGJpbmRpbmcgYmVpbmcgY3JlYXRlZAovLwovLyAJCUEuYmluZCggJ2EnLCAnYicgKS50byggQiwgJ3gnLCAneScgKTsKLy8KLy8gdGhlIGZvbGxvd2luZyBiaW5kaW5ncyB3ZXJlIGluaXRpYWxpemVkIGJ5IHtAbGluayBPYnNlcnZhYmxlI2JpbmR9IGluIHtAbGluayBCaW5kQ2hhaW4jX2JpbmRpbmdzfToKLy8KLy8gCQl7Ci8vIAkJCWE6IHsgb2JzZXJ2YWJsZTogQSwgcHJvcGVydHk6ICdhJywgdG86IFtdIH0sCi8vIAkJCWI6IHsgb2JzZXJ2YWJsZTogQSwgcHJvcGVydHk6ICdiJywgdG86IFtdIH0sCi8vIAkJfQovLwovLyBJdGVyYXRlIG92ZXIgYWxsIGJpbmRpbmdzIGluIHRoaXMgY2hhaW4gYW5kIGZpbGwgdGhlaXIgYHRvYCBwcm9wZXJ0aWVzIHdpdGgKLy8gY29ycmVzcG9uZGluZyB0byggLi4uICkgYXJndW1lbnRzIChjb21wb25lbnRzIG9mIHRoZSBiaW5kaW5nKSwgc28KLy8KLy8gCQl7Ci8vIAkJCWE6IHsgb2JzZXJ2YWJsZTogQSwgcHJvcGVydHk6ICdhJywgdG86IFsgQiwgJ3gnIF0gfSwKLy8gCQkJYjogeyBvYnNlcnZhYmxlOiBBLCBwcm9wZXJ0eTogJ2InLCB0bzogWyBCLCAneScgXSB9LAovLyAJCX0KLy8KLy8gVGhlbiB1cGRhdGUgdGhlIHN0cnVjdHVyZSBvZiB7QGxpbmsgT2JzZXJ2YWJsZSNfYm91bmRPYnNlcnZhYmxlc30gd2l0aCB1cGRhdGVkCi8vIGJpbmRpbmcsIHNvIGl0IGJlY29tZXM6Ci8vCi8vIAkJTWFwKCB7Ci8vIAkJCUI6IHsKLy8gCQkJCXg6IFNldCggWwovLyAJCQkJCXsgb2JzZXJ2YWJsZTogQSwgcHJvcGVydHk6ICdhJywgdG86IFsgWyBCLCAneCcgXSBdIH0KLy8gCQkJCV0gKSwKLy8gCQkJCXk6IFNldCggWwovLyAJCQkJCXsgb2JzZXJ2YWJsZTogQSwgcHJvcGVydHk6ICdiJywgdG86IFsgWyBCLCAneScgXSBdIH0sCi8vIAkJCQldICkKLy8JCQl9Ci8vIAkJfSApCi8vCi8vIEBwcml2YXRlCi8vIEBwYXJhbSB7QmluZENoYWlufSBjaGFpbiBUaGUgYmluZGluZyBpbml0aWFsaXplZCBieSB7QGxpbmsgT2JzZXJ2YWJsZSNiaW5kfS4KCgpmdW5jdGlvbiB1cGRhdGVCaW5kVG9Cb3VuZChjaGFpbikgewogIHZhciB0b1Byb3BlcnR5OwoKICBjaGFpbi5fYmluZGluZ3MuZm9yRWFjaChmdW5jdGlvbiAoYmluZGluZywgcHJvcGVydHlOYW1lKSB7CiAgICAvLyBOb3RlOiBGb3IgYSBiaW5kaW5nIHdpdGhvdXQgYSBjYWxsYmFjaywgdGhpcyB3aWxsIHJ1biBvbmx5IG9uY2UKICAgIC8vIGxpa2UgaW4gQS5iaW5kKCAneCcsICd5JyApLnRvKCBCLCAnYScsICdiJyApCiAgICAvLyBUT0RPOiBFUzYgZGVzdHJ1Y3R1cmluZy4KICAgIGNoYWluLl90by5mb3JFYWNoKGZ1bmN0aW9uICh0bykgewogICAgICB0b1Byb3BlcnR5ID0gdG8ucHJvcGVydGllc1tiaW5kaW5nLmNhbGxiYWNrID8gMCA6IGNoYWluLl9iaW5kUHJvcGVydGllcy5pbmRleE9mKHByb3BlcnR5TmFtZSldOwogICAgICBiaW5kaW5nLnRvLnB1c2goW3RvLm9ic2VydmFibGUsIHRvUHJvcGVydHldKTsKICAgICAgdXBkYXRlQm91bmRPYnNlcnZhYmxlcyhjaGFpbi5fb2JzZXJ2YWJsZSwgYmluZGluZywgdG8ub2JzZXJ2YWJsZSwgdG9Qcm9wZXJ0eSk7CiAgICB9KTsKICB9KTsKfSAvLyBVcGRhdGVzIGFuIHByb3BlcnR5IG9mIGEge0BsaW5rIE9ic2VydmFibGV9IHdpdGggYSB2YWx1ZQovLyBkZXRlcm1pbmVkIGJ5IGFuIGVudHJ5IGluIHtAbGluayBPYnNlcnZhYmxlI19ib3VuZFByb3BlcnRpZXN9LgovLwovLyBAcHJpdmF0ZQovLyBAcGFyYW0ge09ic2VydmFibGV9IG9ic2VydmFibGUgQSBvYnNlcnZhYmxlIHdoaWNoIHByb3BlcnR5IGlzIHRvIGJlIHVwZGF0ZWQuCi8vIEBwYXJhbSB7U3RyaW5nfSBwcm9wZXJ0eU5hbWUgQW4gcHJvcGVydHkgdG8gYmUgdXBkYXRlZC4KCgpmdW5jdGlvbiB1cGRhdGVCb3VuZE9ic2VydmFibGVQcm9wZXJ0eShvYnNlcnZhYmxlLCBwcm9wZXJ0eU5hbWUpIHsKICB2YXIgYm91bmRQcm9wZXJ0aWVzID0gb2JzZXJ2YWJsZVtib3VuZFByb3BlcnRpZXNTeW1ib2xdOwogIHZhciBiaW5kaW5nID0gYm91bmRQcm9wZXJ0aWVzLmdldChwcm9wZXJ0eU5hbWUpOwogIHZhciBwcm9wZXJ0eVZhbHVlOyAvLyBXaGVuIGEgYmluZGluZyB3aXRoIGNhbGxiYWNrIGlzIGNyZWF0ZWQgbGlrZQogIC8vCiAgLy8gCQlBLmJpbmQoICdhJyApLnRvKCBCLCAnYicsIEMsICdjJywgY2FsbGJhY2sgKTsKICAvLwogIC8vIGNvbGxlY3QgQi5iIGFuZCBDLmMsIHRoZW4gcGFzcyB0aGVtIHRvIGNhbGxiYWNrIHRvIHNldCBBLmEuCgogIGlmIChiaW5kaW5nLmNhbGxiYWNrKSB7CiAgICBwcm9wZXJ0eVZhbHVlID0gYmluZGluZy5jYWxsYmFjay5hcHBseShvYnNlcnZhYmxlLCBiaW5kaW5nLnRvLm1hcChmdW5jdGlvbiAodG8pIHsKICAgICAgcmV0dXJuIHRvWzBdW3RvWzFdXTsKICAgIH0pKTsKICB9IGVsc2UgewogICAgcHJvcGVydHlWYWx1ZSA9IGJpbmRpbmcudG9bMF07CiAgICBwcm9wZXJ0eVZhbHVlID0gcHJvcGVydHlWYWx1ZVswXVtwcm9wZXJ0eVZhbHVlWzFdXTsKICB9CgogIGlmIChvYnNlcnZhYmxlLmhhc093blByb3BlcnR5KHByb3BlcnR5TmFtZSkpIHsKICAgIG9ic2VydmFibGVbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5VmFsdWU7CiAgfSBlbHNlIHsKICAgIG9ic2VydmFibGUuc2V0KHByb3BlcnR5TmFtZSwgcHJvcGVydHlWYWx1ZSk7CiAgfQp9IC8vIFN0YXJ0cyBsaXN0ZW5pbmcgdG8gY2hhbmdlcyBpbiB7QGxpbmsgQmluZENoYWluLl90b30gb2JzZXJ2YWJsZXMgdG8gdXBkYXRlCi8vIHtAbGluayBCaW5kQ2hhaW4uX29ic2VydmFibGV9IHtAbGluayBCaW5kQ2hhaW4uX2JpbmRQcm9wZXJ0aWVzfS4gQWxzbyBzZXRzIHRoZQovLyBpbml0aWFsIHN0YXRlIG9mIHtAbGluayBCaW5kQ2hhaW4uX29ic2VydmFibGV9LgovLwovLyBAcHJpdmF0ZQovLyBAcGFyYW0ge0JpbmRDaGFpbn0gY2hhaW4gVGhlIGNoYWluIGluaXRpYWxpemVkIGJ5IHtAbGluayBPYnNlcnZhYmxlI2JpbmR9LgoKCmZ1bmN0aW9uIGF0dGFjaEJpbmRUb0xpc3RlbmVycyhvYnNlcnZhYmxlLCB0b0JpbmRpbmdzKSB7CiAgdG9CaW5kaW5ncy5mb3JFYWNoKGZ1bmN0aW9uICh0bykgewogICAgdmFyIGJvdW5kT2JzZXJ2YWJsZXMgPSBvYnNlcnZhYmxlW2JvdW5kT2JzZXJ2YWJsZXNTeW1ib2xdOwogICAgdmFyIGJpbmRpbmdzOyAvLyBJZiB0aGVyZSdzIGFscmVhZHkgYSBjaGFpbiBiZXR3ZWVuIHRoZSBvYnNlcnZhYmxlcyAoYG9ic2VydmFibGVgIGxpc3RlbnMgdG8KICAgIC8vIGB0by5vYnNlcnZhYmxlYCksIHRoZXJlJ3Mgbm8gbmVlZCB0byBjcmVhdGUgYW5vdGhlciBgY2hhbmdlYCBldmVudCBsaXN0ZW5lci4KCiAgICBpZiAoIWJvdW5kT2JzZXJ2YWJsZXMuZ2V0KHRvLm9ic2VydmFibGUpKSB7CiAgICAgIG9ic2VydmFibGUubGlzdGVuVG8odG8ub2JzZXJ2YWJsZSwgJ2NoYW5nZScsIGZ1bmN0aW9uIChldnQsIHByb3BlcnR5TmFtZSkgewogICAgICAgIGJpbmRpbmdzID0gYm91bmRPYnNlcnZhYmxlcy5nZXQodG8ub2JzZXJ2YWJsZSlbcHJvcGVydHlOYW1lXTsgLy8gTm90ZTogdG8ub2JzZXJ2YWJsZSB3aWxsIGZpcmUgZm9yIGFueSBwcm9wZXJ0eSBjaGFuZ2UsIHJlYWN0CiAgICAgICAgLy8gdG8gY2hhbmdlcyBvZiBwcm9wZXJ0aWVzIHdoaWNoIGFyZSBib3VuZCBvbmx5LgoKICAgICAgICBpZiAoYmluZGluZ3MpIHsKICAgICAgICAgIGJpbmRpbmdzLmZvckVhY2goZnVuY3Rpb24gKGJpbmRpbmcpIHsKICAgICAgICAgICAgdXBkYXRlQm91bmRPYnNlcnZhYmxlUHJvcGVydHkob2JzZXJ2YWJsZSwgYmluZGluZy5wcm9wZXJ0eSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0pOwp9Ci8qKgogKiBJbnRlcmZhY2Ugd2hpY2ggYWRkcyAib2JzZXJ2YWJsZSBwcm9wZXJ0aWVzIiBhbmQgZGF0YSBiaW5kaW5nIGZ1bmN0aW9uYWxpdHkuCiAqCiAqIENhbiBiZSBlYXNpbHkgaW1wbGVtZW50ZWQgYnkgYSBjbGFzcyBieSBtaXhpbmcgdGhlIHtAbGluayBtb2R1bGU6dXRpbHMvb2JzZXJ2YWJsZW1peGlufk9ic2VydmFibGVNaXhpbn0gbWl4aW4uCiAqCiAqIFJlYWQgbW9yZSBhYm91dCB0aGUgdXNhZ2Ugb2YgdGhpcyBpbnRlcmZhY2UgaW4gdGhlOgogKiAqIHtAZ2xpbmsgZnJhbWV3b3JrL2d1aWRlcy9hcmNoaXRlY3R1cmUvY29yZS1lZGl0b3ItYXJjaGl0ZWN0dXJlI2V2ZW50LXN5c3RlbS1hbmQtb2JzZXJ2YWJsZXMgIkV2ZW50IHN5c3RlbSBhbmQgb2JzZXJ2YWJsZXMifQogKiBzZWN0aW9uIG9mIHRoZSB7QGdsaW5rIGZyYW1ld29yay9ndWlkZXMvYXJjaGl0ZWN0dXJlL2NvcmUtZWRpdG9yLWFyY2hpdGVjdHVyZSAiQ29yZSBlZGl0b3IgYXJjaGl0ZWN0dXJlIn0gZ3VpZGUsCiAqICoge0BnbGluayBmcmFtZXdvcmsvZ3VpZGVzL2RlZXAtZGl2ZS9vYnNlcnZhYmxlcyAiT2JzZXJ2YWJsZXMiIGRlZXAgZGl2ZX0gZ3VpZGUuCiAqCiAqIEBpbnRlcmZhY2UgT2JzZXJ2YWJsZQogKiBAZXh0ZW5kcyBtb2R1bGU6dXRpbHMvZW1pdHRlcm1peGlufkVtaXR0ZXIKICovCgovKioKICogRmlyZWQgd2hlbiBhIHByb3BlcnR5IGNoYW5nZWQgdmFsdWUuCiAqCiAqCQlvYnNlcnZhYmxlLnNldCggJ3Byb3AnLCAxICk7CiAqCiAqCQlvYnNlcnZhYmxlLm9uKCAnY2hhbmdlOnByb3AnLCAoIGV2dCwgcHJvcGVydHlOYW1lLCBuZXdWYWx1ZSwgb2xkVmFsdWUgKSA9PiB7CiAqCQkJY29uc29sZS5sb2coIGAkeyBwcm9wZXJ0eU5hbWUgfSBoYXMgY2hhbmdlZCBmcm9tICR7IG9sZFZhbHVlIH0gdG8gJHsgbmV3VmFsdWUgfWAgKTsKICoJCX0gKTsKICoKICoJCW9ic2VydmFibGUucHJvcCA9IDI7IC8vIC0+ICdwcm9wIGhhcyBjaGFuZ2VkIGZyb20gMSB0byAyJwogKgogKiBAZXZlbnQgY2hhbmdlOntwcm9wZXJ0eX0KICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgVGhlIHByb3BlcnR5IG5hbWUuCiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIG5ldyBwcm9wZXJ0eSB2YWx1ZS4KICogQHBhcmFtIHsqfSBvbGRWYWx1ZSBUaGUgcHJldmlvdXMgcHJvcGVydHkgdmFsdWUuCiAqLwoKLyoqCiAqIEZpcmVkIHdoZW4gYSBwcm9wZXJ0eSB2YWx1ZSBpcyBnb2luZyB0byBiZSBzZXQgYnV0IGlzIG5vdCBzZXQgeWV0IChiZWZvcmUgdGhlIGBjaGFuZ2VgIGV2ZW50IGlzIGZpcmVkKS4KICoKICogWW91IGNhbiBjb250cm9sIHRoZSBmaW5hbCB2YWx1ZSBvZiB0aGUgcHJvcGVydHkgYnkgdXNpbmcKICogdGhlIHtAbGluayBtb2R1bGU6dXRpbHMvZXZlbnRpbmZvfkV2ZW50SW5mbyNyZXR1cm4gZXZlbnQncyBgcmV0dXJuYCBwcm9wZXJ0eX0uCiAqCiAqCQlvYnNlcnZhYmxlLnNldCggJ3Byb3AnLCAxICk7CiAqCiAqCQlvYnNlcnZhYmxlLm9uKCAnc2V0OnByb3AnLCAoIGV2dCwgcHJvcGVydHlOYW1lLCBuZXdWYWx1ZSwgb2xkVmFsdWUgKSA9PiB7CiAqCQkJY29uc29sZS5sb2coIGBWYWx1ZSBpcyBnb2luZyB0byBiZSBjaGFuZ2VkIGZyb20gJHsgb2xkVmFsdWUgfSB0byAkeyBuZXdWYWx1ZSB9YCApOwogKgkJCWNvbnNvbGUubG9nKCBgQ3VycmVudCBwcm9wZXJ0eSB2YWx1ZSBpcyAkeyBvYnNlcnZhYmxlWyBwcm9wZXJ0eU5hbWUgXSB9YCApOwogKgogKgkJCS8vIExldCdzIG92ZXJyaWRlIHRoZSB2YWx1ZS4KICoJCQlldnQucmV0dXJuID0gMzsKICoJCX0gKTsKICoKICoJCW9ic2VydmFibGUub24oICdjaGFuZ2U6cHJvcCcsICggZXZ0LCBwcm9wZXJ0eU5hbWUsIG5ld1ZhbHVlLCBvbGRWYWx1ZSApID0+IHsKICoJCQljb25zb2xlLmxvZyggYFZhbHVlIGhhcyBjaGFuZ2VkIGZyb20gJHsgb2xkVmFsdWUgfSB0byAkeyBuZXdWYWx1ZSB9YCApOwogKgkJfSApOwogKgogKgkJb2JzZXJ2YWJsZS5wcm9wID0gMjsgLy8gLT4gJ1ZhbHVlIGlzIGdvaW5nIHRvIGJlIGNoYW5nZWQgZnJvbSAxIHRvIDInCiAqCQkgICAgICAgICAgICAgICAgICAgICAvLyAtPiAnQ3VycmVudCBwcm9wZXJ0eSB2YWx1ZSBpcyAxJwogKgkJICAgICAgICAgICAgICAgICAgICAgLy8gLT4gJ1ZhbHVlIGhhcyBjaGFuZ2VkIGZyb20gMSB0byAzJwogKgogKiAqKk5vdGU6KiogRXZlbnQgaXMgZmlyZWQgZXZlbiB3aGVuIHRoZSBuZXcgdmFsdWUgaXMgdGhlIHNhbWUgYXMgdGhlIG9sZCB2YWx1ZS4KICoKICogQGV2ZW50IHNldDp7cHJvcGVydHl9CiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIFRoZSBwcm9wZXJ0eSBuYW1lLgogKiBAcGFyYW0geyp9IHZhbHVlIFRoZSBuZXcgcHJvcGVydHkgdmFsdWUuCiAqIEBwYXJhbSB7Kn0gb2xkVmFsdWUgVGhlIHByZXZpb3VzIHByb3BlcnR5IHZhbHVlLgogKi8KCi8qKgogKiBDcmVhdGVzIGFuZCBzZXRzIHRoZSB2YWx1ZSBvZiBhbiBvYnNlcnZhYmxlIHByb3BlcnR5IG9mIHRoaXMgb2JqZWN0LiBTdWNoIGFuIHByb3BlcnR5IGJlY29tZXMgYSBwYXJ0CiAqIG9mIHRoZSBzdGF0ZSBhbmQgaXMgYmUgb2JzZXJ2YWJsZS4KICoKICogSXQgYWNjZXB0cyBhbHNvIGEgc2luZ2xlIG9iamVjdCBsaXRlcmFsIGNvbnRhaW5pbmcga2V5L3ZhbHVlIHBhaXJzIHdpdGggcHJvcGVydGllcyB0byBiZSBzZXQuCiAqCiAqIFRoaXMgbWV0aG9kIHRocm93cyB0aGUgYG9ic2VydmFibGUtc2V0LWNhbm5vdC1vdmVycmlkZWAgZXJyb3IgaWYgdGhlIG9ic2VydmFibGUgaW5zdGFuY2UgYWxyZWFkeQogKiBoYXZlIGEgcHJvcGVydHkgd2l0aCB0aGUgZ2l2ZW4gcHJvcGVydHkgbmFtZS4gVGhpcyBwcmV2ZW50cyBmcm9tIG1pc3Rha2VubHkgb3ZlcnJpZGluZyBleGlzdGluZwogKiBwcm9wZXJ0aWVzIGFuZCBtZXRob2RzLCBidXQgbWVhbnMgdGhhdCBgZm9vLnNldCggJ2JhcicsIDEgKWAgbWF5IGJlIHNsaWdodGx5IHNsb3dlciB0aGFuIGBmb28uYmFyID0gMWAuCiAqCiAqIEBtZXRob2QgI3NldAogKiBAcGFyYW0ge1N0cmluZ3xPYmplY3R9IG5hbWUgVGhlIHByb3BlcnR5J3MgbmFtZSBvciBvYmplY3Qgd2l0aCBgbmFtZT0+dmFsdWVgIHBhaXJzLgogKiBAcGFyYW0geyp9IFt2YWx1ZV0gVGhlIHByb3BlcnR5J3MgdmFsdWUgKGlmIGBuYW1lYCB3YXMgcGFzc2VkIGluIHRoZSBmaXJzdCBwYXJhbWV0ZXIpLgogKi8KCi8qKgogKiBCaW5kcyB7QGxpbmsgI3NldCBvYnNlcnZhYmxlIHByb3BlcnRpZXN9IHRvIG90aGVyIG9iamVjdHMgaW1wbGVtZW50aW5nIHRoZQogKiB7QGxpbmsgbW9kdWxlOnV0aWxzL29ic2VydmFibGVtaXhpbn5PYnNlcnZhYmxlfSBpbnRlcmZhY2UuCiAqCiAqIFJlYWQgbW9yZSBpbiB0aGUge0BnbGluayBmcmFtZXdvcmsvZ3VpZGVzL2RlZXAtZGl2ZS9vYnNlcnZhYmxlcyNwcm9wZXJ0eS1iaW5kaW5ncyBkZWRpY2F0ZWQgZ3VpZGV9CiAqIGNvdmVyaW5nIHRoZSB0b3BpYyBvZiBwcm9wZXJ0eSBiaW5kaW5ncyB3aXRoIHNvbWUgYWRkaXRpb25hbCBleGFtcGxlcy4KICoKICogQ29uc2lkZXIgdHdvIG9iamVjdHM6IGEgYGJ1dHRvbmAgYW5kIGFuIGFzc29jaWF0ZWQgYGNvbW1hbmRgIChib3RoIGBPYnNlcnZhYmxlYCkuCiAqCiAqIEEgc2ltcGxlIHByb3BlcnR5IGJpbmRpbmcgY291bGQgYmUgYXMgZm9sbG93czoKICoKICoJCWJ1dHRvbi5iaW5kKCAnaXNFbmFibGVkJyApLnRvKCBjb21tYW5kLCAnaXNFbmFibGVkJyApOwogKgogKiBvciBldmVuIHNob3J0ZXI6CiAqCiAqCQlidXR0b24uYmluZCggJ2lzRW5hYmxlZCcgKS50byggY29tbWFuZCApOwogKgogKiB3aGljaCB3b3JrcyBpbiB0aGUgZm9sbG93aW5nIHdheToKICoKICogKiBgYnV0dG9uLmlzRW5hYmxlZGAgKippbnN0YW50bHkgZXF1YWxzKiogYGNvbW1hbmQuaXNFbmFibGVkYCwKICogKiB3aGVuZXZlciBgY29tbWFuZC5pc0VuYWJsZWRgIGNoYW5nZXMsIGBidXR0b24uaXNFbmFibGVkYCB3aWxsIGltbWVkaWF0ZWx5IHJlZmxlY3QgaXRzIHZhbHVlLgogKgogKiAqKk5vdGUqKjogVG8gcmVsZWFzZSB0aGUgYmluZGluZywgdXNlIHtAbGluayBtb2R1bGU6dXRpbHMvb2JzZXJ2YWJsZW1peGlufk9ic2VydmFibGUjdW5iaW5kfS4KICoKICogWW91IGNhbiBhbHNvICJyZW5hbWUiIHRoZSBwcm9wZXJ0eSBpbiB0aGUgYmluZGluZyBieSBzcGVjaWZ5aW5nIHRoZSBuZXcgbmFtZSBpbiB0aGUgYHRvKClgIGNoYWluOgogKgogKgkJYnV0dG9uLmJpbmQoICdpc0VuYWJsZWQnICkudG8oIGNvbW1hbmQsICdpc1dvcmtpbmcnICk7CiAqCiAqIEl0IGlzIHBvc3NpYmxlIHRvIGJpbmQgbW9yZSB0aGFuIG9uZSBwcm9wZXJ0eSBhdCBhIHRpbWUgdG8gc2hvcnRlbiB0aGUgY29kZToKICoKICoJCWJ1dHRvbi5iaW5kKCAnaXNFbmFibGVkJywgJ3ZhbHVlJyApLnRvKCBjb21tYW5kICk7CiAqCiAqIHdoaWNoIGNvcnJlc3BvbmRzIHRvOgogKgogKgkJYnV0dG9uLmJpbmQoICdpc0VuYWJsZWQnICkudG8oIGNvbW1hbmQgKTsKICoJCWJ1dHRvbi5iaW5kKCAndmFsdWUnICkudG8oIGNvbW1hbmQgKTsKICoKICogVGhlIGJpbmRpbmcgY2FuIGluY2x1ZGUgbW9yZSB0aGFuIG9uZSBvYnNlcnZhYmxlLCBjb21iaW5pbmcgbXVsdGlwbGUgZGF0YSBzb3VyY2VzIGluIGEgY3VzdG9tIGNhbGxiYWNrOgogKgogKgkJYnV0dG9uLmJpbmQoICdpc0VuYWJsZWQnICkudG8oIGNvbW1hbmQsICdpc0VuYWJsZWQnLCB1aSwgJ2lzVmlzaWJsZScsCiAqCQkJKCBpc0NvbW1hbmRFbmFibGVkLCBpc1VJVmlzaWJsZSApID0+IGlzQ29tbWFuZEVuYWJsZWQgJiYgaXNVSVZpc2libGUgKTsKICoKICogSXQgaXMgYWxzbyBwb3NzaWJsZSB0byBiaW5kIHRvIHRoZSBzYW1lIHByb3BlcnR5IGluIGFuIGFycmF5IG9mIG9ic2VydmFibGVzLgogKiBUbyBiaW5kIGEgYGJ1dHRvbmAgdG8gbXVsdGlwbGUgY29tbWFuZHMgKGFsc28gYE9ic2VydmFibGVzYCkgc28gdGhhdCBlYWNoIGFuZCBldmVyeSBvbmUgb2YgdGhlbQogKiBtdXN0IGJlIGVuYWJsZWQgZm9yIHRoZSBidXR0b24gdG8gYmVjb21lIGVuYWJsZWQsIHVzZSB0aGUgZm9sbG93aW5nIGNvZGU6CiAqCiAqCQlidXR0b24uYmluZCggJ2lzRW5hYmxlZCcgKS50b01hbnkoIFsgY29tbWFuZEEsIGNvbW1hbmRCLCBjb21tYW5kQyBdLCAnaXNFbmFibGVkJywKICoJCQkoIGlzQUVuYWJsZWQsIGlzQkVuYWJsZWQsIGlzQ0VuYWJsZWQgKSA9PiBpc0FFbmFibGVkICYmIGlzQkVuYWJsZWQgJiYgaXNDRW5hYmxlZCApOwogKgogKiBAbWV0aG9kICNiaW5kCiAqIEBwYXJhbSB7Li4uU3RyaW5nfSBiaW5kUHJvcGVydGllcyBPYnNlcnZhYmxlIHByb3BlcnRpZXMgdGhhdCB3aWxsIGJlIGJvdW5kIHRvIG90aGVyIG9ic2VydmFibGUocykuCiAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBiaW5kIGNoYWluIHdpdGggdGhlIGB0bygpYCBhbmQgYHRvTWFueSgpYCBtZXRob2RzLgogKi8KCi8qKgogKiBSZW1vdmVzIHRoZSBiaW5kaW5nIGNyZWF0ZWQgd2l0aCB7QGxpbmsgI2JpbmR9LgogKgogKgkJLy8gUmVtb3ZlcyB0aGUgYmluZGluZyBmb3IgdGhlICdhJyBwcm9wZXJ0eS4KICoJCUEudW5iaW5kKCAnYScgKTsKICoKICoJCS8vIFJlbW92ZXMgYmluZGluZ3MgZm9yIGFsbCBwcm9wZXJ0aWVzLgogKgkJQS51bmJpbmQoKTsKICoKICogQG1ldGhvZCAjdW5iaW5kCiAqIEBwYXJhbSB7Li4uU3RyaW5nfSBbdW5iaW5kUHJvcGVydGllc10gT2JzZXJ2YWJsZSBwcm9wZXJ0aWVzIHRvIGJlIHVuYm91bmQuIEFsbCB0aGUgYmluZGluZ3Mgd2lsbAogKiBiZSByZWxlYXNlZCBpZiBubyBwcm9wZXJ0aWVzIGFyZSBwcm92aWRlZC4KICovCgovKioKICogVHVybnMgdGhlIGdpdmVuIG1ldGhvZHMgb2YgdGhpcyBvYmplY3QgaW50byBldmVudC1iYXNlZCBvbmVzLiBUaGlzIG1lYW5zIHRoYXQgdGhlIG5ldyBtZXRob2Qgd2lsbCBmaXJlIGFuIGV2ZW50CiAqIChuYW1lZCBhZnRlciB0aGUgbWV0aG9kKSBhbmQgdGhlIG9yaWdpbmFsIGFjdGlvbiB3aWxsIGJlIHBsdWdnZWQgYXMgYSBsaXN0ZW5lciB0byB0aGF0IGV2ZW50LgogKgogKiBSZWFkIG1vcmUgaW4gdGhlIHtAZ2xpbmsgZnJhbWV3b3JrL2d1aWRlcy9kZWVwLWRpdmUvb2JzZXJ2YWJsZXMjZGVjb3JhdGluZy1vYmplY3QtbWV0aG9kcyBkZWRpY2F0ZWQgZ3VpZGV9CiAqIGNvdmVyaW5nIHRoZSB0b3BpYyBvZiBkZWNvcmF0aW5nIG1ldGhvZHMgd2l0aCBzb21lIGFkZGl0aW9uYWwgZXhhbXBsZXMuCiAqCiAqIERlY29yYXRpbmcgdGhlIG1ldGhvZCBkb2VzIG5vdCBjaGFuZ2UgaXRzIGJlaGF2aW9yIChpdCBvbmx5IGFkZHMgYW4gZXZlbnQpLAogKiBidXQgaXQgYWxsb3dzIHRvIG1vZGlmeSBpdCBsYXRlciBvbiBieSBsaXN0ZW5pbmcgdG8gdGhlIG1ldGhvZCdzIGV2ZW50LgogKgogKiBGb3IgZXhhbXBsZSwgdG8gY2FuY2VsIHRoZSBtZXRob2QgZXhlY3V0aW9uIHRoZSBldmVudCBjYW4gYmUge0BsaW5rIG1vZHVsZTp1dGlscy9ldmVudGluZm9+RXZlbnRJbmZvI3N0b3Agc3RvcHBlZH06CiAqCiAqCQljbGFzcyBGb28gewogKgkJCWNvbnN0cnVjdG9yKCkgewogKgkJCQl0aGlzLmRlY29yYXRlKCAnbWV0aG9kJyApOwogKgkJCX0KICoKICoJCQltZXRob2QoKSB7CiAqCQkJCWNvbnNvbGUubG9nKCAnY2FsbGVkIScgKTsKICoJCQl9CiAqCQl9CiAqCiAqCQljb25zdCBmb28gPSBuZXcgRm9vKCk7CiAqCQlmb28ub24oICdtZXRob2QnLCAoIGV2dCApID0+IHsKICoJCQlldnQuc3RvcCgpOwogKgkJfSwgeyBwcmlvcml0eTogJ2hpZ2gnIH0gKTsKICoKICoJCWZvby5tZXRob2QoKTsgLy8gTm90aGluZyBpcyBsb2dnZWQuCiAqCiAqCiAqICoqTm90ZSoqOiBUaGUgaGlnaCB7QGxpbmsgbW9kdWxlOnV0aWxzL3ByaW9yaXRpZXN+UHJpb3JpdHlTdHJpbmcgcHJpb3JpdHl9IGxpc3RlbmVyCiAqIGhhcyBiZWVuIHVzZWQgdG8gZXhlY3V0ZSB0aGlzIHBhcnRpY3VsYXIgY2FsbGJhY2sgYmVmb3JlIHRoZSBvbmUgd2hpY2ggY2FsbHMgdGhlIG9yaWdpbmFsIG1ldGhvZAogKiAod2hpY2ggdXNlcyB0aGUgIm5vcm1hbCIgcHJpb3JpdHkpLgogKgogKiBJdCBpcyBhbHNvIHBvc3NpYmxlIHRvIGNoYW5nZSB0aGUgcmV0dXJuZWQgdmFsdWU6CiAqCiAqCQlmb28ub24oICdtZXRob2QnLCAoIGV2dCApID0+IHsKICoJCQlldnQucmV0dXJuID0gJ0ZvbyEnOwogKgkJfSApOwogKgogKgkJZm9vLm1ldGhvZCgpOyAvLyAtPiAnRm9vJwogKgogKiBGaW5hbGx5LCBpdCBpcyBwb3NzaWJsZSB0byBhY2Nlc3MgYW5kIG1vZGlmeSB0aGUgYXJndW1lbnRzIHRoZSBtZXRob2QgaXMgY2FsbGVkIHdpdGg6CiAqCiAqCQltZXRob2QoIGEsIGIgKSB7CiAqCQkJY29uc29sZS5sb2coIGAkeyBhIH0sICR7IGIgfWAgICk7CiAqCQl9CiAqCiAqCQkvLyAuLi4KICoKICoJCWZvby5vbiggJ21ldGhvZCcsICggZXZ0LCBhcmdzICkgPT4gewogKgkJCWFyZ3NbIDAgXSA9IDM7CiAqCiAqCQkJY29uc29sZS5sb2coIGFyZ3NbIDEgXSApOyAvLyAtPiAyCiAqCQl9LCB7IHByaW9yaXR5OiAnaGlnaCcgfSApOwogKgogKgkJZm9vLm1ldGhvZCggMSwgMiApOyAvLyAtPiAnMywgMicKICoKICogQG1ldGhvZCAjZGVjb3JhdGUKICogQHBhcmFtIHtTdHJpbmd9IG1ldGhvZE5hbWUgTmFtZSBvZiB0aGUgbWV0aG9kIHRvIGRlY29yYXRlLgogKi8="},{"version":3,"sources":["C:/Users/pc/Desktop/Restoran/Restoran/Restoran.UI/client/node_modules/@ckeditor/ckeditor5-utils/src/observablemixin.js"],"names":["EmitterMixin","CKEditorError","extend","isObject","observablePropertiesSymbol","Symbol","boundObservablesSymbol","boundPropertiesSymbol","ObservableMixin","set","name","value","Object","keys","forEach","property","initObservable","properties","has","defineProperty","enumerable","configurable","get","oldValue","newValue","fire","undefined","bind","bindProperties","length","isStringArray","Set","size","boundProperties","propertyName","bindings","Map","a","binding","to","bindTo","toMany","bindToMany","_observable","_bindProperties","_to","_bindings","unbind","boundObservables","unbindProperties","toObservable","toProperty","toProperties","toPropertyBindings","delete","stopListening","boundObservable","clear","decorate","methodName","originalMethod","object","on","evt","args","return","apply","observable","parsedArgs","parseBindToArgs","bindingsKeys","Array","from","numberOfBindings","callback","attachBindToListeners","updateBindToBound","updateBoundObservableProperty","observables","attribute","getBindingTargets","observableAndAttributePairs","map","prototype","concat","arr","every","parsed","lastObservable","pop","push","updateBoundObservables","toPropertyName","bindingsToObservable","add","chain","indexOf","propertyValue","hasOwnProperty","toBindings","listenTo"],"mappings":"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","sourcesContent":["/**\n * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module utils/observablemixin\n */\n\nimport EmitterMixin from './emittermixin';\nimport CKEditorError from './ckeditorerror';\nimport { extend, isObject } from 'lodash-es';\n\nconst observablePropertiesSymbol = Symbol( 'observableProperties' );\nconst boundObservablesSymbol = Symbol( 'boundObservables' );\nconst boundPropertiesSymbol = Symbol( 'boundProperties' );\n\n/**\n * Mixin that injects the \"observable properties\" and data binding functionality described in the\n * {@link ~Observable} interface.\n *\n * Read more about the concept of observables in the:\n * * {@glink framework/guides/architecture/core-editor-architecture#event-system-and-observables \"Event system and observables\"}\n * section of the {@glink framework/guides/architecture/core-editor-architecture \"Core editor architecture\"} guide,\n * * {@glink framework/guides/deep-dive/observables \"Observables\" deep dive} guide.\n *\n * @mixin ObservableMixin\n * @mixes module:utils/emittermixin~EmitterMixin\n * @implements module:utils/observablemixin~Observable\n */\nconst ObservableMixin = {\n\t/**\n\t * @inheritDoc\n\t */\n\tset( name, value ) {\n\t\t// If the first parameter is an Object, iterate over its properties.\n\t\tif ( isObject( name ) ) {\n\t\t\tObject.keys( name ).forEach( property => {\n\t\t\t\tthis.set( property, name[ property ] );\n\t\t\t}, this );\n\n\t\t\treturn;\n\t\t}\n\n\t\tinitObservable( this );\n\n\t\tconst properties = this[ observablePropertiesSymbol ];\n\n\t\tif ( ( name in this ) && !properties.has( name ) ) {\n\t\t\t/**\n\t\t\t * Cannot override an existing property.\n\t\t\t *\n\t\t\t * This error is thrown when trying to {@link ~Observable#set set} an property with\n\t\t\t * a name of an already existing property. For example:\n\t\t\t *\n\t\t\t *\t\tlet observable = new Model();\n\t\t\t *\t\tobservable.property = 1;\n\t\t\t *\t\tobservable.set( 'property', 2 );\t\t\t// throws\n\t\t\t *\n\t\t\t *\t\tobservable.set( 'property', 1 );\n\t\t\t *\t\tobservable.set( 'property', 2 );\t\t\t// ok, because this is an existing property.\n\t\t\t *\n\t\t\t * @error observable-set-cannot-override\n\t\t\t */\n\t\t\tthrow new CKEditorError( 'observable-set-cannot-override: Cannot override an existing property.', this );\n\t\t}\n\n\t\tObject.defineProperty( this, name, {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: true,\n\n\t\t\tget() {\n\t\t\t\treturn properties.get( name );\n\t\t\t},\n\n\t\t\tset( value ) {\n\t\t\t\tconst oldValue = properties.get( name );\n\n\t\t\t\t// Fire `set` event before the new value will be set to make it possible\n\t\t\t\t// to override observable property without affecting `change` event.\n\t\t\t\t// See https://github.com/ckeditor/ckeditor5-utils/issues/171.\n\t\t\t\tlet newValue = this.fire( 'set:' + name, name, value, oldValue );\n\n\t\t\t\tif ( newValue === undefined ) {\n\t\t\t\t\tnewValue = value;\n\t\t\t\t}\n\n\t\t\t\t// Allow undefined as an initial value like A.define( 'x', undefined ) (#132).\n\t\t\t\t// Note: When properties map has no such own property, then its value is undefined.\n\t\t\t\tif ( oldValue !== newValue || !properties.has( name ) ) {\n\t\t\t\t\tproperties.set( name, newValue );\n\t\t\t\t\tthis.fire( 'change:' + name, name, newValue, oldValue );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t\tthis[ name ] = value;\n\t},\n\n\t/**\n\t * @inheritDoc\n\t */\n\tbind( ...bindProperties ) {\n\t\tif ( !bindProperties.length || !isStringArray( bindProperties ) ) {\n\t\t\t/**\n\t\t\t * All properties must be strings.\n\t\t\t *\n\t\t\t * @error observable-bind-wrong-properties\n\t\t\t */\n\t\t\tthrow new CKEditorError( 'observable-bind-wrong-properties: All properties must be strings.', this );\n\t\t}\n\n\t\tif ( ( new Set( bindProperties ) ).size !== bindProperties.length ) {\n\t\t\t/**\n\t\t\t * Properties must be unique.\n\t\t\t *\n\t\t\t * @error observable-bind-duplicate-properties\n\t\t\t */\n\t\t\tthrow new CKEditorError( 'observable-bind-duplicate-properties: Properties must be unique.', this );\n\t\t}\n\n\t\tinitObservable( this );\n\n\t\tconst boundProperties = this[ boundPropertiesSymbol ];\n\n\t\tbindProperties.forEach( propertyName => {\n\t\t\tif ( boundProperties.has( propertyName ) ) {\n\t\t\t\t/**\n\t\t\t\t * Cannot bind the same property more than once.\n\t\t\t\t *\n\t\t\t\t * @error observable-bind-rebind\n\t\t\t\t */\n\t\t\t\tthrow new CKEditorError( 'observable-bind-rebind: Cannot bind the same property more than once.', this );\n\t\t\t}\n\t\t} );\n\n\t\tconst bindings = new Map();\n\n\t\t// @typedef {Object} Binding\n\t\t// @property {Array} property Property which is bound.\n\t\t// @property {Array} to Array of observable–property components of the binding (`{ observable: ..., property: .. }`).\n\t\t// @property {Array} callback A function which processes `to` components.\n\t\tbindProperties.forEach( a => {\n\t\t\tconst binding = { property: a, to: [] };\n\n\t\t\tboundProperties.set( a, binding );\n\t\t\tbindings.set( a, binding );\n\t\t} );\n\n\t\t// @typedef {Object} BindChain\n\t\t// @property {Function} to See {@link ~ObservableMixin#_bindTo}.\n\t\t// @property {Function} toMany See {@link ~ObservableMixin#_bindToMany}.\n\t\t// @property {module:utils/observablemixin~Observable} _observable The observable which initializes the binding.\n\t\t// @property {Array} _bindProperties Array of `_observable` properties to be bound.\n\t\t// @property {Array} _to Array of `to()` observable–properties (`{ observable: toObservable, properties: ...toProperties }`).\n\t\t// @property {Map} _bindings Stores bindings to be kept in\n\t\t// {@link ~ObservableMixin#_boundProperties}/{@link ~ObservableMixin#_boundObservables}\n\t\t// initiated in this binding chain.\n\t\treturn {\n\t\t\tto: bindTo,\n\t\t\ttoMany: bindToMany,\n\n\t\t\t_observable: this,\n\t\t\t_bindProperties: bindProperties,\n\t\t\t_to: [],\n\t\t\t_bindings: bindings\n\t\t};\n\t},\n\n\t/**\n\t * @inheritDoc\n\t */\n\tunbind( ...unbindProperties ) {\n\t\t// Nothing to do here if not inited yet.\n\t\tif ( !( observablePropertiesSymbol in this ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst boundProperties = this[ boundPropertiesSymbol ];\n\t\tconst boundObservables = this[ boundObservablesSymbol ];\n\n\t\tif ( unbindProperties.length ) {\n\t\t\tif ( !isStringArray( unbindProperties ) ) {\n\t\t\t\t/**\n\t\t\t\t * Properties must be strings.\n\t\t\t\t *\n\t\t\t\t * @error observable-unbind-wrong-properties\n\t\t\t\t */\n\t\t\t\tthrow new CKEditorError( 'observable-unbind-wrong-properties: Properties must be strings.', this );\n\t\t\t}\n\n\t\t\tunbindProperties.forEach( propertyName => {\n\t\t\t\tconst binding = boundProperties.get( propertyName );\n\n\t\t\t\t// Nothing to do if the binding is not defined\n\t\t\t\tif ( !binding ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet toObservable, toProperty, toProperties, toPropertyBindings;\n\n\t\t\t\tbinding.to.forEach( to => {\n\t\t\t\t\t// TODO: ES6 destructuring.\n\t\t\t\t\ttoObservable = to[ 0 ];\n\t\t\t\t\ttoProperty = to[ 1 ];\n\t\t\t\t\ttoProperties = boundObservables.get( toObservable );\n\t\t\t\t\ttoPropertyBindings = toProperties[ toProperty ];\n\n\t\t\t\t\ttoPropertyBindings.delete( binding );\n\n\t\t\t\t\tif ( !toPropertyBindings.size ) {\n\t\t\t\t\t\tdelete toProperties[ toProperty ];\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !Object.keys( toProperties ).length ) {\n\t\t\t\t\t\tboundObservables.delete( toObservable );\n\t\t\t\t\t\tthis.stopListening( toObservable, 'change' );\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\tboundProperties.delete( propertyName );\n\t\t\t} );\n\t\t} else {\n\t\t\tboundObservables.forEach( ( bindings, boundObservable ) => {\n\t\t\t\tthis.stopListening( boundObservable, 'change' );\n\t\t\t} );\n\n\t\t\tboundObservables.clear();\n\t\t\tboundProperties.clear();\n\t\t}\n\t},\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdecorate( methodName ) {\n\t\tconst originalMethod = this[ methodName ];\n\n\t\tif ( !originalMethod ) {\n\t\t\t/**\n\t\t\t * Cannot decorate an undefined method.\n\t\t\t *\n\t\t\t * @error observablemixin-cannot-decorate-undefined\n\t\t\t * @param {Object} object The object which method should be decorated.\n\t\t\t * @param {String} methodName Name of the method which does not exist.\n\t\t\t */\n\t\t\tthrow new CKEditorError(\n\t\t\t\t'observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.',\n\t\t\t\tthis,\n\t\t\t\t{ object: this, methodName }\n\t\t\t);\n\t\t}\n\n\t\tthis.on( methodName, ( evt, args ) => {\n\t\t\tevt.return = originalMethod.apply( this, args );\n\t\t} );\n\n\t\tthis[ methodName ] = function( ...args ) {\n\t\t\treturn this.fire( methodName, args );\n\t\t};\n\t}\n};\n\nextend( ObservableMixin, EmitterMixin );\n\nexport default ObservableMixin;\n\n// Init symbol properties needed to for the observable mechanism to work.\n//\n// @private\n// @param {module:utils/observablemixin~ObservableMixin} observable\nfunction initObservable( observable ) {\n\t// Do nothing if already inited.\n\tif ( observablePropertiesSymbol in observable ) {\n\t\treturn;\n\t}\n\n\t// The internal hash containing the observable's state.\n\t//\n\t// @private\n\t// @type {Map}\n\tObject.defineProperty( observable, observablePropertiesSymbol, {\n\t\tvalue: new Map()\n\t} );\n\n\t// Map containing bindings to external observables. It shares the binding objects\n\t// (`{ observable: A, property: 'a', to: ... }`) with {@link module:utils/observablemixin~ObservableMixin#_boundProperties} and\n\t// it is used to observe external observables to update own properties accordingly.\n\t// See {@link module:utils/observablemixin~ObservableMixin#bind}.\n\t//\n\t//\t\tA.bind( 'a', 'b', 'c' ).to( B, 'x', 'y', 'x' );\n\t//\t\tconsole.log( A._boundObservables );\n\t//\n\t//\t\t\tMap( {\n\t//\t\t\t\tB: {\n\t//\t\t\t\t\tx: Set( [\n\t//\t\t\t\t\t\t{ observable: A, property: 'a', to: [ [ B, 'x' ] ] },\n\t//\t\t\t\t\t\t{ observable: A, property: 'c', to: [ [ B, 'x' ] ] }\n\t//\t\t\t\t\t] ),\n\t//\t\t\t\t\ty: Set( [\n\t//\t\t\t\t\t\t{ observable: A, property: 'b', to: [ [ B, 'y' ] ] },\n\t//\t\t\t\t\t] )\n\t//\t\t\t\t}\n\t//\t\t\t} )\n\t//\n\t//\t\tA.bind( 'd' ).to( B, 'z' ).to( C, 'w' ).as( callback );\n\t//\t\tconsole.log( A._boundObservables );\n\t//\n\t//\t\t\tMap( {\n\t//\t\t\t\tB: {\n\t//\t\t\t\t\tx: Set( [\n\t//\t\t\t\t\t\t{ observable: A, property: 'a', to: [ [ B, 'x' ] ] },\n\t//\t\t\t\t\t\t{ observable: A, property: 'c', to: [ [ B, 'x' ] ] }\n\t//\t\t\t\t\t] ),\n\t//\t\t\t\t\ty: Set( [\n\t//\t\t\t\t\t\t{ observable: A, property: 'b', to: [ [ B, 'y' ] ] },\n\t//\t\t\t\t\t] ),\n\t//\t\t\t\t\tz: Set( [\n\t//\t\t\t\t\t\t{ observable: A, property: 'd', to: [ [ B, 'z' ], [ C, 'w' ] ], callback: callback }\n\t//\t\t\t\t\t] )\n\t//\t\t\t\t},\n\t//\t\t\t\tC: {\n\t//\t\t\t\t\tw: Set( [\n\t//\t\t\t\t\t\t{ observable: A, property: 'd', to: [ [ B, 'z' ], [ C, 'w' ] ], callback: callback }\n\t//\t\t\t\t\t] )\n\t//\t\t\t\t}\n\t//\t\t\t} )\n\t//\n\t// @private\n\t// @type {Map}\n\tObject.defineProperty( observable, boundObservablesSymbol, {\n\t\tvalue: new Map()\n\t} );\n\n\t// Object that stores which properties of this observable are bound and how. It shares\n\t// the binding objects (`{ observable: A, property: 'a', to: ... }`) with\n\t// {@link module:utils/observablemixin~ObservableMixin#_boundObservables}. This data structure is\n\t// a reverse of {@link module:utils/observablemixin~ObservableMixin#_boundObservables} and it is helpful for\n\t// {@link module:utils/observablemixin~ObservableMixin#unbind}.\n\t//\n\t// See {@link module:utils/observablemixin~ObservableMixin#bind}.\n\t//\n\t//\t\tA.bind( 'a', 'b', 'c' ).to( B, 'x', 'y', 'x' );\n\t//\t\tconsole.log( A._boundProperties );\n\t//\n\t//\t\t\tMap( {\n\t//\t\t\t\ta: { observable: A, property: 'a', to: [ [ B, 'x' ] ] },\n\t//\t\t\t\tb: { observable: A, property: 'b', to: [ [ B, 'y' ] ] },\n\t//\t\t\t\tc: { observable: A, property: 'c', to: [ [ B, 'x' ] ] }\n\t//\t\t\t} )\n\t//\n\t//\t\tA.bind( 'd' ).to( B, 'z' ).to( C, 'w' ).as( callback );\n\t//\t\tconsole.log( A._boundProperties );\n\t//\n\t//\t\t\tMap( {\n\t//\t\t\t\ta: { observable: A, property: 'a', to: [ [ B, 'x' ] ] },\n\t//\t\t\t\tb: { observable: A, property: 'b', to: [ [ B, 'y' ] ] },\n\t//\t\t\t\tc: { observable: A, property: 'c', to: [ [ B, 'x' ] ] },\n\t//\t\t\t\td: { observable: A, property: 'd', to: [ [ B, 'z' ], [ C, 'w' ] ], callback: callback }\n\t//\t\t\t} )\n\t//\n\t// @private\n\t// @type {Map}\n\tObject.defineProperty( observable, boundPropertiesSymbol, {\n\t\tvalue: new Map()\n\t} );\n}\n\n// A chaining for {@link module:utils/observablemixin~ObservableMixin#bind} providing `.to()` interface.\n//\n// @private\n// @param {...[Observable|String|Function]} args Arguments of the `.to( args )` binding.\nfunction bindTo( ...args ) {\n\tconst parsedArgs = parseBindToArgs( ...args );\n\tconst bindingsKeys = Array.from( this._bindings.keys() );\n\tconst numberOfBindings = bindingsKeys.length;\n\n\t// Eliminate A.bind( 'x' ).to( B, C )\n\tif ( !parsedArgs.callback && parsedArgs.to.length > 1 ) {\n\t\t/**\n\t\t * Binding multiple observables only possible with callback.\n\t\t *\n\t\t * @error observable-bind-no-callback\n\t\t */\n\t\tthrow new CKEditorError(\n\t\t\t'observable-bind-to-no-callback: Binding multiple observables only possible with callback.',\n\t\t\tthis\n\t\t);\n\t}\n\n\t// Eliminate A.bind( 'x', 'y' ).to( B, callback )\n\tif ( numberOfBindings > 1 && parsedArgs.callback ) {\n\t\t/**\n\t\t * Cannot bind multiple properties and use a callback in one binding.\n\t\t *\n\t\t * @error observable-bind-to-extra-callback\n\t\t */\n\t\tthrow new CKEditorError(\n\t\t\t'observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.',\n\t\t\tthis\n\t\t);\n\t}\n\n\tparsedArgs.to.forEach( to => {\n\t\t// Eliminate A.bind( 'x', 'y' ).to( B, 'a' )\n\t\tif ( to.properties.length && to.properties.length !== numberOfBindings ) {\n\t\t\t/**\n\t\t\t * The number of properties must match.\n\t\t\t *\n\t\t\t * @error observable-bind-to-properties-length\n\t\t\t */\n\t\t\tthrow new CKEditorError( 'observable-bind-to-properties-length: The number of properties must match.', this );\n\t\t}\n\n\t\t// When no to.properties specified, observing source properties instead i.e.\n\t\t// A.bind( 'x', 'y' ).to( B ) -> Observe B.x and B.y\n\t\tif ( !to.properties.length ) {\n\t\t\tto.properties = this._bindProperties;\n\t\t}\n\t} );\n\n\tthis._to = parsedArgs.to;\n\n\t// Fill {@link BindChain#_bindings} with callback. When the callback is set there's only one binding.\n\tif ( parsedArgs.callback ) {\n\t\tthis._bindings.get( bindingsKeys[ 0 ] ).callback = parsedArgs.callback;\n\t}\n\n\tattachBindToListeners( this._observable, this._to );\n\n\t// Update observable._boundProperties and observable._boundObservables.\n\tupdateBindToBound( this );\n\n\t// Set initial values of bound properties.\n\tthis._bindProperties.forEach( propertyName => {\n\t\tupdateBoundObservableProperty( this._observable, propertyName );\n\t} );\n}\n\n// Binds to an attribute in a set of iterable observables.\n//\n// @private\n// @param {Array.<Observable>} observables\n// @param {String} attribute\n// @param {Function} callback\nfunction bindToMany( observables, attribute, callback ) {\n\tif ( this._bindings.size > 1 ) {\n\t\t/**\n\t\t * Binding one attribute to many observables only possible with one attribute.\n\t\t *\n\t\t * @error observable-bind-to-many-not-one-binding\n\t\t */\n\t\tthrow new CKEditorError( 'observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().', this );\n\t}\n\n\tthis.to(\n\t\t// Bind to #attribute of each observable...\n\t\t...getBindingTargets( observables, attribute ),\n\t\t// ...using given callback to parse attribute values.\n\t\tcallback\n\t);\n}\n\n// Returns an array of binding components for\n// {@link Observable#bind} from a set of iterable observables.\n//\n// @param {Array.<Observable>} observables\n// @param {String} attribute\n// @returns {Array.<String|Observable>}\nfunction getBindingTargets( observables, attribute ) {\n\tconst observableAndAttributePairs = observables.map( observable => [ observable, attribute ] );\n\n\t// Merge pairs to one-dimension array of observables and attributes.\n\treturn Array.prototype.concat.apply( [], observableAndAttributePairs );\n}\n\n// Check if all entries of the array are of `String` type.\n//\n// @private\n// @param {Array} arr An array to be checked.\n// @returns {Boolean}\nfunction isStringArray( arr ) {\n\treturn arr.every( a => typeof a == 'string' );\n}\n\n// Parses and validates {@link Observable#bind}`.to( args )` arguments and returns\n// an object with a parsed structure. For example\n//\n//\t\tA.bind( 'x' ).to( B, 'a', C, 'b', call );\n//\n// becomes\n//\n//\t\t{\n//\t\t\tto: [\n//\t\t\t\t{ observable: B, properties: [ 'a' ] },\n//\t\t\t\t{ observable: C, properties: [ 'b' ] },\n//\t\t\t],\n//\t\t\tcallback: call\n// \t\t}\n//\n// @private\n// @param {...*} args Arguments of {@link Observable#bind}`.to( args )`.\n// @returns {Object}\nfunction parseBindToArgs( ...args ) {\n\t// Eliminate A.bind( 'x' ).to()\n\tif ( !args.length ) {\n\t\t/**\n\t\t * Invalid argument syntax in `to()`.\n\t\t *\n\t\t * @error observable-bind-to-parse-error\n\t\t */\n\t\tthrow new CKEditorError( 'observable-bind-to-parse-error: Invalid argument syntax in `to()`.', null );\n\t}\n\n\tconst parsed = { to: [] };\n\tlet lastObservable;\n\n\tif ( typeof args[ args.length - 1 ] == 'function' ) {\n\t\tparsed.callback = args.pop();\n\t}\n\n\targs.forEach( a => {\n\t\tif ( typeof a == 'string' ) {\n\t\t\tlastObservable.properties.push( a );\n\t\t} else if ( typeof a == 'object' ) {\n\t\t\tlastObservable = { observable: a, properties: [] };\n\t\t\tparsed.to.push( lastObservable );\n\t\t} else {\n\t\t\tthrow new CKEditorError( 'observable-bind-to-parse-error: Invalid argument syntax in `to()`.', null );\n\t\t}\n\t} );\n\n\treturn parsed;\n}\n\n// Synchronizes {@link module:utils/observablemixin#_boundObservables} with {@link Binding}.\n//\n// @private\n// @param {Binding} binding A binding to store in {@link Observable#_boundObservables}.\n// @param {Observable} toObservable A observable, which is a new component of `binding`.\n// @param {String} toPropertyName A name of `toObservable`'s property, a new component of the `binding`.\nfunction updateBoundObservables( observable, binding, toObservable, toPropertyName ) {\n\tconst boundObservables = observable[ boundObservablesSymbol ];\n\tconst bindingsToObservable = boundObservables.get( toObservable );\n\tconst bindings = bindingsToObservable || {};\n\n\tif ( !bindings[ toPropertyName ] ) {\n\t\tbindings[ toPropertyName ] = new Set();\n\t}\n\n\t// Pass the binding to a corresponding Set in `observable._boundObservables`.\n\tbindings[ toPropertyName ].add( binding );\n\n\tif ( !bindingsToObservable ) {\n\t\tboundObservables.set( toObservable, bindings );\n\t}\n}\n\n// Synchronizes {@link Observable#_boundProperties} and {@link Observable#_boundObservables}\n// with {@link BindChain}.\n//\n// Assuming the following binding being created\n//\n// \t\tA.bind( 'a', 'b' ).to( B, 'x', 'y' );\n//\n// the following bindings were initialized by {@link Observable#bind} in {@link BindChain#_bindings}:\n//\n// \t\t{\n// \t\t\ta: { observable: A, property: 'a', to: [] },\n// \t\t\tb: { observable: A, property: 'b', to: [] },\n// \t\t}\n//\n// Iterate over all bindings in this chain and fill their `to` properties with\n// corresponding to( ... ) arguments (components of the binding), so\n//\n// \t\t{\n// \t\t\ta: { observable: A, property: 'a', to: [ B, 'x' ] },\n// \t\t\tb: { observable: A, property: 'b', to: [ B, 'y' ] },\n// \t\t}\n//\n// Then update the structure of {@link Observable#_boundObservables} with updated\n// binding, so it becomes:\n//\n// \t\tMap( {\n// \t\t\tB: {\n// \t\t\t\tx: Set( [\n// \t\t\t\t\t{ observable: A, property: 'a', to: [ [ B, 'x' ] ] }\n// \t\t\t\t] ),\n// \t\t\t\ty: Set( [\n// \t\t\t\t\t{ observable: A, property: 'b', to: [ [ B, 'y' ] ] },\n// \t\t\t\t] )\n//\t\t\t}\n// \t\t} )\n//\n// @private\n// @param {BindChain} chain The binding initialized by {@link Observable#bind}.\nfunction updateBindToBound( chain ) {\n\tlet toProperty;\n\n\tchain._bindings.forEach( ( binding, propertyName ) => {\n\t\t// Note: For a binding without a callback, this will run only once\n\t\t// like in A.bind( 'x', 'y' ).to( B, 'a', 'b' )\n\t\t// TODO: ES6 destructuring.\n\t\tchain._to.forEach( to => {\n\t\t\ttoProperty = to.properties[ binding.callback ? 0 : chain._bindProperties.indexOf( propertyName ) ];\n\n\t\t\tbinding.to.push( [ to.observable, toProperty ] );\n\t\t\tupdateBoundObservables( chain._observable, binding, to.observable, toProperty );\n\t\t} );\n\t} );\n}\n\n// Updates an property of a {@link Observable} with a value\n// determined by an entry in {@link Observable#_boundProperties}.\n//\n// @private\n// @param {Observable} observable A observable which property is to be updated.\n// @param {String} propertyName An property to be updated.\nfunction updateBoundObservableProperty( observable, propertyName ) {\n\tconst boundProperties = observable[ boundPropertiesSymbol ];\n\tconst binding = boundProperties.get( propertyName );\n\tlet propertyValue;\n\n\t// When a binding with callback is created like\n\t//\n\t// \t\tA.bind( 'a' ).to( B, 'b', C, 'c', callback );\n\t//\n\t// collect B.b and C.c, then pass them to callback to set A.a.\n\tif ( binding.callback ) {\n\t\tpropertyValue = binding.callback.apply( observable, binding.to.map( to => to[ 0 ][ to[ 1 ] ] ) );\n\t} else {\n\t\tpropertyValue = binding.to[ 0 ];\n\t\tpropertyValue = propertyValue[ 0 ][ propertyValue[ 1 ] ];\n\t}\n\n\tif ( observable.hasOwnProperty( propertyName ) ) {\n\t\tobservable[ propertyName ] = propertyValue;\n\t} else {\n\t\tobservable.set( propertyName, propertyValue );\n\t}\n}\n\n// Starts listening to changes in {@link BindChain._to} observables to update\n// {@link BindChain._observable} {@link BindChain._bindProperties}. Also sets the\n// initial state of {@link BindChain._observable}.\n//\n// @private\n// @param {BindChain} chain The chain initialized by {@link Observable#bind}.\nfunction attachBindToListeners( observable, toBindings ) {\n\ttoBindings.forEach( to => {\n\t\tconst boundObservables = observable[ boundObservablesSymbol ];\n\t\tlet bindings;\n\n\t\t// If there's already a chain between the observables (`observable` listens to\n\t\t// `to.observable`), there's no need to create another `change` event listener.\n\t\tif ( !boundObservables.get( to.observable ) ) {\n\t\t\tobservable.listenTo( to.observable, 'change', ( evt, propertyName ) => {\n\t\t\t\tbindings = boundObservables.get( to.observable )[ propertyName ];\n\n\t\t\t\t// Note: to.observable will fire for any property change, react\n\t\t\t\t// to changes of properties which are bound only.\n\t\t\t\tif ( bindings ) {\n\t\t\t\t\tbindings.forEach( binding => {\n\t\t\t\t\t\tupdateBoundObservableProperty( observable, binding.property );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t} );\n}\n\n/**\n * Interface which adds \"observable properties\" and data binding functionality.\n *\n * Can be easily implemented by a class by mixing the {@link module:utils/observablemixin~ObservableMixin} mixin.\n *\n * Read more about the usage of this interface in the:\n * * {@glink framework/guides/architecture/core-editor-architecture#event-system-and-observables \"Event system and observables\"}\n * section of the {@glink framework/guides/architecture/core-editor-architecture \"Core editor architecture\"} guide,\n * * {@glink framework/guides/deep-dive/observables \"Observables\" deep dive} guide.\n *\n * @interface Observable\n * @extends module:utils/emittermixin~Emitter\n */\n\n/**\n * Fired when a property changed value.\n *\n *\t\tobservable.set( 'prop', 1 );\n *\n *\t\tobservable.on( 'change:prop', ( evt, propertyName, newValue, oldValue ) => {\n *\t\t\tconsole.log( `${ propertyName } has changed from ${ oldValue } to ${ newValue }` );\n *\t\t} );\n *\n *\t\tobservable.prop = 2; // -> 'prop has changed from 1 to 2'\n *\n * @event change:{property}\n * @param {String} name The property name.\n * @param {*} value The new property value.\n * @param {*} oldValue The previous property value.\n */\n\n/**\n * Fired when a property value is going to be set but is not set yet (before the `change` event is fired).\n *\n * You can control the final value of the property by using\n * the {@link module:utils/eventinfo~EventInfo#return event's `return` property}.\n *\n *\t\tobservable.set( 'prop', 1 );\n *\n *\t\tobservable.on( 'set:prop', ( evt, propertyName, newValue, oldValue ) => {\n *\t\t\tconsole.log( `Value is going to be changed from ${ oldValue } to ${ newValue }` );\n *\t\t\tconsole.log( `Current property value is ${ observable[ propertyName ] }` );\n *\n *\t\t\t// Let's override the value.\n *\t\t\tevt.return = 3;\n *\t\t} );\n *\n *\t\tobservable.on( 'change:prop', ( evt, propertyName, newValue, oldValue ) => {\n *\t\t\tconsole.log( `Value has changed from ${ oldValue } to ${ newValue }` );\n *\t\t} );\n *\n *\t\tobservable.prop = 2; // -> 'Value is going to be changed from 1 to 2'\n *\t\t                     // -> 'Current property value is 1'\n *\t\t                     // -> 'Value has changed from 1 to 3'\n *\n * **Note:** Event is fired even when the new value is the same as the old value.\n *\n * @event set:{property}\n * @param {String} name The property name.\n * @param {*} value The new property value.\n * @param {*} oldValue The previous property value.\n */\n\n/**\n * Creates and sets the value of an observable property of this object. Such an property becomes a part\n * of the state and is be observable.\n *\n * It accepts also a single object literal containing key/value pairs with properties to be set.\n *\n * This method throws the `observable-set-cannot-override` error if the observable instance already\n * have a property with the given property name. This prevents from mistakenly overriding existing\n * properties and methods, but means that `foo.set( 'bar', 1 )` may be slightly slower than `foo.bar = 1`.\n *\n * @method #set\n * @param {String|Object} name The property's name or object with `name=>value` pairs.\n * @param {*} [value] The property's value (if `name` was passed in the first parameter).\n */\n\n/**\n * Binds {@link #set observable properties} to other objects implementing the\n * {@link module:utils/observablemixin~Observable} interface.\n *\n * Read more in the {@glink framework/guides/deep-dive/observables#property-bindings dedicated guide}\n * covering the topic of property bindings with some additional examples.\n *\n * Consider two objects: a `button` and an associated `command` (both `Observable`).\n *\n * A simple property binding could be as follows:\n *\n *\t\tbutton.bind( 'isEnabled' ).to( command, 'isEnabled' );\n *\n * or even shorter:\n *\n *\t\tbutton.bind( 'isEnabled' ).to( command );\n *\n * which works in the following way:\n *\n * * `button.isEnabled` **instantly equals** `command.isEnabled`,\n * * whenever `command.isEnabled` changes, `button.isEnabled` will immediately reflect its value.\n *\n * **Note**: To release the binding, use {@link module:utils/observablemixin~Observable#unbind}.\n *\n * You can also \"rename\" the property in the binding by specifying the new name in the `to()` chain:\n *\n *\t\tbutton.bind( 'isEnabled' ).to( command, 'isWorking' );\n *\n * It is possible to bind more than one property at a time to shorten the code:\n *\n *\t\tbutton.bind( 'isEnabled', 'value' ).to( command );\n *\n * which corresponds to:\n *\n *\t\tbutton.bind( 'isEnabled' ).to( command );\n *\t\tbutton.bind( 'value' ).to( command );\n *\n * The binding can include more than one observable, combining multiple data sources in a custom callback:\n *\n *\t\tbutton.bind( 'isEnabled' ).to( command, 'isEnabled', ui, 'isVisible',\n *\t\t\t( isCommandEnabled, isUIVisible ) => isCommandEnabled && isUIVisible );\n *\n * It is also possible to bind to the same property in an array of observables.\n * To bind a `button` to multiple commands (also `Observables`) so that each and every one of them\n * must be enabled for the button to become enabled, use the following code:\n *\n *\t\tbutton.bind( 'isEnabled' ).toMany( [ commandA, commandB, commandC ], 'isEnabled',\n *\t\t\t( isAEnabled, isBEnabled, isCEnabled ) => isAEnabled && isBEnabled && isCEnabled );\n *\n * @method #bind\n * @param {...String} bindProperties Observable properties that will be bound to other observable(s).\n * @returns {Object} The bind chain with the `to()` and `toMany()` methods.\n */\n\n/**\n * Removes the binding created with {@link #bind}.\n *\n *\t\t// Removes the binding for the 'a' property.\n *\t\tA.unbind( 'a' );\n *\n *\t\t// Removes bindings for all properties.\n *\t\tA.unbind();\n *\n * @method #unbind\n * @param {...String} [unbindProperties] Observable properties to be unbound. All the bindings will\n * be released if no properties are provided.\n */\n\n/**\n * Turns the given methods of this object into event-based ones. This means that the new method will fire an event\n * (named after the method) and the original action will be plugged as a listener to that event.\n *\n * Read more in the {@glink framework/guides/deep-dive/observables#decorating-object-methods dedicated guide}\n * covering the topic of decorating methods with some additional examples.\n *\n * Decorating the method does not change its behavior (it only adds an event),\n * but it allows to modify it later on by listening to the method's event.\n *\n * For example, to cancel the method execution the event can be {@link module:utils/eventinfo~EventInfo#stop stopped}:\n *\n *\t\tclass Foo {\n *\t\t\tconstructor() {\n *\t\t\t\tthis.decorate( 'method' );\n *\t\t\t}\n *\n *\t\t\tmethod() {\n *\t\t\t\tconsole.log( 'called!' );\n *\t\t\t}\n *\t\t}\n *\n *\t\tconst foo = new Foo();\n *\t\tfoo.on( 'method', ( evt ) => {\n *\t\t\tevt.stop();\n *\t\t}, { priority: 'high' } );\n *\n *\t\tfoo.method(); // Nothing is logged.\n *\n *\n * **Note**: The high {@link module:utils/priorities~PriorityString priority} listener\n * has been used to execute this particular callback before the one which calls the original method\n * (which uses the \"normal\" priority).\n *\n * It is also possible to change the returned value:\n *\n *\t\tfoo.on( 'method', ( evt ) => {\n *\t\t\tevt.return = 'Foo!';\n *\t\t} );\n *\n *\t\tfoo.method(); // -> 'Foo'\n *\n * Finally, it is possible to access and modify the arguments the method is called with:\n *\n *\t\tmethod( a, b ) {\n *\t\t\tconsole.log( `${ a }, ${ b }`  );\n *\t\t}\n *\n *\t\t// ...\n *\n *\t\tfoo.on( 'method', ( evt, args ) => {\n *\t\t\targs[ 0 ] = 3;\n *\n *\t\t\tconsole.log( args[ 1 ] ); // -> 2\n *\t\t}, { priority: 'high' } );\n *\n *\t\tfoo.method( 1, 2 ); // -> '3, 2'\n *\n * @method #decorate\n * @param {String} methodName Name of the method to decorate.\n */\n"]}]}