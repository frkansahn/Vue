{"remainingRequest":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-link\\src\\linkui.js","dependencies":[{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-link\\src\\linkui.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\@ckeditor\\ckeditor5-dev-webpack-plugin\\lib\\translatesourceloader.js","mtime":499162500000},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1581760768702},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1581760786382},{"path":"C:\\Users\\pc\\Desktop\\Restoran\\Restoran\\Restoran.UI\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1581760768279}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQzpcXFVzZXJzXFxwY1xcRGVza3RvcFxcUmVzdG9yYW5cXFJlc3RvcmFuXFxSZXN0b3Jhbi5VSVxcY2xpZW50XFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQzpcXFVzZXJzXFxwY1xcRGVza3RvcFxcUmVzdG9yYW5cXFJlc3RvcmFuXFxSZXN0b3Jhbi5VSVxcY2xpZW50XFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiBmcm9tICJDOlxcVXNlcnNcXHBjXFxEZXNrdG9wXFxSZXN0b3JhblxcUmVzdG9yYW5cXFJlc3RvcmFuLlVJXFxjbGllbnRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIkM6XFxVc2Vyc1xccGNcXERlc2t0b3BcXFJlc3RvcmFuXFxSZXN0b3JhblxcUmVzdG9yYW4uVUlcXGNsaWVudFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YiOwppbXBvcnQgX2dldCBmcm9tICJDOlxcVXNlcnNcXHBjXFxEZXNrdG9wXFxSZXN0b3JhblxcUmVzdG9yYW5cXFJlc3RvcmFuLlVJXFxjbGllbnRcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2dldCI7CmltcG9ydCBfaW5oZXJpdHMgZnJvbSAiQzpcXFVzZXJzXFxwY1xcRGVza3RvcFxcUmVzdG9yYW5cXFJlc3RvcmFuXFxSZXN0b3Jhbi5VSVxcY2xpZW50XFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cyI7CgovKioKICogQGxpY2Vuc2UgQ29weXJpZ2h0IChjKSAyMDAzLTIwMjAsIENLU291cmNlIC0gRnJlZGVyaWNvIEtuYWJiZW4uIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiAqIEZvciBsaWNlbnNpbmcsIHNlZSBMSUNFTlNFLm1kIG9yIGh0dHBzOi8vY2tlZGl0b3IuY29tL2xlZ2FsL2NrZWRpdG9yLW9zcy1saWNlbnNlCiAqLwoKLyoqCiAqIEBtb2R1bGUgbGluay9saW5rdWkKICovCmltcG9ydCBQbHVnaW4gZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS1jb3JlL3NyYy9wbHVnaW4nOwppbXBvcnQgQ2xpY2tPYnNlcnZlciBmcm9tICdAY2tlZGl0b3IvY2tlZGl0b3I1LWVuZ2luZS9zcmMvdmlldy9vYnNlcnZlci9jbGlja29ic2VydmVyJzsKaW1wb3J0IHsgaXNMaW5rRWxlbWVudCB9IGZyb20gJy4vdXRpbHMnOwppbXBvcnQgQ29udGV4dHVhbEJhbGxvb24gZnJvbSAnQGNrZWRpdG9yL2NrZWRpdG9yNS11aS9zcmMvcGFuZWwvYmFsbG9vbi9jb250ZXh0dWFsYmFsbG9vbic7CmltcG9ydCBjbGlja091dHNpZGVIYW5kbGVyIGZyb20gJ0Bja2VkaXRvci9ja2VkaXRvcjUtdWkvc3JjL2JpbmRpbmdzL2NsaWNrb3V0c2lkZWhhbmRsZXInOwppbXBvcnQgQnV0dG9uVmlldyBmcm9tICdAY2tlZGl0b3IvY2tlZGl0b3I1LXVpL3NyYy9idXR0b24vYnV0dG9udmlldyc7CmltcG9ydCBMaW5rRm9ybVZpZXcgZnJvbSAnLi91aS9saW5rZm9ybXZpZXcnOwppbXBvcnQgTGlua0FjdGlvbnNWaWV3IGZyb20gJy4vdWkvbGlua2FjdGlvbnN2aWV3JzsKaW1wb3J0IGxpbmtJY29uIGZyb20gJy4uL3RoZW1lL2ljb25zL2xpbmsuc3ZnJzsKdmFyIGxpbmtLZXlzdHJva2UgPSAnQ3RybCtLJzsKLyoqCiAqIFRoZSBsaW5rIFVJIHBsdWdpbi4gSXQgaW50cm9kdWNlcyB0aGUgYCdsaW5rJ2AgYW5kIGAndW5saW5rJ2AgYnV0dG9ucyBhbmQgc3VwcG9ydCBmb3IgdGhlIDxrYmQ+Q3RybCtLPC9rYmQ+IGtleXN0cm9rZS4KICoKICogSXQgdXNlcyB0aGUKICoge0BsaW5rIG1vZHVsZTp1aS9wYW5lbC9iYWxsb29uL2NvbnRleHR1YWxiYWxsb29ufkNvbnRleHR1YWxCYWxsb29uIGNvbnRleHR1YWwgYmFsbG9vbiBwbHVnaW59LgogKgogKiBAZXh0ZW5kcyBtb2R1bGU6Y29yZS9wbHVnaW5+UGx1Z2luCiAqLwoKdmFyIExpbmtVSSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9QbHVnaW4pIHsKICBfaW5oZXJpdHMoTGlua1VJLCBfUGx1Z2luKTsKCiAgZnVuY3Rpb24gTGlua1VJKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExpbmtVSSk7CgogICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihMaW5rVUkpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKExpbmtVSSwgW3sKICAgIGtleTogImluaXQiLAoKICAgIC8qKgogICAgICogQGluaGVyaXREb2MKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7CiAgICAgIHZhciBlZGl0b3IgPSB0aGlzLmVkaXRvcjsKICAgICAgZWRpdG9yLmVkaXRpbmcudmlldy5hZGRPYnNlcnZlcihDbGlja09ic2VydmVyKTsKICAgICAgLyoqCiAgICAgICAqIFRoZSBhY3Rpb25zIHZpZXcgZGlzcGxheWVkIGluc2lkZSBvZiB0aGUgYmFsbG9vbi4KICAgICAgICoKICAgICAgICogQG1lbWJlciB7bW9kdWxlOmxpbmsvdWkvbGlua2FjdGlvbnN2aWV3fkxpbmtBY3Rpb25zVmlld30KICAgICAgICovCgogICAgICB0aGlzLmFjdGlvbnNWaWV3ID0gdGhpcy5fY3JlYXRlQWN0aW9uc1ZpZXcoKTsKICAgICAgLyoqCiAgICAgICAqIFRoZSBmb3JtIHZpZXcgZGlzcGxheWVkIGluc2lkZSB0aGUgYmFsbG9vbi4KICAgICAgICoKICAgICAgICogQG1lbWJlciB7bW9kdWxlOmxpbmsvdWkvbGlua2Zvcm12aWV3fkxpbmtGb3JtVmlld30KICAgICAgICovCgogICAgICB0aGlzLmZvcm1WaWV3ID0gdGhpcy5fY3JlYXRlRm9ybVZpZXcoKTsKICAgICAgLyoqCiAgICAgICAqIFRoZSBjb250ZXh0dWFsIGJhbGxvb24gcGx1Z2luIGluc3RhbmNlLgogICAgICAgKgogICAgICAgKiBAcHJpdmF0ZQogICAgICAgKiBAbWVtYmVyIHttb2R1bGU6dWkvcGFuZWwvYmFsbG9vbi9jb250ZXh0dWFsYmFsbG9vbn5Db250ZXh0dWFsQmFsbG9vbn0KICAgICAgICovCgogICAgICB0aGlzLl9iYWxsb29uID0gZWRpdG9yLnBsdWdpbnMuZ2V0KENvbnRleHR1YWxCYWxsb29uKTsgLy8gQ3JlYXRlIHRvb2xiYXIgYnV0dG9ucy4KCiAgICAgIHRoaXMuX2NyZWF0ZVRvb2xiYXJMaW5rQnV0dG9uKCk7IC8vIEF0dGFjaCBsaWZlY3ljbGUgYWN0aW9ucyB0byB0aGUgdGhlIGJhbGxvb24uCgoKICAgICAgdGhpcy5fZW5hYmxlVXNlckJhbGxvb25JbnRlcmFjdGlvbnMoKTsKICAgIH0KICAgIC8qKgogICAgICogQGluaGVyaXREb2MKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJkZXN0cm95IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkgewogICAgICBfZ2V0KF9nZXRQcm90b3R5cGVPZihMaW5rVUkucHJvdG90eXBlKSwgImRlc3Ryb3kiLCB0aGlzKS5jYWxsKHRoaXMpOyAvLyBEZXN0cm95IGNyZWF0ZWQgVUkgY29tcG9uZW50cyBhcyB0aGV5IGFyZSBub3QgYXV0b21hdGljYWxseSBkZXN0cm95ZWQgKHNlZSBja2VkaXRvcjUjMTM0MSkuCgoKICAgICAgdGhpcy5mb3JtVmlldy5kZXN0cm95KCk7CiAgICB9CiAgICAvKioKICAgICAqIENyZWF0ZXMgdGhlIHtAbGluayBtb2R1bGU6bGluay91aS9saW5rYWN0aW9uc3ZpZXd+TGlua0FjdGlvbnNWaWV3fSBpbnN0YW5jZS4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICogQHJldHVybnMge21vZHVsZTpsaW5rL3VpL2xpbmthY3Rpb25zdmlld35MaW5rQWN0aW9uc1ZpZXd9IFRoZSBsaW5rIGFjdGlvbnMgdmlldyBpbnN0YW5jZS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfY3JlYXRlQWN0aW9uc1ZpZXciLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVBY3Rpb25zVmlldygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBlZGl0b3IgPSB0aGlzLmVkaXRvcjsKICAgICAgdmFyIGFjdGlvbnNWaWV3ID0gbmV3IExpbmtBY3Rpb25zVmlldyhlZGl0b3IubG9jYWxlKTsKICAgICAgdmFyIGxpbmtDb21tYW5kID0gZWRpdG9yLmNvbW1hbmRzLmdldCgnbGluaycpOwogICAgICB2YXIgdW5saW5rQ29tbWFuZCA9IGVkaXRvci5jb21tYW5kcy5nZXQoJ3VubGluaycpOwogICAgICBhY3Rpb25zVmlldy5iaW5kKCdocmVmJykudG8obGlua0NvbW1hbmQsICd2YWx1ZScpOwogICAgICBhY3Rpb25zVmlldy5lZGl0QnV0dG9uVmlldy5iaW5kKCdpc0VuYWJsZWQnKS50byhsaW5rQ29tbWFuZCk7CiAgICAgIGFjdGlvbnNWaWV3LnVubGlua0J1dHRvblZpZXcuYmluZCgnaXNFbmFibGVkJykudG8odW5saW5rQ29tbWFuZCk7IC8vIEV4ZWN1dGUgdW5saW5rIGNvbW1hbmQgYWZ0ZXIgY2xpY2tpbmcgb24gdGhlICJFZGl0IiBidXR0b24uCgogICAgICB0aGlzLmxpc3RlblRvKGFjdGlvbnNWaWV3LCAnZWRpdCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy5fYWRkRm9ybVZpZXcoKTsKICAgICAgfSk7IC8vIEV4ZWN1dGUgdW5saW5rIGNvbW1hbmQgYWZ0ZXIgY2xpY2tpbmcgb24gdGhlICJVbmxpbmsiIGJ1dHRvbi4KCiAgICAgIHRoaXMubGlzdGVuVG8oYWN0aW9uc1ZpZXcsICd1bmxpbmsnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgZWRpdG9yLmV4ZWN1dGUoJ3VubGluaycpOwoKICAgICAgICBfdGhpcy5faGlkZVVJKCk7CiAgICAgIH0pOyAvLyBDbG9zZSB0aGUgcGFuZWwgb24gZXNjIGtleSBwcmVzcyB3aGVuIHRoZSAqKmFjdGlvbnMgaGF2ZSBmb2N1cyoqLgoKICAgICAgYWN0aW9uc1ZpZXcua2V5c3Ryb2tlcy5zZXQoJ0VzYycsIGZ1bmN0aW9uIChkYXRhLCBjYW5jZWwpIHsKICAgICAgICBfdGhpcy5faGlkZVVJKCk7CgogICAgICAgIGNhbmNlbCgpOwogICAgICB9KTsgLy8gT3BlbiB0aGUgZm9ybSB2aWV3IG9uIEN0cmwrSyB3aGVuIHRoZSAqKmFjdGlvbnMgaGF2ZSBmb2N1cyoqLi4KCiAgICAgIGFjdGlvbnNWaWV3LmtleXN0cm9rZXMuc2V0KGxpbmtLZXlzdHJva2UsIGZ1bmN0aW9uIChkYXRhLCBjYW5jZWwpIHsKICAgICAgICBfdGhpcy5fYWRkRm9ybVZpZXcoKTsKCiAgICAgICAgY2FuY2VsKCk7CiAgICAgIH0pOwogICAgICByZXR1cm4gYWN0aW9uc1ZpZXc7CiAgICB9CiAgICAvKioKICAgICAqIENyZWF0ZXMgdGhlIHtAbGluayBtb2R1bGU6bGluay91aS9saW5rZm9ybXZpZXd+TGlua0Zvcm1WaWV3fSBpbnN0YW5jZS4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICogQHJldHVybnMge21vZHVsZTpsaW5rL3VpL2xpbmtmb3Jtdmlld35MaW5rRm9ybVZpZXd9IFRoZSBsaW5rIGZvcm0gdmlldyBpbnN0YW5jZS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfY3JlYXRlRm9ybVZpZXciLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVGb3JtVmlldygpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgZWRpdG9yID0gdGhpcy5lZGl0b3I7CiAgICAgIHZhciBsaW5rQ29tbWFuZCA9IGVkaXRvci5jb21tYW5kcy5nZXQoJ2xpbmsnKTsKICAgICAgdmFyIGZvcm1WaWV3ID0gbmV3IExpbmtGb3JtVmlldyhlZGl0b3IubG9jYWxlLCBsaW5rQ29tbWFuZC5tYW51YWxEZWNvcmF0b3JzKTsKICAgICAgZm9ybVZpZXcudXJsSW5wdXRWaWV3LmJpbmQoJ3ZhbHVlJykudG8obGlua0NvbW1hbmQsICd2YWx1ZScpOyAvLyBGb3JtIGVsZW1lbnRzIHNob3VsZCBiZSByZWFkLW9ubHkgd2hlbiBjb3JyZXNwb25kaW5nIGNvbW1hbmRzIGFyZSBkaXNhYmxlZC4KCiAgICAgIGZvcm1WaWV3LnVybElucHV0Vmlldy5iaW5kKCdpc1JlYWRPbmx5JykudG8obGlua0NvbW1hbmQsICdpc0VuYWJsZWQnLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICByZXR1cm4gIXZhbHVlOwogICAgICB9KTsKICAgICAgZm9ybVZpZXcuc2F2ZUJ1dHRvblZpZXcuYmluZCgnaXNFbmFibGVkJykudG8obGlua0NvbW1hbmQpOyAvLyBFeGVjdXRlIGxpbmsgY29tbWFuZCBhZnRlciBjbGlja2luZyB0aGUgIlNhdmUiIGJ1dHRvbi4KCiAgICAgIHRoaXMubGlzdGVuVG8oZm9ybVZpZXcsICdzdWJtaXQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgZWRpdG9yLmV4ZWN1dGUoJ2xpbmsnLCBmb3JtVmlldy51cmxJbnB1dFZpZXcuaW5wdXRWaWV3LmVsZW1lbnQudmFsdWUsIGZvcm1WaWV3LmdldERlY29yYXRvclN3aXRjaGVzU3RhdGUoKSk7CgogICAgICAgIF90aGlzMi5fY2xvc2VGb3JtVmlldygpOwogICAgICB9KTsgLy8gSGlkZSB0aGUgcGFuZWwgYWZ0ZXIgY2xpY2tpbmcgdGhlICJDYW5jZWwiIGJ1dHRvbi4KCiAgICAgIHRoaXMubGlzdGVuVG8oZm9ybVZpZXcsICdjYW5jZWwnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMyLl9jbG9zZUZvcm1WaWV3KCk7CiAgICAgIH0pOyAvLyBDbG9zZSB0aGUgcGFuZWwgb24gZXNjIGtleSBwcmVzcyB3aGVuIHRoZSAqKmZvcm0gaGFzIGZvY3VzKiouCgogICAgICBmb3JtVmlldy5rZXlzdHJva2VzLnNldCgnRXNjJywgZnVuY3Rpb24gKGRhdGEsIGNhbmNlbCkgewogICAgICAgIF90aGlzMi5fY2xvc2VGb3JtVmlldygpOwoKICAgICAgICBjYW5jZWwoKTsKICAgICAgfSk7CiAgICAgIHJldHVybiBmb3JtVmlldzsKICAgIH0KICAgIC8qKgogICAgICogQ3JlYXRlcyBhIHRvb2xiYXIgTGluayBidXR0b24uIENsaWNraW5nIHRoaXMgYnV0dG9uIHdpbGwgc2hvdwogICAgICogYSB7QGxpbmsgI19iYWxsb29ufSBhdHRhY2hlZCB0byB0aGUgc2VsZWN0aW9uLgogICAgICoKICAgICAqIEBwcml2YXRlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX2NyZWF0ZVRvb2xiYXJMaW5rQnV0dG9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfY3JlYXRlVG9vbGJhckxpbmtCdXR0b24oKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIGVkaXRvciA9IHRoaXMuZWRpdG9yOwogICAgICB2YXIgbGlua0NvbW1hbmQgPSBlZGl0b3IuY29tbWFuZHMuZ2V0KCdsaW5rJyk7CiAgICAgIHZhciB0ID0gZWRpdG9yLnQ7IC8vIEhhbmRsZSB0aGUgYEN0cmwrS2Aga2V5c3Ryb2tlIGFuZCBzaG93IHRoZSBwYW5lbC4KCiAgICAgIGVkaXRvci5rZXlzdHJva2VzLnNldChsaW5rS2V5c3Ryb2tlLCBmdW5jdGlvbiAoa2V5RXZ0RGF0YSwgY2FuY2VsKSB7CiAgICAgICAgLy8gUHJldmVudCBmb2N1c2luZyB0aGUgc2VhcmNoIGJhciBpbiBGRiBhbmQgb3BlbmluZyBuZXcgdGFiIGluIEVkZ2UuICMxNTMsICMxNTQuCiAgICAgICAgY2FuY2VsKCk7CgogICAgICAgIF90aGlzMy5fc2hvd1VJKHRydWUpOwogICAgICB9KTsKICAgICAgZWRpdG9yLnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKCdsaW5rJywgZnVuY3Rpb24gKGxvY2FsZSkgewogICAgICAgIHZhciBidXR0b24gPSBuZXcgQnV0dG9uVmlldyhsb2NhbGUpOwogICAgICAgIGJ1dHRvbi5pc0VuYWJsZWQgPSB0cnVlOwogICAgICAgIGJ1dHRvbi5sYWJlbCA9IHQoJ0xpbmsnKTsKICAgICAgICBidXR0b24uaWNvbiA9IGxpbmtJY29uOwogICAgICAgIGJ1dHRvbi5rZXlzdHJva2UgPSBsaW5rS2V5c3Ryb2tlOwogICAgICAgIGJ1dHRvbi50b29sdGlwID0gdHJ1ZTsKICAgICAgICBidXR0b24uaXNUb2dnbGVhYmxlID0gdHJ1ZTsgLy8gQmluZCBidXR0b24gdG8gdGhlIGNvbW1hbmQuCgogICAgICAgIGJ1dHRvbi5iaW5kKCdpc0VuYWJsZWQnKS50byhsaW5rQ29tbWFuZCwgJ2lzRW5hYmxlZCcpOwogICAgICAgIGJ1dHRvbi5iaW5kKCdpc09uJykudG8obGlua0NvbW1hbmQsICd2YWx1ZScsIGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgICAgcmV0dXJuICEhdmFsdWU7CiAgICAgICAgfSk7IC8vIFNob3cgdGhlIHBhbmVsIG9uIGJ1dHRvbiBjbGljay4KCiAgICAgICAgX3RoaXMzLmxpc3RlblRvKGJ1dHRvbiwgJ2V4ZWN1dGUnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMzLl9zaG93VUkodHJ1ZSk7CiAgICAgICAgfSk7CgogICAgICAgIHJldHVybiBidXR0b247CiAgICAgIH0pOwogICAgfQogICAgLyoqCiAgICAgKiBBdHRhY2hlcyBhY3Rpb25zIHRoYXQgY29udHJvbCB3aGV0aGVyIHRoZSBiYWxsb29uIHBhbmVsIGNvbnRhaW5pbmcgdGhlCiAgICAgKiB7QGxpbmsgI2Zvcm1WaWV3fSBpcyB2aXNpYmxlIG9yIG5vdC4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9lbmFibGVVc2VyQmFsbG9vbkludGVyYWN0aW9ucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2VuYWJsZVVzZXJCYWxsb29uSW50ZXJhY3Rpb25zKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHZhciB2aWV3RG9jdW1lbnQgPSB0aGlzLmVkaXRvci5lZGl0aW5nLnZpZXcuZG9jdW1lbnQ7IC8vIEhhbmRsZSBjbGljayBvbiB2aWV3IGRvY3VtZW50IGFuZCBzaG93IHBhbmVsIHdoZW4gc2VsZWN0aW9uIGlzIHBsYWNlZCBpbnNpZGUgdGhlIGxpbmsgZWxlbWVudC4KICAgICAgLy8gS2VlcCBwYW5lbCBvcGVuIHVudGlsIHNlbGVjdGlvbiB3aWxsIGJlIGluc2lkZSB0aGUgc2FtZSBsaW5rIGVsZW1lbnQuCgogICAgICB0aGlzLmxpc3RlblRvKHZpZXdEb2N1bWVudCwgJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBwYXJlbnRMaW5rID0gX3RoaXM0Ll9nZXRTZWxlY3RlZExpbmtFbGVtZW50KCk7CgogICAgICAgIGlmIChwYXJlbnRMaW5rKSB7CiAgICAgICAgICAvLyBUaGVuIHNob3cgcGFuZWwgYnV0IGtlZXAgZm9jdXMgaW5zaWRlIGVkaXRvciBlZGl0YWJsZS4KICAgICAgICAgIF90aGlzNC5fc2hvd1VJKCk7CiAgICAgICAgfQogICAgICB9KTsgLy8gRm9jdXMgdGhlIGZvcm0gaWYgdGhlIGJhbGxvb24gaXMgdmlzaWJsZSBhbmQgdGhlIFRhYiBrZXkgaGFzIGJlZW4gcHJlc3NlZC4KCiAgICAgIHRoaXMuZWRpdG9yLmtleXN0cm9rZXMuc2V0KCdUYWInLCBmdW5jdGlvbiAoZGF0YSwgY2FuY2VsKSB7CiAgICAgICAgaWYgKF90aGlzNC5fYXJlQWN0aW9uc1Zpc2libGUgJiYgIV90aGlzNC5hY3Rpb25zVmlldy5mb2N1c1RyYWNrZXIuaXNGb2N1c2VkKSB7CiAgICAgICAgICBfdGhpczQuYWN0aW9uc1ZpZXcuZm9jdXMoKTsKCiAgICAgICAgICBjYW5jZWwoKTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICAvLyBVc2UgdGhlIGhpZ2ggcHJpb3JpdHkgYmVjYXVzZSB0aGUgbGluayBVSSBuYXZpZ2F0aW9uIGlzIG1vcmUgaW1wb3J0YW50CiAgICAgICAgLy8gdGhhbiBvdGhlciBmZWF0dXJlJ3MgYWN0aW9ucywgZS5nLiBsaXN0IGluZGVudGF0aW9uLgogICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ja2VkaXRvci9ja2VkaXRvcjUtbGluay9pc3N1ZXMvMTQ2CiAgICAgICAgcHJpb3JpdHk6ICdoaWdoJwogICAgICB9KTsgLy8gQ2xvc2UgdGhlIHBhbmVsIG9uIHRoZSBFc2Mga2V5IHByZXNzIHdoZW4gdGhlIGVkaXRhYmxlIGhhcyBmb2N1cyBhbmQgdGhlIGJhbGxvb24gaXMgdmlzaWJsZS4KCiAgICAgIHRoaXMuZWRpdG9yLmtleXN0cm9rZXMuc2V0KCdFc2MnLCBmdW5jdGlvbiAoZGF0YSwgY2FuY2VsKSB7CiAgICAgICAgaWYgKF90aGlzNC5faXNVSVZpc2libGUpIHsKICAgICAgICAgIF90aGlzNC5faGlkZVVJKCk7CgogICAgICAgICAgY2FuY2VsKCk7CiAgICAgICAgfQogICAgICB9KTsgLy8gQ2xvc2Ugb24gY2xpY2sgb3V0c2lkZSBvZiBiYWxsb29uIHBhbmVsIGVsZW1lbnQuCgogICAgICBjbGlja091dHNpZGVIYW5kbGVyKHsKICAgICAgICBlbWl0dGVyOiB0aGlzLmZvcm1WaWV3LAogICAgICAgIGFjdGl2YXRvcjogZnVuY3Rpb24gYWN0aXZhdG9yKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzNC5faXNVSUluUGFuZWw7CiAgICAgICAgfSwKICAgICAgICBjb250ZXh0RWxlbWVudHM6IFt0aGlzLl9iYWxsb29uLnZpZXcuZWxlbWVudF0sCiAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uIGNhbGxiYWNrKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzNC5faGlkZVVJKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogQWRkcyB0aGUge0BsaW5rICNhY3Rpb25zVmlld30gdG8gdGhlIHtAbGluayAjX2JhbGxvb259LgogICAgICoKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfYWRkQWN0aW9uc1ZpZXciLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9hZGRBY3Rpb25zVmlldygpIHsKICAgICAgaWYgKHRoaXMuX2FyZUFjdGlvbnNJblBhbmVsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLl9iYWxsb29uLmFkZCh7CiAgICAgICAgdmlldzogdGhpcy5hY3Rpb25zVmlldywKICAgICAgICBwb3NpdGlvbjogdGhpcy5fZ2V0QmFsbG9vblBvc2l0aW9uRGF0YSgpCiAgICAgIH0pOwogICAgfQogICAgLyoqCiAgICAgKiBBZGRzIHRoZSB7QGxpbmsgI2Zvcm1WaWV3fSB0byB0aGUge0BsaW5rICNfYmFsbG9vbn0uCiAgICAgKgogICAgICogQHByb3RlY3RlZAogICAgICovCgogIH0sIHsKICAgIGtleTogIl9hZGRGb3JtVmlldyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2FkZEZvcm1WaWV3KCkgewogICAgICBpZiAodGhpcy5faXNGb3JtSW5QYW5lbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGVkaXRvciA9IHRoaXMuZWRpdG9yOwogICAgICB2YXIgbGlua0NvbW1hbmQgPSBlZGl0b3IuY29tbWFuZHMuZ2V0KCdsaW5rJyk7CgogICAgICB0aGlzLl9iYWxsb29uLmFkZCh7CiAgICAgICAgdmlldzogdGhpcy5mb3JtVmlldywKICAgICAgICBwb3NpdGlvbjogdGhpcy5fZ2V0QmFsbG9vblBvc2l0aW9uRGF0YSgpCiAgICAgIH0pOyAvLyBTZWxlY3QgaW5wdXQgd2hlbiBmb3JtIHZpZXcgaXMgY3VycmVudGx5IHZpc2libGUuCgoKICAgICAgaWYgKHRoaXMuX2JhbGxvb24udmlzaWJsZVZpZXcgPT09IHRoaXMuZm9ybVZpZXcpIHsKICAgICAgICB0aGlzLmZvcm1WaWV3LnVybElucHV0Vmlldy5zZWxlY3QoKTsKICAgICAgfSAvLyBNYWtlIHN1cmUgdGhhdCBlYWNoIHRpbWUgdGhlIHBhbmVsIHNob3dzIHVwLCB0aGUgVVJMIGZpZWxkIHJlbWFpbnMgaW4gc3luYyB3aXRoIHRoZSB2YWx1ZSBvZgogICAgICAvLyB0aGUgY29tbWFuZC4gSWYgdGhlIHVzZXIgdHlwZWQgaW4gdGhlIGlucHV0LCB0aGVuIGNhbmNlbGVkIHRoZSBiYWxsb29uIChgdXJsSW5wdXRWaWV3I3ZhbHVlYCBzdGF5cwogICAgICAvLyB1bmFsdGVyZWQpIGFuZCByZS1vcGVuZWQgaXQgd2l0aG91dCBjaGFuZ2luZyB0aGUgdmFsdWUgb2YgdGhlIGxpbmsgY29tbWFuZCAoZS5nLiBiZWNhdXNlIHRoZXkKICAgICAgLy8gY2xpY2tlZCB0aGUgc2FtZSBsaW5rKSwgdGhleSB3b3VsZCBzZWUgdGhlIG9sZCB2YWx1ZSBpbnN0ZWFkIG9mIHRoZSBhY3R1YWwgdmFsdWUgb2YgdGhlIGNvbW1hbmQuCiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9ja2VkaXRvci9ja2VkaXRvcjUtbGluay9pc3N1ZXMvNzgKICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2NrZWRpdG9yL2NrZWRpdG9yNS1saW5rL2lzc3Vlcy8xMjMKCgogICAgICB0aGlzLmZvcm1WaWV3LnVybElucHV0Vmlldy5pbnB1dFZpZXcuZWxlbWVudC52YWx1ZSA9IGxpbmtDb21tYW5kLnZhbHVlIHx8ICcnOwogICAgfQogICAgLyoqCiAgICAgKiBDbG9zZXMgdGhlIGZvcm0gdmlldy4gRGVjaWRlcyB3aGV0aGVyIHRoZSBiYWxsb29uIHNob3VsZCBiZSBoaWRkZW4gY29tcGxldGVseSBvciBpZiB0aGUgYWN0aW9uIHZpZXcgc2hvdWxkIGJlIHNob3duLiBUaGlzIGlzCiAgICAgKiBkZWNpZGVkIHVwb24gdGhlIGxpbmsgY29tbWFuZCB2YWx1ZSAod2hpY2ggaGFzIGEgdmFsdWUgaWYgdGhlIGRvY3VtZW50IHNlbGVjdGlvbiBpcyBpbiB0aGUgbGluaykuCiAgICAgKgogICAgICogQWRkaXRpb25hbGx5LCBpZiBhbnkge0BsaW5rIG1vZHVsZTpsaW5rL2xpbmt+TGlua0NvbmZpZyNkZWNvcmF0b3JzfSBhcmUgZGVmaW5lZCBpbiB0aGUgZWRpdG9yIGNvbmZpZ3VyYXRpb24sIHRoZSBzdGF0ZSBvZgogICAgICogc3dpdGNoIGJ1dHRvbnMgcmVzcG9uc2libGUgZm9yIG1hbnVhbCBkZWNvcmF0b3IgaGFuZGxpbmcgaXMgcmVzdG9yZWQuCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfY2xvc2VGb3JtVmlldyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2Nsb3NlRm9ybVZpZXcoKSB7CiAgICAgIHZhciBsaW5rQ29tbWFuZCA9IHRoaXMuZWRpdG9yLmNvbW1hbmRzLmdldCgnbGluaycpOyAvLyBSZXN0b3JlIG1hbnVhbCBkZWNvcmF0b3Igc3RhdGVzIHRvIHJlcHJlc2VudCB0aGUgY3VycmVudCBtb2RlbCBzdGF0ZS4gVGhpcyBjYXNlIGlzIGltcG9ydGFudCB0byByZXNldCB0aGUgc3dpdGNoIGJ1dHRvbnMKICAgICAgLy8gd2hlbiB0aGUgdXNlciBjYW5jZWxzIHRoZSBlZGl0aW5nIGZvcm0uCgogICAgICBsaW5rQ29tbWFuZC5yZXN0b3JlTWFudWFsRGVjb3JhdG9yU3RhdGVzKCk7CgogICAgICBpZiAobGlua0NvbW1hbmQudmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuX3JlbW92ZUZvcm1WaWV3KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5faGlkZVVJKCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlcyB0aGUge0BsaW5rICNmb3JtVmlld30gZnJvbSB0aGUge0BsaW5rICNfYmFsbG9vbn0uCiAgICAgKgogICAgICogQHByb3RlY3RlZAogICAgICovCgogIH0sIHsKICAgIGtleTogIl9yZW1vdmVGb3JtVmlldyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbW92ZUZvcm1WaWV3KCkgewogICAgICBpZiAodGhpcy5faXNGb3JtSW5QYW5lbCkgewogICAgICAgIC8vIEJsdXIgdGhlIGlucHV0IGVsZW1lbnQgYmVmb3JlIHJlbW92aW5nIGl0IGZyb20gRE9NIHRvIHByZXZlbnQgaXNzdWVzIGluIHNvbWUgYnJvd3NlcnMuCiAgICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9ja2VkaXRvci9ja2VkaXRvcjUvaXNzdWVzLzE1MDEuCiAgICAgICAgdGhpcy5mb3JtVmlldy5zYXZlQnV0dG9uVmlldy5mb2N1cygpOwoKICAgICAgICB0aGlzLl9iYWxsb29uLnJlbW92ZSh0aGlzLmZvcm1WaWV3KTsgLy8gQmVjYXVzZSB0aGUgZm9ybSBoYXMgYW4gaW5wdXQgd2hpY2ggaGFzIGZvY3VzLCB0aGUgZm9jdXMgbXVzdCBiZSBicm91Z2h0IGJhY2sKICAgICAgICAvLyB0byB0aGUgZWRpdG9yLiBPdGhlcndpc2UsIGl0IHdvdWxkIGJlIGxvc3QuCgoKICAgICAgICB0aGlzLmVkaXRvci5lZGl0aW5nLnZpZXcuZm9jdXMoKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTaG93cyB0aGUgY29ycmVjdCBVSSB0eXBlLiBJdCBpcyBlaXRoZXIge0BsaW5rICNmb3JtVmlld30gb3Ige0BsaW5rICNhY3Rpb25zVmlld30uCiAgICAgKgogICAgICogQHBhcmFtIHtCb29sZWFufSBmb3JjZVZpc2libGUKICAgICAqIEBwcml2YXRlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3Nob3dVSSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3Nob3dVSSgpIHsKICAgICAgdmFyIGZvcmNlVmlzaWJsZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7CgogICAgICAvLyBXaGVuIHRoZXJlJ3Mgbm8gbGluayB1bmRlciB0aGUgc2VsZWN0aW9uLCBnbyBzdHJhaWdodCB0byB0aGUgZWRpdGluZyBVSS4KICAgICAgaWYgKCF0aGlzLl9nZXRTZWxlY3RlZExpbmtFbGVtZW50KCkpIHsKICAgICAgICB0aGlzLl9hZGRBY3Rpb25zVmlldygpOyAvLyBCZSBzdXJlIHBhbmVsIHdpdGggbGluayBpcyB2aXNpYmxlLgoKCiAgICAgICAgaWYgKGZvcmNlVmlzaWJsZSkgewogICAgICAgICAgdGhpcy5fYmFsbG9vbi5zaG93U3RhY2soJ21haW4nKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuX2FkZEZvcm1WaWV3KCk7CiAgICAgIH0gLy8gSWYgdGhlcmUncyBhIGxpbmsgdW5kZXIgdGhlIHNlbGVjdGlvbi4uLgogICAgICBlbHNlIHsKICAgICAgICAgIC8vIEdvIHRvIHRoZSBlZGl0aW5nIFVJIGlmIGFjdGlvbnMgYXJlIGFscmVhZHkgdmlzaWJsZS4KICAgICAgICAgIGlmICh0aGlzLl9hcmVBY3Rpb25zVmlzaWJsZSkgewogICAgICAgICAgICB0aGlzLl9hZGRGb3JtVmlldygpOwogICAgICAgICAgfSAvLyBPdGhlcndpc2UgZGlzcGxheSBqdXN0IHRoZSBhY3Rpb25zIFVJLgogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy5fYWRkQWN0aW9uc1ZpZXcoKTsKICAgICAgICAgICAgfSAvLyBCZSBzdXJlIHBhbmVsIHdpdGggbGluayBpcyB2aXNpYmxlLgoKCiAgICAgICAgICBpZiAoZm9yY2VWaXNpYmxlKSB7CiAgICAgICAgICAgIHRoaXMuX2JhbGxvb24uc2hvd1N0YWNrKCdtYWluJyk7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBCZWdpbiByZXNwb25kaW5nIHRvIHVpI3VwZGF0ZSBvbmNlIHRoZSBVSSBpcyBhZGRlZC4KCgogICAgICB0aGlzLl9zdGFydFVwZGF0aW5nVUkoKTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlcyB0aGUge0BsaW5rICNmb3JtVmlld30gZnJvbSB0aGUge0BsaW5rICNfYmFsbG9vbn0uCiAgICAgKgogICAgICogU2VlIHtAbGluayAjX2FkZEZvcm1WaWV3fSwge0BsaW5rICNfYWRkQWN0aW9uc1ZpZXd9LgogICAgICoKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfaGlkZVVJIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfaGlkZVVJKCkgewogICAgICBpZiAoIXRoaXMuX2lzVUlJblBhbmVsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgZWRpdG9yID0gdGhpcy5lZGl0b3I7CiAgICAgIHRoaXMuc3RvcExpc3RlbmluZyhlZGl0b3IudWksICd1cGRhdGUnKTsKICAgICAgdGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMuX2JhbGxvb24sICdjaGFuZ2U6dmlzaWJsZVZpZXcnKTsgLy8gTWFrZSBzdXJlIHRoZSBmb2N1cyBhbHdheXMgZ2V0cyBiYWNrIHRvIHRoZSBlZGl0YWJsZSBfYmVmb3JlXyByZW1vdmluZyB0aGUgZm9jdXNlZCBmb3JtIHZpZXcuCiAgICAgIC8vIERvaW5nIG90aGVyd2lzZSBjYXVzZXMgaXNzdWVzIGluIHNvbWUgYnJvd3NlcnMuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vY2tlZGl0b3IvY2tlZGl0b3I1LWxpbmsvaXNzdWVzLzE5My4KCiAgICAgIGVkaXRvci5lZGl0aW5nLnZpZXcuZm9jdXMoKTsgLy8gUmVtb3ZlIGZvcm0gZmlyc3QgYmVjYXVzZSBpdCdzIG9uIHRvcCBvZiB0aGUgc3RhY2suCgogICAgICB0aGlzLl9yZW1vdmVGb3JtVmlldygpOyAvLyBUaGVuIHJlbW92ZSB0aGUgYWN0aW9ucyB2aWV3IGJlY2F1c2UgaXQncyBiZW5lYXRoIHRoZSBmb3JtLgoKCiAgICAgIHRoaXMuX2JhbGxvb24ucmVtb3ZlKHRoaXMuYWN0aW9uc1ZpZXcpOwogICAgfQogICAgLyoqCiAgICAgKiBNYWtlcyB0aGUgVUkgcmVhY3QgdG8gdGhlIHtAbGluayBtb2R1bGU6Y29yZS9lZGl0b3IvZWRpdG9ydWl+RWRpdG9yVUkjZXZlbnQ6dXBkYXRlfSBldmVudCB0bwogICAgICogcmVwb3NpdGlvbiBpdHNlbGYgd2hlbiB0aGUgZWRpdG9yIFVJIHNob3VsZCBiZSByZWZyZXNoZWQuCiAgICAgKgogICAgICogU2VlOiB7QGxpbmsgI19oaWRlVUl9IHRvIGxlYXJuIHdoZW4gdGhlIFVJIHN0b3BzIHJlYWN0aW5nIHRvIHRoZSBgdXBkYXRlYCBldmVudC4KICAgICAqCiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX3N0YXJ0VXBkYXRpbmdVSSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3N0YXJ0VXBkYXRpbmdVSSgpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CgogICAgICB2YXIgZWRpdG9yID0gdGhpcy5lZGl0b3I7CiAgICAgIHZhciB2aWV3RG9jdW1lbnQgPSBlZGl0b3IuZWRpdGluZy52aWV3LmRvY3VtZW50OwoKICAgICAgdmFyIHByZXZTZWxlY3RlZExpbmsgPSB0aGlzLl9nZXRTZWxlY3RlZExpbmtFbGVtZW50KCk7CgogICAgICB2YXIgcHJldlNlbGVjdGlvblBhcmVudCA9IGdldFNlbGVjdGlvblBhcmVudCgpOwoKICAgICAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uIHVwZGF0ZSgpIHsKICAgICAgICB2YXIgc2VsZWN0ZWRMaW5rID0gX3RoaXM1Ll9nZXRTZWxlY3RlZExpbmtFbGVtZW50KCk7CgogICAgICAgIHZhciBzZWxlY3Rpb25QYXJlbnQgPSBnZXRTZWxlY3Rpb25QYXJlbnQoKTsgLy8gSGlkZSB0aGUgcGFuZWwgaWY6CiAgICAgICAgLy8KICAgICAgICAvLyAqIHRoZSBzZWxlY3Rpb24gd2VudCBvdXQgb2YgdGhlIEVYSVNUSU5HIGxpbmsgZWxlbWVudC4gRS5nLiB1c2VyIG1vdmVkIHRoZSBjYXJldCBvdXQKICAgICAgICAvLyAgIG9mIHRoZSBsaW5rLAogICAgICAgIC8vICogdGhlIHNlbGVjdGlvbiB3ZW50IHRvIGEgZGlmZmVyZW50IHBhcmVudCB3aGVuIGNyZWF0aW5nIGEgTkVXIGxpbmsuIEUuZy4gc29tZW9uZQogICAgICAgIC8vICAgZWxzZSBtb2RpZmllZCB0aGUgZG9jdW1lbnQuCiAgICAgICAgLy8gKiB0aGUgc2VsZWN0aW9uIGhhcyBleHBhbmRlZCAoZS5nLiBkaXNwbGF5aW5nIGxpbmsgYWN0aW9ucyB0aGVuIHByZXNzaW5nIFNISUZUK1JpZ2h0IGFycm93KS4KICAgICAgICAvLwogICAgICAgIC8vIE5vdGU6ICNfZ2V0U2VsZWN0ZWRMaW5rRWxlbWVudCB3aWxsIHJldHVybiBhIGxpbmsgZm9yIGEgbm9uLWNvbGxhcHNlZCBzZWxlY3Rpb24gb25seQogICAgICAgIC8vIHdoZW4gZnVsbHkgc2VsZWN0ZWQuCgogICAgICAgIGlmIChwcmV2U2VsZWN0ZWRMaW5rICYmICFzZWxlY3RlZExpbmsgfHwgIXByZXZTZWxlY3RlZExpbmsgJiYgc2VsZWN0aW9uUGFyZW50ICE9PSBwcmV2U2VsZWN0aW9uUGFyZW50KSB7CiAgICAgICAgICBfdGhpczUuX2hpZGVVSSgpOwogICAgICAgIH0gLy8gVXBkYXRlIHRoZSBwb3NpdGlvbiBvZiB0aGUgcGFuZWwgd2hlbjoKICAgICAgICAvLyAgKiBsaW5rIHBhbmVsIGlzIGluIHRoZSB2aXNpYmxlIHN0YWNrCiAgICAgICAgLy8gICogdGhlIHNlbGVjdGlvbiByZW1haW5zIGluIHRoZSBvcmlnaW5hbCBsaW5rIGVsZW1lbnQsCiAgICAgICAgLy8gICogdGhlcmUgd2FzIG5vIGxpbmsgZWxlbWVudCBpbiB0aGUgZmlyc3QgcGxhY2UsIGkuZS4gY3JlYXRpbmcgYSBuZXcgbGluawogICAgICAgIGVsc2UgaWYgKF90aGlzNS5faXNVSVZpc2libGUpIHsKICAgICAgICAgICAgLy8gSWYgc3RpbGwgaW4gYSBsaW5rIGVsZW1lbnQsIHNpbXBseSB1cGRhdGUgdGhlIHBvc2l0aW9uIG9mIHRoZSBiYWxsb29uLgogICAgICAgICAgICAvLyBJZiB0aGVyZSB3YXMgbm8gbGluayAoZS5nLiBpbnNlcnRpbmcgb25lKSwgdGhlIGJhbGxvb24gbXVzdCBiZSBtb3ZlZAogICAgICAgICAgICAvLyB0byB0aGUgbmV3IHBvc2l0aW9uIGluIHRoZSBlZGl0aW5nIHZpZXcgKGEgbmV3IG5hdGl2ZSBET00gcmFuZ2UpLgogICAgICAgICAgICBfdGhpczUuX2JhbGxvb24udXBkYXRlUG9zaXRpb24oX3RoaXM1Ll9nZXRCYWxsb29uUG9zaXRpb25EYXRhKCkpOwogICAgICAgICAgfQoKICAgICAgICBwcmV2U2VsZWN0ZWRMaW5rID0gc2VsZWN0ZWRMaW5rOwogICAgICAgIHByZXZTZWxlY3Rpb25QYXJlbnQgPSBzZWxlY3Rpb25QYXJlbnQ7CiAgICAgIH07CgogICAgICBmdW5jdGlvbiBnZXRTZWxlY3Rpb25QYXJlbnQoKSB7CiAgICAgICAgcmV0dXJuIHZpZXdEb2N1bWVudC5zZWxlY3Rpb24uZm9jdXMuZ2V0QW5jZXN0b3JzKCkucmV2ZXJzZSgpLmZpbmQoZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgIHJldHVybiBub2RlLmlzKCdlbGVtZW50Jyk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMubGlzdGVuVG8oZWRpdG9yLnVpLCAndXBkYXRlJywgdXBkYXRlKTsKICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLl9iYWxsb29uLCAnY2hhbmdlOnZpc2libGVWaWV3JywgdXBkYXRlKTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBgdHJ1ZWAgd2hlbiB7QGxpbmsgI2Zvcm1WaWV3fSBpcyBpbiB0aGUge0BsaW5rICNfYmFsbG9vbn0uCiAgICAgKgogICAgICogQHJlYWRvbmx5CiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKiBAdHlwZSB7Qm9vbGVhbn0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJfZ2V0QmFsbG9vblBvc2l0aW9uRGF0YSIsCgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHBvc2l0aW9uaW5nIG9wdGlvbnMgZm9yIHRoZSB7QGxpbmsgI19iYWxsb29ufS4gVGhleSBjb250cm9sIHRoZSB3YXkgdGhlIGJhbGxvb24gaXMgYXR0YWNoZWQKICAgICAqIHRvIHRoZSB0YXJnZXQgZWxlbWVudCBvciBzZWxlY3Rpb24uCiAgICAgKgogICAgICogSWYgdGhlIHNlbGVjdGlvbiBpcyBjb2xsYXBzZWQgYW5kIGluc2lkZSBhIGxpbmsgZWxlbWVudCwgdGhlIHBhbmVsIHdpbGwgYmUgYXR0YWNoZWQgdG8gdGhlCiAgICAgKiBlbnRpcmUgbGluayBlbGVtZW50LiBPdGhlcndpc2UsIGl0IHdpbGwgYmUgYXR0YWNoZWQgdG8gdGhlIHNlbGVjdGlvbi4KICAgICAqCiAgICAgKiBAcHJpdmF0ZQogICAgICogQHJldHVybnMge21vZHVsZTp1dGlscy9kb20vcG9zaXRpb25+T3B0aW9uc30KICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRCYWxsb29uUG9zaXRpb25EYXRhKCkgewogICAgICB2YXIgdmlldyA9IHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldzsKICAgICAgdmFyIHZpZXdEb2N1bWVudCA9IHZpZXcuZG9jdW1lbnQ7CgogICAgICB2YXIgdGFyZ2V0TGluayA9IHRoaXMuX2dldFNlbGVjdGVkTGlua0VsZW1lbnQoKTsKCiAgICAgIHZhciB0YXJnZXQgPSB0YXJnZXRMaW5rID8gLy8gV2hlbiBzZWxlY3Rpb24gaXMgaW5zaWRlIGxpbmsgZWxlbWVudCwgdGhlbiBhdHRhY2ggcGFuZWwgdG8gdGhpcyBlbGVtZW50LgogICAgICB2aWV3LmRvbUNvbnZlcnRlci5tYXBWaWV3VG9Eb20odGFyZ2V0TGluaykgOiAvLyBPdGhlcndpc2UgYXR0YWNoIHBhbmVsIHRvIHRoZSBzZWxlY3Rpb24uCiAgICAgIHZpZXcuZG9tQ29udmVydGVyLnZpZXdSYW5nZVRvRG9tKHZpZXdEb2N1bWVudC5zZWxlY3Rpb24uZ2V0Rmlyc3RSYW5nZSgpKTsKICAgICAgcmV0dXJuIHsKICAgICAgICB0YXJnZXQ6IHRhcmdldAogICAgICB9OwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBsaW5rIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvYXR0cmlidXRlZWxlbWVudH5BdHRyaWJ1dGVFbGVtZW50fSB1bmRlcgogICAgICogdGhlIHtAbGluayBtb2R1bGU6ZW5naW5lL3ZpZXcvZG9jdW1lbnR+RG9jdW1lbnQgZWRpdGluZyB2aWV3J3N9IHNlbGVjdGlvbiBvciBgbnVsbGAKICAgICAqIGlmIHRoZXJlIGlzIG5vbmUuCiAgICAgKgogICAgICogKipOb3RlKio6IEZvciBhIG5vbuKAk2NvbGxhcHNlZCBzZWxlY3Rpb24sIHRoZSBsaW5rIGVsZW1lbnQgaXMgb25seSByZXR1cm5lZCB3aGVuICoqZnVsbHkqKgogICAgICogc2VsZWN0ZWQgYW5kIHRoZSAqKm9ubHkqKiBlbGVtZW50IHdpdGhpbiB0aGUgc2VsZWN0aW9uIGJvdW5kYXJpZXMuCiAgICAgKgogICAgICogQHByaXZhdGUKICAgICAqIEByZXR1cm5zIHttb2R1bGU6ZW5naW5lL3ZpZXcvYXR0cmlidXRlZWxlbWVudH5BdHRyaWJ1dGVFbGVtZW50fG51bGx9CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX2dldFNlbGVjdGVkTGlua0VsZW1lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRTZWxlY3RlZExpbmtFbGVtZW50KCkgewogICAgICB2YXIgdmlldyA9IHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldzsKICAgICAgdmFyIHNlbGVjdGlvbiA9IHZpZXcuZG9jdW1lbnQuc2VsZWN0aW9uOwoKICAgICAgaWYgKHNlbGVjdGlvbi5pc0NvbGxhcHNlZCkgewogICAgICAgIHJldHVybiBmaW5kTGlua0VsZW1lbnRBbmNlc3RvcihzZWxlY3Rpb24uZ2V0Rmlyc3RQb3NpdGlvbigpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUaGUgcmFuZ2UgZm9yIGZ1bGx5IHNlbGVjdGVkIGxpbmsgaXMgdXN1YWxseSBhbmNob3JlZCBpbiBhZGphY2VudCB0ZXh0IG5vZGVzLgogICAgICAgIC8vIFRyaW0gaXQgdG8gZ2V0IGNsb3NlciB0byB0aGUgYWN0dWFsIGxpbmsgZWxlbWVudC4KICAgICAgICB2YXIgcmFuZ2UgPSBzZWxlY3Rpb24uZ2V0Rmlyc3RSYW5nZSgpLmdldFRyaW1tZWQoKTsKICAgICAgICB2YXIgc3RhcnRMaW5rID0gZmluZExpbmtFbGVtZW50QW5jZXN0b3IocmFuZ2Uuc3RhcnQpOwogICAgICAgIHZhciBlbmRMaW5rID0gZmluZExpbmtFbGVtZW50QW5jZXN0b3IocmFuZ2UuZW5kKTsKCiAgICAgICAgaWYgKCFzdGFydExpbmsgfHwgc3RhcnRMaW5rICE9IGVuZExpbmspIHsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0gLy8gQ2hlY2sgaWYgdGhlIGxpbmsgZWxlbWVudCBpcyBmdWxseSBzZWxlY3RlZC4KCgogICAgICAgIGlmICh2aWV3LmNyZWF0ZVJhbmdlSW4oc3RhcnRMaW5rKS5nZXRUcmltbWVkKCkuaXNFcXVhbChyYW5nZSkpIHsKICAgICAgICAgIHJldHVybiBzdGFydExpbms7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIl9pc0Zvcm1JblBhbmVsIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fYmFsbG9vbi5oYXNWaWV3KHRoaXMuZm9ybVZpZXcpOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGB0cnVlYCB3aGVuIHtAbGluayAjYWN0aW9uc1ZpZXd9IGlzIGluIHRoZSB7QGxpbmsgI19iYWxsb29ufS4KICAgICAqCiAgICAgKiBAcmVhZG9ubHkKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEB0eXBlIHtCb29sZWFufQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9hcmVBY3Rpb25zSW5QYW5lbCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2JhbGxvb24uaGFzVmlldyh0aGlzLmFjdGlvbnNWaWV3KTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBgdHJ1ZWAgd2hlbiB7QGxpbmsgI2FjdGlvbnNWaWV3fSBpcyBpbiB0aGUge0BsaW5rICNfYmFsbG9vbn0gYW5kIGl0IGlzCiAgICAgKiBjdXJyZW50bHkgdmlzaWJsZS4KICAgICAqCiAgICAgKiBAcmVhZG9ubHkKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEB0eXBlIHtCb29sZWFufQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9hcmVBY3Rpb25zVmlzaWJsZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2JhbGxvb24udmlzaWJsZVZpZXcgPT09IHRoaXMuYWN0aW9uc1ZpZXc7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYHRydWVgIHdoZW4ge0BsaW5rICNhY3Rpb25zVmlld30gb3Ige0BsaW5rICNmb3JtVmlld30gaXMgaW4gdGhlIHtAbGluayAjX2JhbGxvb259LgogICAgICoKICAgICAqIEByZWFkb25seQogICAgICogQHByb3RlY3RlZAogICAgICogQHR5cGUge0Jvb2xlYW59CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiX2lzVUlJblBhbmVsIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5faXNGb3JtSW5QYW5lbCB8fCB0aGlzLl9hcmVBY3Rpb25zSW5QYW5lbDsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyBgdHJ1ZWAgd2hlbiB7QGxpbmsgI2FjdGlvbnNWaWV3fSBvciB7QGxpbmsgI2Zvcm1WaWV3fSBpcyBpbiB0aGUge0BsaW5rICNfYmFsbG9vbn0gYW5kIGl0IGlzCiAgICAgKiBjdXJyZW50bHkgdmlzaWJsZS4KICAgICAqCiAgICAgKiBAcmVhZG9ubHkKICAgICAqIEBwcm90ZWN0ZWQKICAgICAqIEB0eXBlIHtCb29sZWFufQogICAgICovCgogIH0sIHsKICAgIGtleTogIl9pc1VJVmlzaWJsZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIHZpc2libGVWaWV3ID0gdGhpcy5fYmFsbG9vbi52aXNpYmxlVmlldzsKICAgICAgcmV0dXJuIHZpc2libGVWaWV3ID09IHRoaXMuZm9ybVZpZXcgfHwgdGhpcy5fYXJlQWN0aW9uc1Zpc2libGU7CiAgICB9CiAgfV0sIFt7CiAgICBrZXk6ICJyZXF1aXJlcyIsCgogICAgLyoqCiAgICAgKiBAaW5oZXJpdERvYwogICAgICovCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIFtDb250ZXh0dWFsQmFsbG9vbl07CiAgICB9CiAgICAvKioKICAgICAqIEBpbmhlcml0RG9jCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicGx1Z2luTmFtZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuICdMaW5rVUknOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIExpbmtVSTsKfShQbHVnaW4pOyAvLyBSZXR1cm5zIGEgbGluayBlbGVtZW50IGlmIHRoZXJlJ3Mgb25lIGFtb25nIHRoZSBhbmNlc3RvcnMgb2YgdGhlIHByb3ZpZGVkIGBQb3NpdGlvbmAuCi8vCi8vIEBwcml2YXRlCi8vIEBwYXJhbSB7bW9kdWxlOmVuZ2luZS92aWV3L3Bvc2l0aW9uflBvc2l0aW9ufSBWaWV3IHBvc2l0aW9uIHRvIGFuYWx5emUuCi8vIEByZXR1cm5zIHttb2R1bGU6ZW5naW5lL3ZpZXcvYXR0cmlidXRlZWxlbWVudH5BdHRyaWJ1dGVFbGVtZW50fG51bGx9IExpbmsgZWxlbWVudCBhdCB0aGUgcG9zaXRpb24gb3IgbnVsbC4KCgpleHBvcnQgeyBMaW5rVUkgYXMgZGVmYXVsdCB9OwoKZnVuY3Rpb24gZmluZExpbmtFbGVtZW50QW5jZXN0b3IocG9zaXRpb24pIHsKICByZXR1cm4gcG9zaXRpb24uZ2V0QW5jZXN0b3JzKCkuZmluZChmdW5jdGlvbiAoYW5jZXN0b3IpIHsKICAgIHJldHVybiBpc0xpbmtFbGVtZW50KGFuY2VzdG9yKTsKICB9KTsKfQ=="},{"version":3,"sources":["C:/Users/pc/Desktop/Restoran/Restoran/Restoran.UI/client/node_modules/@ckeditor/ckeditor5-link/src/linkui.js"],"names":["Plugin","ClickObserver","isLinkElement","ContextualBalloon","clickOutsideHandler","ButtonView","LinkFormView","LinkActionsView","linkIcon","linkKeystroke","LinkUI","editor","editing","view","addObserver","actionsView","_createActionsView","formView","_createFormView","_balloon","plugins","get","_createToolbarLinkButton","_enableUserBalloonInteractions","destroy","locale","linkCommand","commands","unlinkCommand","bind","to","editButtonView","unlinkButtonView","listenTo","_addFormView","execute","_hideUI","keystrokes","set","data","cancel","manualDecorators","urlInputView","value","saveButtonView","inputView","element","getDecoratorSwitchesState","_closeFormView","t","keyEvtData","_showUI","ui","componentFactory","add","button","isEnabled","label","icon","keystroke","tooltip","isToggleable","viewDocument","document","parentLink","_getSelectedLinkElement","_areActionsVisible","focusTracker","isFocused","focus","priority","_isUIVisible","emitter","activator","_isUIInPanel","contextElements","callback","_areActionsInPanel","position","_getBalloonPositionData","_isFormInPanel","visibleView","select","restoreManualDecoratorStates","undefined","_removeFormView","remove","forceVisible","_addActionsView","showStack","_startUpdatingUI","stopListening","prevSelectedLink","prevSelectionParent","getSelectionParent","update","selectedLink","selectionParent","updatePosition","selection","getAncestors","reverse","find","node","is","targetLink","target","domConverter","mapViewToDom","viewRangeToDom","getFirstRange","isCollapsed","findLinkElementAncestor","getFirstPosition","range","getTrimmed","startLink","start","endLink","end","createRangeIn","isEqual","hasView","ancestor"],"mappings":"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","sourcesContent":["/**\n * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module link/linkui\n */\n\nimport Plugin from '@ckeditor/ckeditor5-core/src/plugin';\nimport ClickObserver from '@ckeditor/ckeditor5-engine/src/view/observer/clickobserver';\nimport { isLinkElement } from './utils';\nimport ContextualBalloon from '@ckeditor/ckeditor5-ui/src/panel/balloon/contextualballoon';\n\nimport clickOutsideHandler from '@ckeditor/ckeditor5-ui/src/bindings/clickoutsidehandler';\n\nimport ButtonView from '@ckeditor/ckeditor5-ui/src/button/buttonview';\nimport LinkFormView from './ui/linkformview';\nimport LinkActionsView from './ui/linkactionsview';\n\nimport linkIcon from '../theme/icons/link.svg';\n\nconst linkKeystroke = 'Ctrl+K';\n\n/**\n * The link UI plugin. It introduces the `'link'` and `'unlink'` buttons and support for the <kbd>Ctrl+K</kbd> keystroke.\n *\n * It uses the\n * {@link module:ui/panel/balloon/contextualballoon~ContextualBalloon contextual balloon plugin}.\n *\n * @extends module:core/plugin~Plugin\n */\nexport default class LinkUI extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic get requires() {\n\t\treturn [ ContextualBalloon ];\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic get pluginName() {\n\t\treturn 'LinkUI';\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tinit() {\n\t\tconst editor = this.editor;\n\n\t\teditor.editing.view.addObserver( ClickObserver );\n\n\t\t/**\n\t\t * The actions view displayed inside of the balloon.\n\t\t *\n\t\t * @member {module:link/ui/linkactionsview~LinkActionsView}\n\t\t */\n\t\tthis.actionsView = this._createActionsView();\n\n\t\t/**\n\t\t * The form view displayed inside the balloon.\n\t\t *\n\t\t * @member {module:link/ui/linkformview~LinkFormView}\n\t\t */\n\t\tthis.formView = this._createFormView();\n\n\t\t/**\n\t\t * The contextual balloon plugin instance.\n\t\t *\n\t\t * @private\n\t\t * @member {module:ui/panel/balloon/contextualballoon~ContextualBalloon}\n\t\t */\n\t\tthis._balloon = editor.plugins.get( ContextualBalloon );\n\n\t\t// Create toolbar buttons.\n\t\tthis._createToolbarLinkButton();\n\n\t\t// Attach lifecycle actions to the the balloon.\n\t\tthis._enableUserBalloonInteractions();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdestroy() {\n\t\tsuper.destroy();\n\n\t\t// Destroy created UI components as they are not automatically destroyed (see ckeditor5#1341).\n\t\tthis.formView.destroy();\n\t}\n\n\t/**\n\t * Creates the {@link module:link/ui/linkactionsview~LinkActionsView} instance.\n\t *\n\t * @private\n\t * @returns {module:link/ui/linkactionsview~LinkActionsView} The link actions view instance.\n\t */\n\t_createActionsView() {\n\t\tconst editor = this.editor;\n\t\tconst actionsView = new LinkActionsView( editor.locale );\n\t\tconst linkCommand = editor.commands.get( 'link' );\n\t\tconst unlinkCommand = editor.commands.get( 'unlink' );\n\n\t\tactionsView.bind( 'href' ).to( linkCommand, 'value' );\n\t\tactionsView.editButtonView.bind( 'isEnabled' ).to( linkCommand );\n\t\tactionsView.unlinkButtonView.bind( 'isEnabled' ).to( unlinkCommand );\n\n\t\t// Execute unlink command after clicking on the \"Edit\" button.\n\t\tthis.listenTo( actionsView, 'edit', () => {\n\t\t\tthis._addFormView();\n\t\t} );\n\n\t\t// Execute unlink command after clicking on the \"Unlink\" button.\n\t\tthis.listenTo( actionsView, 'unlink', () => {\n\t\t\teditor.execute( 'unlink' );\n\t\t\tthis._hideUI();\n\t\t} );\n\n\t\t// Close the panel on esc key press when the **actions have focus**.\n\t\tactionsView.keystrokes.set( 'Esc', ( data, cancel ) => {\n\t\t\tthis._hideUI();\n\t\t\tcancel();\n\t\t} );\n\n\t\t// Open the form view on Ctrl+K when the **actions have focus**..\n\t\tactionsView.keystrokes.set( linkKeystroke, ( data, cancel ) => {\n\t\t\tthis._addFormView();\n\t\t\tcancel();\n\t\t} );\n\n\t\treturn actionsView;\n\t}\n\n\t/**\n\t * Creates the {@link module:link/ui/linkformview~LinkFormView} instance.\n\t *\n\t * @private\n\t * @returns {module:link/ui/linkformview~LinkFormView} The link form view instance.\n\t */\n\t_createFormView() {\n\t\tconst editor = this.editor;\n\t\tconst linkCommand = editor.commands.get( 'link' );\n\n\t\tconst formView = new LinkFormView( editor.locale, linkCommand.manualDecorators );\n\n\t\tformView.urlInputView.bind( 'value' ).to( linkCommand, 'value' );\n\n\t\t// Form elements should be read-only when corresponding commands are disabled.\n\t\tformView.urlInputView.bind( 'isReadOnly' ).to( linkCommand, 'isEnabled', value => !value );\n\t\tformView.saveButtonView.bind( 'isEnabled' ).to( linkCommand );\n\n\t\t// Execute link command after clicking the \"Save\" button.\n\t\tthis.listenTo( formView, 'submit', () => {\n\t\t\teditor.execute( 'link', formView.urlInputView.inputView.element.value, formView.getDecoratorSwitchesState() );\n\t\t\tthis._closeFormView();\n\t\t} );\n\n\t\t// Hide the panel after clicking the \"Cancel\" button.\n\t\tthis.listenTo( formView, 'cancel', () => {\n\t\t\tthis._closeFormView();\n\t\t} );\n\n\t\t// Close the panel on esc key press when the **form has focus**.\n\t\tformView.keystrokes.set( 'Esc', ( data, cancel ) => {\n\t\t\tthis._closeFormView();\n\t\t\tcancel();\n\t\t} );\n\n\t\treturn formView;\n\t}\n\n\t/**\n\t * Creates a toolbar Link button. Clicking this button will show\n\t * a {@link #_balloon} attached to the selection.\n\t *\n\t * @private\n\t */\n\t_createToolbarLinkButton() {\n\t\tconst editor = this.editor;\n\t\tconst linkCommand = editor.commands.get( 'link' );\n\t\tconst t = editor.t;\n\n\t\t// Handle the `Ctrl+K` keystroke and show the panel.\n\t\teditor.keystrokes.set( linkKeystroke, ( keyEvtData, cancel ) => {\n\t\t\t// Prevent focusing the search bar in FF and opening new tab in Edge. #153, #154.\n\t\t\tcancel();\n\n\t\t\tthis._showUI( true );\n\t\t} );\n\n\t\teditor.ui.componentFactory.add( 'link', locale => {\n\t\t\tconst button = new ButtonView( locale );\n\n\t\t\tbutton.isEnabled = true;\n\t\t\tbutton.label = t( 'Link' );\n\t\t\tbutton.icon = linkIcon;\n\t\t\tbutton.keystroke = linkKeystroke;\n\t\t\tbutton.tooltip = true;\n\t\t\tbutton.isToggleable = true;\n\n\t\t\t// Bind button to the command.\n\t\t\tbutton.bind( 'isEnabled' ).to( linkCommand, 'isEnabled' );\n\t\t\tbutton.bind( 'isOn' ).to( linkCommand, 'value', value => !!value );\n\n\t\t\t// Show the panel on button click.\n\t\t\tthis.listenTo( button, 'execute', () => this._showUI( true ) );\n\n\t\t\treturn button;\n\t\t} );\n\t}\n\n\t/**\n\t * Attaches actions that control whether the balloon panel containing the\n\t * {@link #formView} is visible or not.\n\t *\n\t * @private\n\t */\n\t_enableUserBalloonInteractions() {\n\t\tconst viewDocument = this.editor.editing.view.document;\n\n\t\t// Handle click on view document and show panel when selection is placed inside the link element.\n\t\t// Keep panel open until selection will be inside the same link element.\n\t\tthis.listenTo( viewDocument, 'click', () => {\n\t\t\tconst parentLink = this._getSelectedLinkElement();\n\n\t\t\tif ( parentLink ) {\n\t\t\t\t// Then show panel but keep focus inside editor editable.\n\t\t\t\tthis._showUI();\n\t\t\t}\n\t\t} );\n\n\t\t// Focus the form if the balloon is visible and the Tab key has been pressed.\n\t\tthis.editor.keystrokes.set( 'Tab', ( data, cancel ) => {\n\t\t\tif ( this._areActionsVisible && !this.actionsView.focusTracker.isFocused ) {\n\t\t\t\tthis.actionsView.focus();\n\t\t\t\tcancel();\n\t\t\t}\n\t\t}, {\n\t\t\t// Use the high priority because the link UI navigation is more important\n\t\t\t// than other feature's actions, e.g. list indentation.\n\t\t\t// https://github.com/ckeditor/ckeditor5-link/issues/146\n\t\t\tpriority: 'high'\n\t\t} );\n\n\t\t// Close the panel on the Esc key press when the editable has focus and the balloon is visible.\n\t\tthis.editor.keystrokes.set( 'Esc', ( data, cancel ) => {\n\t\t\tif ( this._isUIVisible ) {\n\t\t\t\tthis._hideUI();\n\t\t\t\tcancel();\n\t\t\t}\n\t\t} );\n\n\t\t// Close on click outside of balloon panel element.\n\t\tclickOutsideHandler( {\n\t\t\temitter: this.formView,\n\t\t\tactivator: () => this._isUIInPanel,\n\t\t\tcontextElements: [ this._balloon.view.element ],\n\t\t\tcallback: () => this._hideUI()\n\t\t} );\n\t}\n\n\t/**\n\t * Adds the {@link #actionsView} to the {@link #_balloon}.\n\t *\n\t * @protected\n\t */\n\t_addActionsView() {\n\t\tif ( this._areActionsInPanel ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._balloon.add( {\n\t\t\tview: this.actionsView,\n\t\t\tposition: this._getBalloonPositionData()\n\t\t} );\n\t}\n\n\t/**\n\t * Adds the {@link #formView} to the {@link #_balloon}.\n\t *\n\t * @protected\n\t */\n\t_addFormView() {\n\t\tif ( this._isFormInPanel ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst editor = this.editor;\n\t\tconst linkCommand = editor.commands.get( 'link' );\n\n\t\tthis._balloon.add( {\n\t\t\tview: this.formView,\n\t\t\tposition: this._getBalloonPositionData()\n\t\t} );\n\n\t\t// Select input when form view is currently visible.\n\t\tif ( this._balloon.visibleView === this.formView ) {\n\t\t\tthis.formView.urlInputView.select();\n\t\t}\n\n\t\t// Make sure that each time the panel shows up, the URL field remains in sync with the value of\n\t\t// the command. If the user typed in the input, then canceled the balloon (`urlInputView#value` stays\n\t\t// unaltered) and re-opened it without changing the value of the link command (e.g. because they\n\t\t// clicked the same link), they would see the old value instead of the actual value of the command.\n\t\t// https://github.com/ckeditor/ckeditor5-link/issues/78\n\t\t// https://github.com/ckeditor/ckeditor5-link/issues/123\n\t\tthis.formView.urlInputView.inputView.element.value = linkCommand.value || '';\n\t}\n\n\t/**\n\t * Closes the form view. Decides whether the balloon should be hidden completely or if the action view should be shown. This is\n\t * decided upon the link command value (which has a value if the document selection is in the link).\n\t *\n\t * Additionally, if any {@link module:link/link~LinkConfig#decorators} are defined in the editor configuration, the state of\n\t * switch buttons responsible for manual decorator handling is restored.\n\t *\n\t * @private\n\t */\n\t_closeFormView() {\n\t\tconst linkCommand = this.editor.commands.get( 'link' );\n\n\t\t// Restore manual decorator states to represent the current model state. This case is important to reset the switch buttons\n\t\t// when the user cancels the editing form.\n\t\tlinkCommand.restoreManualDecoratorStates();\n\n\t\tif ( linkCommand.value !== undefined ) {\n\t\t\tthis._removeFormView();\n\t\t} else {\n\t\t\tthis._hideUI();\n\t\t}\n\t}\n\n\t/**\n\t * Removes the {@link #formView} from the {@link #_balloon}.\n\t *\n\t * @protected\n\t */\n\t_removeFormView() {\n\t\tif ( this._isFormInPanel ) {\n\t\t\t// Blur the input element before removing it from DOM to prevent issues in some browsers.\n\t\t\t// See https://github.com/ckeditor/ckeditor5/issues/1501.\n\t\t\tthis.formView.saveButtonView.focus();\n\n\t\t\tthis._balloon.remove( this.formView );\n\n\t\t\t// Because the form has an input which has focus, the focus must be brought back\n\t\t\t// to the editor. Otherwise, it would be lost.\n\t\t\tthis.editor.editing.view.focus();\n\t\t}\n\t}\n\n\t/**\n\t * Shows the correct UI type. It is either {@link #formView} or {@link #actionsView}.\n\t *\n\t * @param {Boolean} forceVisible\n\t * @private\n\t */\n\t_showUI( forceVisible = false ) {\n\t\t// When there's no link under the selection, go straight to the editing UI.\n\t\tif ( !this._getSelectedLinkElement() ) {\n\t\t\tthis._addActionsView();\n\n\t\t\t// Be sure panel with link is visible.\n\t\t\tif ( forceVisible ) {\n\t\t\t\tthis._balloon.showStack( 'main' );\n\t\t\t}\n\n\t\t\tthis._addFormView();\n\t\t}\n\t\t// If there's a link under the selection...\n\t\telse {\n\t\t\t// Go to the editing UI if actions are already visible.\n\t\t\tif ( this._areActionsVisible ) {\n\t\t\t\tthis._addFormView();\n\t\t\t}\n\t\t\t// Otherwise display just the actions UI.\n\t\t\telse {\n\t\t\t\tthis._addActionsView();\n\t\t\t}\n\n\t\t\t// Be sure panel with link is visible.\n\t\t\tif ( forceVisible ) {\n\t\t\t\tthis._balloon.showStack( 'main' );\n\t\t\t}\n\t\t}\n\n\t\t// Begin responding to ui#update once the UI is added.\n\t\tthis._startUpdatingUI();\n\t}\n\n\t/**\n\t * Removes the {@link #formView} from the {@link #_balloon}.\n\t *\n\t * See {@link #_addFormView}, {@link #_addActionsView}.\n\t *\n\t * @protected\n\t */\n\t_hideUI() {\n\t\tif ( !this._isUIInPanel ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst editor = this.editor;\n\n\t\tthis.stopListening( editor.ui, 'update' );\n\t\tthis.stopListening( this._balloon, 'change:visibleView' );\n\n\t\t// Make sure the focus always gets back to the editable _before_ removing the focused form view.\n\t\t// Doing otherwise causes issues in some browsers. See https://github.com/ckeditor/ckeditor5-link/issues/193.\n\t\teditor.editing.view.focus();\n\n\t\t// Remove form first because it's on top of the stack.\n\t\tthis._removeFormView();\n\n\t\t// Then remove the actions view because it's beneath the form.\n\t\tthis._balloon.remove( this.actionsView );\n\t}\n\n\t/**\n\t * Makes the UI react to the {@link module:core/editor/editorui~EditorUI#event:update} event to\n\t * reposition itself when the editor UI should be refreshed.\n\t *\n\t * See: {@link #_hideUI} to learn when the UI stops reacting to the `update` event.\n\t *\n\t * @protected\n\t */\n\t_startUpdatingUI() {\n\t\tconst editor = this.editor;\n\t\tconst viewDocument = editor.editing.view.document;\n\n\t\tlet prevSelectedLink = this._getSelectedLinkElement();\n\t\tlet prevSelectionParent = getSelectionParent();\n\n\t\tconst update = () => {\n\t\t\tconst selectedLink = this._getSelectedLinkElement();\n\t\t\tconst selectionParent = getSelectionParent();\n\n\t\t\t// Hide the panel if:\n\t\t\t//\n\t\t\t// * the selection went out of the EXISTING link element. E.g. user moved the caret out\n\t\t\t//   of the link,\n\t\t\t// * the selection went to a different parent when creating a NEW link. E.g. someone\n\t\t\t//   else modified the document.\n\t\t\t// * the selection has expanded (e.g. displaying link actions then pressing SHIFT+Right arrow).\n\t\t\t//\n\t\t\t// Note: #_getSelectedLinkElement will return a link for a non-collapsed selection only\n\t\t\t// when fully selected.\n\t\t\tif ( ( prevSelectedLink && !selectedLink ) ||\n\t\t\t\t( !prevSelectedLink && selectionParent !== prevSelectionParent ) ) {\n\t\t\t\tthis._hideUI();\n\t\t\t}\n\t\t\t// Update the position of the panel when:\n\t\t\t//  * link panel is in the visible stack\n\t\t\t//  * the selection remains in the original link element,\n\t\t\t//  * there was no link element in the first place, i.e. creating a new link\n\t\t\telse if ( this._isUIVisible ) {\n\t\t\t\t// If still in a link element, simply update the position of the balloon.\n\t\t\t\t// If there was no link (e.g. inserting one), the balloon must be moved\n\t\t\t\t// to the new position in the editing view (a new native DOM range).\n\t\t\t\tthis._balloon.updatePosition( this._getBalloonPositionData() );\n\t\t\t}\n\n\t\t\tprevSelectedLink = selectedLink;\n\t\t\tprevSelectionParent = selectionParent;\n\t\t};\n\n\t\tfunction getSelectionParent() {\n\t\t\treturn viewDocument.selection.focus.getAncestors()\n\t\t\t\t.reverse()\n\t\t\t\t.find( node => node.is( 'element' ) );\n\t\t}\n\n\t\tthis.listenTo( editor.ui, 'update', update );\n\t\tthis.listenTo( this._balloon, 'change:visibleView', update );\n\t}\n\n\t/**\n\t * Returns `true` when {@link #formView} is in the {@link #_balloon}.\n\t *\n\t * @readonly\n\t * @protected\n\t * @type {Boolean}\n\t */\n\tget _isFormInPanel() {\n\t\treturn this._balloon.hasView( this.formView );\n\t}\n\n\t/**\n\t * Returns `true` when {@link #actionsView} is in the {@link #_balloon}.\n\t *\n\t * @readonly\n\t * @protected\n\t * @type {Boolean}\n\t */\n\tget _areActionsInPanel() {\n\t\treturn this._balloon.hasView( this.actionsView );\n\t}\n\n\t/**\n\t * Returns `true` when {@link #actionsView} is in the {@link #_balloon} and it is\n\t * currently visible.\n\t *\n\t * @readonly\n\t * @protected\n\t * @type {Boolean}\n\t */\n\tget _areActionsVisible() {\n\t\treturn this._balloon.visibleView === this.actionsView;\n\t}\n\n\t/**\n\t * Returns `true` when {@link #actionsView} or {@link #formView} is in the {@link #_balloon}.\n\t *\n\t * @readonly\n\t * @protected\n\t * @type {Boolean}\n\t */\n\tget _isUIInPanel() {\n\t\treturn this._isFormInPanel || this._areActionsInPanel;\n\t}\n\n\t/**\n\t * Returns `true` when {@link #actionsView} or {@link #formView} is in the {@link #_balloon} and it is\n\t * currently visible.\n\t *\n\t * @readonly\n\t * @protected\n\t * @type {Boolean}\n\t */\n\tget _isUIVisible() {\n\t\tconst visibleView = this._balloon.visibleView;\n\n\t\treturn visibleView == this.formView || this._areActionsVisible;\n\t}\n\n\t/**\n\t * Returns positioning options for the {@link #_balloon}. They control the way the balloon is attached\n\t * to the target element or selection.\n\t *\n\t * If the selection is collapsed and inside a link element, the panel will be attached to the\n\t * entire link element. Otherwise, it will be attached to the selection.\n\t *\n\t * @private\n\t * @returns {module:utils/dom/position~Options}\n\t */\n\t_getBalloonPositionData() {\n\t\tconst view = this.editor.editing.view;\n\t\tconst viewDocument = view.document;\n\t\tconst targetLink = this._getSelectedLinkElement();\n\n\t\tconst target = targetLink ?\n\t\t\t// When selection is inside link element, then attach panel to this element.\n\t\t\tview.domConverter.mapViewToDom( targetLink ) :\n\t\t\t// Otherwise attach panel to the selection.\n\t\t\tview.domConverter.viewRangeToDom( viewDocument.selection.getFirstRange() );\n\n\t\treturn { target };\n\t}\n\n\t/**\n\t * Returns the link {@link module:engine/view/attributeelement~AttributeElement} under\n\t * the {@link module:engine/view/document~Document editing view's} selection or `null`\n\t * if there is none.\n\t *\n\t * **Note**: For a noncollapsed selection, the link element is only returned when **fully**\n\t * selected and the **only** element within the selection boundaries.\n\t *\n\t * @private\n\t * @returns {module:engine/view/attributeelement~AttributeElement|null}\n\t */\n\t_getSelectedLinkElement() {\n\t\tconst view = this.editor.editing.view;\n\t\tconst selection = view.document.selection;\n\n\t\tif ( selection.isCollapsed ) {\n\t\t\treturn findLinkElementAncestor( selection.getFirstPosition() );\n\t\t} else {\n\t\t\t// The range for fully selected link is usually anchored in adjacent text nodes.\n\t\t\t// Trim it to get closer to the actual link element.\n\t\t\tconst range = selection.getFirstRange().getTrimmed();\n\t\t\tconst startLink = findLinkElementAncestor( range.start );\n\t\t\tconst endLink = findLinkElementAncestor( range.end );\n\n\t\t\tif ( !startLink || startLink != endLink ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t// Check if the link element is fully selected.\n\t\t\tif ( view.createRangeIn( startLink ).getTrimmed().isEqual( range ) ) {\n\t\t\t\treturn startLink;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}\n\n// Returns a link element if there's one among the ancestors of the provided `Position`.\n//\n// @private\n// @param {module:engine/view/position~Position} View position to analyze.\n// @returns {module:engine/view/attributeelement~AttributeElement|null} Link element at the position or null.\nfunction findLinkElementAncestor( position ) {\n\treturn position.getAncestors().find( ancestor => isLinkElement( ancestor ) );\n}\n"]}]}